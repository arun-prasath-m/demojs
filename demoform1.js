function FormFacade(data){this.data=data,this.draft=null,this.result=null,this.template={},this.showago=!0,this.__sections=null,this.paymentIntent=null,this.debounceTimer=null,this.signaturePad={},this.prefill=function(){var e=this;this.draft={},this.draft.entry||(this.draft.entry={}),this.draft.pageHistory||(this.draft.pageHistory=[]),this.draft.activePage||(this.draft.activePage="root");var t=this.data.scraped.items||{},r=this.data.request.query.prefill;if(r&&window[r]){var n=window[r](this);for(var a in t){var i=n["entry."+(l=t[a]).entry];i&&(this.draft.entry[l.entry]=i)}}else{var s=new URLSearchParams(window.location.search),o=s.get("emailAddress");for(var a in o&&(this.draft.emailAddress=o),t){var l=t[a],c=s.get("entry."+l.entry);"CHECKBOX"==l.type&&c?(c=s.getAll("entry."+l.entry),e.draft.entry[l.entry]=c):"GRID"==l.type&&l.rows?l.rows.forEach((function(t){(c=t.multiple?s.getAll("entry."+t.entry):s.get("entry."+t.entry))&&(e.draft.entry[t.entry]=c)})):c&&(e.draft.entry[l.entry]=c);var f=s.get("entry."+l.entry+".other_option_response");f&&(e.draft.entry[l.entry+"-other_option_response"]=f)}}return this.draft},this.computeField=function(e,t){return e.match(/<img\s+[^>]*src="[^"]+\.html(\?[^"]*)?"/gi)?"Image should not have html":!t&&e.indexOf("${")<0?e:this.calculateEngine(e,{calcfield:t})},this.compute=function(){var e=this,t=this.data.scraped.items||{},r=this.data.facade.items||{},n=[];for(var a in t){var i=t[a];i.id=a,i.logic=r[a],n.push(i)}n.sort((function(e,t){return e.index-t.index})),n.forEach((function(t,n){var a=t.id,i=r[a];if(i)if(i.calculated){var s=e.computeField(i.calculated,t);if(e.draft&&e.draft.entry&&(e.draft.entry[t.entry]=s),(f=document.getElementById("Widget"+a))&&(f.value=s),m=document.getElementById("Display"+a))if(s&&"DATE"==t.type){var o=s.split(/\D/),l=new Date(0,0,0);3==o.length?l=new Date(o[0],o[1]-1,o[2]):6==o.length&&(l=new Date(o[0],o[1]-1,o[2],o[3],o[4],o[5])),1==t.time?m.value=l.toLocaleString():m.value=l.toLocaleDateString()}else m.value=t.format?t.format(s):s}else if(i.prefill&&!e.draft.entry[t.entry]){var c=e.computeField(i.prefill,t);if(c)e.draft.entry[t.entry]=c,(f=document.getElementById("Widget"+a))&&(f.value=c),(m=document.getElementById("Display"+a))&&(m.value=c)}else if("FILE_UPLOAD"==i.type&&"SIGNATURE"!=i.subtype){var f,d=e.draft.entry[t.entry];(f=document.getElementById("Widget"+a))&&d&&(f.value=d);var m,p=[];if(d&&(p=d.split(",")),p=p.map((function(e){return'<a class="addedfile" href="javascript:void(0)">'+decodeURIComponent(e.split("/").pop().trim())+"</a>"})),m=document.getElementById("Display"+a))if(p.length>0)m.innerHTML=p.join(" ");else{var u=i.placeholder?i.placeholder:"Add file";m.innerHTML='<a class="addfile" href="javascript:void(0)">'+u+"</a>"}}})),n.forEach((function(t,n){var a=t.id,i=r[a],s=document.getElementById("Help"+a);if(i&&i.helpMark&&s){var o=e.computeField(i.helpMark,t);s.innerHTML=o}}));var s=this.getDocument(),o=this.data.facade&&this.data.facade.titles?this.data.facade.titles:{};for(var l in o){var c=o[l],f=s.getElementById("ff-desc-"+l);if(c.messageMark&&f){var d=e.computeField(c.messageMark);f.innerHTML=e.switchAllCDN(d)}}s.querySelectorAll(".ff-title a, .ff-section-header a, .ff-description a, .ff-item label a, .ff-item .ff-help a").forEach((e=>{0==e.classList.length&&(e.target="_blank")}))},this.toRGB=function(e,t){var r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(r){var n=[parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16)];return t&&n.push(t),"rgb("+n.join(", ")+")"}return e},this.getEnhancement=function(){return"yes"==this.data.request.query.enhance?{layout:"1column",color:"theme",font:"space",input:"flat",button:"flat"}:null},this.shuffle=function(e){if(this.isEditMode())return e;for(var t,r,n=e.length;0!==n;)r=Math.floor(Math.random()*n),t=e[n-=1],e[n]=e[r],e[r]=t;return e},this.filter=function(e=[]){var t=[],r=[],n=[];return e.forEach((function(e){"__other_option__"==e.value?n.push(e):""==e.value?r.push(e):t.push(e)})),t.concat(r)},this.loadScript=function(e,t){if(document.querySelectorAll(`script[src="${e}"]`).length>0)return t();var r=document.createElement("script");r.type="text/javascript",r.readyState?r.onreadystatechange=function(e){"loaded"!=r.readyState&&"complete"!=r.readyState||(r.onreadystatechange=null,t(e))}:r.onload=r.onerror=function(e){t(e)},r.src=e,document.getElementsByTagName("head")[0].appendChild(r)},this.loadScripts=function(e){var t=this;this.data.devEnv&&(e=e.map((function(e){var t=e.split("https://formfacade.com");return 2==t.length?t.pop()+"?_="+(new Date).getTime():e})));var r=e.map((function(e){return new Promise((function(r,n){t.loadScript(e,r)}))}));return Promise.all(r)},this.fetchScrape=function(e){return"cloud"==this.data.request.query.template?fetch(`/uploaded/templates/${e}`).then((e=>e.json())).then((e=>e.scrape||{})):"draft"==this.data.request.query.template?fetch(`https://formfacade-template-default-rtdb.firebaseio.com/scrape/${e}-${this.data.request.query.uid}.json`).then((e=>e.json())).then((e=>e||{})):fetch("https://cache.formfacade.com/data/scrape/"+e).then((e=>e.json())).then((e=>e||{}))},this.fetchPublish=function(e){var{template:t,uid:r}=this.data.request.query;return"cloud"==t?fetch(`/uploaded/templates/${e}`).then((e=>e.json())).then((e=>e.publish||{})):"draft"==t?fetch(`https://formfacade-template-default-rtdb.firebaseio.com/publish/${e}-${r}.json`).then((e=>e.json())).then((e=>e||{})):fetch("https://cache.formfacade.com/data/publish/"+e).then((e=>e.json())).then((e=>e||{}))},this.fetchFacade=function(e){var{template:t,uid:r}=this.data.request.query;return"cloud"==t?Promise.resolve({}):"draft"==t?fetch(`https://formfacade-template-default-rtdb.firebaseio.com/facade/${e}-${r}.json`).then((e=>e.json())).then((e=>e||{})):fetch("https://cache.formfacade.com/data/facade/"+e+"-editable").then((e=>e.json())).then((e=>e||{}))},this.fetchInfo=function(e){return fetch("https://cache.formfacade.com/data/team/"+e+"/info").then((e=>e.json())).then((e=>e||{}))},this.fetchPaid=function(e){return fetch("https://cache.formfacade.com/data/user/"+e+"/paid").then((e=>e.json())).then((e=>0==Object.keys(e||{}).length?null:e))},this.fetchPrefill=function(e,t){return fetch("https://cache.formfacade.com/data/prefill/"+e+"/link/"+t).then((e=>e.json())).then((e=>e||{}))},this.fetchContact=function(e,t,r){var n=this.data.devEnv?"http://localhost:5000":"https://formfacade.com";return fetch(n+"/contact/"+e+"/form/"+t+"/"+r).then((e=>e.json())).then((e=>e||{}))},this.fetchResponse=function(e,t){var r=this.data.devEnv?"http://localhost:5000":"https://formfacade.com";return fetch(r+"/draft/"+e+"/read/"+t).then((e=>e.json())).then((e=>e||{}))},this.fetchApprovers=function(e){return fetch("https://cache.formfacade.com/data/personalize/"+e+"/approvers").then((e=>e.json())).then((e=>e||{}))},this.init=function(e){this.result=null,this.__sections=null;var{userId:t,publishId:r}=this.data.request.params,n=[this.fetchScrape(r),this.fetchPublish(r),this.fetchFacade(r),this.fetchInfo(t),this.fetchPaid(t)];e=e||this.readCookie("ff-"+r);var{flush:a,restoreId:i,appearance:s,fulledit:o,copyId:l,prefillId:c,lang:f,officeuseSection:d,contactId:m}=this.data.request.query,p=new URLSearchParams(window.location.search);if(a=a||p.get("ff-flush"),i=i||p.get("restoreId"),o=o||p.get("fulledit"),s=s||p.get("appearance"),d=d||p.get("officeuseSection"),(i||o)&&(this.data.restoreId=i||o,this.data.fulledit=o,this.data.appearance=s,this.data.officeuseSectionId=d||null,e=i||o,a=!1),l=l||p.get("copyId"),c=c||p.get("prefillId"),m=m||p.get("contactId"),c){var u=this.fetchPrefill(r,c).then((e=>e.entry?{entry:e.entry}:{}));n.push(u)}else if(l){var h=this.fetchResponse(r,l).then((e=>e.entry?{entry:e.entry}:{}));n.push(h)}else if(m){var g=this.fetchContact(t,r,m).then((e=>e.entry?{entry:e.entry}:{}));n.push(g)}else if(e&&!a){var v=this.fetchResponse(r,e);n.push(v)}else{v=Promise.resolve({});n.push(v)}if(this.data.officeuseSectionId){var y=this.fetchApprovers(r);n.push(y)}else{y=Promise.resolve({});n.push(y)}var b=this;if(window.posMode&&b.data.request.params.userId)try{b.posMode=new POS(b.data.request.params.userId,{authentication:{userId:b.data.request.params.userId}})}catch(e){console.error(e)}return Promise.all(n).then((function(e){var[r,n,a,s,o,l,c]=e;b.data.scraped=b.data.ban?{error:"Not public",errorMessage:b.data.ban}:r,b.data.form=n,b.data.facade=a,b.data.approvers=c,b.config=Object.assign(b.config,s),b.config.payment=o||{},b.isPaid(t,{paid:o})&&(b.config.branded=o.branded,b.config.plan="paid"),l.entry?(b.draft=l,b.draft.pageHistory||(b.draft.pageHistory=[]),b.draft.activePage||(b.draft.activePage="root"),i&&(b.draft.activePage="root")):b.draft=b.prefill();var d=(b.data.facade.setting||{}).language||s.language||f;try{b.posMode&&window.ffFormLoaded&&"function"==typeof window.ffFormLoaded&&window.ffFormLoaded()}catch(e){console.error(e)}return b.loadLanguage(d)}))},this.loadLanguage=function(e){if(e&&this.langtext&&e!=this.langtext.language){var t=this.data.devEnv?"http://localhost:5000":"https://formfacade.com";return fetch(t+"/include/language/"+e+".json").then((e=>e.json())).then((e=>{this.langtext=e}))}return Promise.resolve()},this.load=function(e){var t=this;t.divId=e;var r=t.config.setting||{},n=t.data.request.params.target;"bootstrap"==n||"gsuite"==n||"clean"==n?(t.addLinkTag("/css/open-props.min.css"),t.addLinkTag("/css/formfacade.css"),t.addLinkTag("/css/formfacade.boot.css"),r.currency&&t.addLinkTag("/css/neartail.css")):t.addLinkTag("/css/tailwind/output.css");var a=t.getContentElement();if(a){a.innerHTML=t.template.preview;var i=a.querySelector("form");i&&i.addEventListener("submit",(function(e){return e.preventDefault(),!1}))}this.init().then((function(){var e=(t.data.facade||{}).setting||{};!r.currency&&e.currency&&t.addLinkTag("/css/neartail.css"),t.isEditMode()?(t.data.scraped.items?t.render():t.hasCreator()?t.getContentElement().innerHTML=t.template.preview:t.render(),t.addLinkTag("/css/formfacade.editor.css"),t.addLinkTag("/css/neartail.editor.css")):t.render();var n=new URLSearchParams(window.location.search).get("addtocart");if(n){var a=(t.data.scraped.items[n]||{}).section||{};"root"!=a.id&&t.directtoSection(a.id),t.showProduct(n,2);var i=document.getElementById("ff-id-"+n);t.scrollIntoView(i)}window.cartSidebar&&cartSidebar.fetch("load"),window.facadeListener&&facadeListener.onChange("load",t);var s=t.data.request.query.callback;s&&window[s]&&window[s](t),t.scrapeSection(),!window.Stripe&&t.getPaymentButtons().length>0&&t.loadScript("https://js.stripe.com/v3/",(function(){}))}))},this.addLinkTag=function(e){if(!document.getElementById(e)){var t=(this.data.devEnv?"":"https://formfacade.com")+e+"?nocache="+(this.data.devEnv?(new Date).getTime():95),r=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0],n=document.createElement("link");n.id=e,n.rel="stylesheet",n.href=t,r.appendChild(n)}},this.createCookie=function(e,t,r){if(r){var n=new Date;n.setTime(n.getTime()+24*r*60*60*1e3);var a="; expires="+n.toGMTString()}else a="";document.cookie=e+"="+t+a+"; path=/"},this.readCookie=function(e){var t=(document.cookie.match("(^|; )"+e+"=([^;]*)")||0)[2];return t&&""==t.trim()?null:t},this.hasCreator=function(){var e=(this.data.facade||{}).setting||{},t=(this.data.form||{}).editors||[];return t.indexOf("creator@neartail.com")>=0||"neartail"==e.creator||e.currencyCode&&t.indexOf("editor@formfacade.com")>=0},this.hasEditor=function(){var e=this.data&&this.data.form&&this.data.form.editors;return e&&e.indexOf("editor@formfacade.com")>=0},this.hasCreatorOrEditor=function(){return this.hasCreator()||this.hasEditor()},this.isEditMode=function(){return location.href.indexOf("/editor/form/")>=0||location.href.indexOf("/formbuilder/form/")>=0||location.href.indexOf("/oldeditor/form/")>=0},this.removeCustomCSSInEditor=function(){return!(!this.isEditMode()||!window.isFormBuilder)},this.isPreviewMode=function(){return!!window.editFacade||(0==location.href.indexOf("https://formfacade.com/edit/")||(0==location.href.indexOf("https://formfacade.com/embed/")||0==location.href.indexOf("https://formfacade.com/share/")))},this.launchPreview=function(){confirm("You are in edit mode. Do you want to test this form in preview mode?")&&window.open(location.href.replace("/editor/","/preview/"))},this.html=function(e){return e&&(e=e.trim().replace(/(?:\r\n|\r|\n)/g,"<br>"),replacePattern1=/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,e=e.replace(replacePattern1,'<a href="$1" target="_blank">$1</a>'),replacePattern2=/(^|[^\/])(www\.[\S]+(\b|$))/gim,e=e.replace(replacePattern2,'$1<a href="http://$2" target="_blank">$2</a>'),replacePattern3=/(([a-zA-Z0-9\-\_\.])+@[a-zA-Z\_]+?(\.[a-zA-Z]{2,6})+)/gim,e=e.replace(replacePattern3,'<a href="mailto:$1">$1</a>')),e},this.val=function(e){var t=this.data.scraped.items||{};for(var r in t){var n=t[r];if(this.draft&&n.title==e)return this.draft.entry[n.entry]}},this.entry=function(e){if(this.draft.entry){var t=this.draft.entry[e];if(t)return t;this.draft.entry[e.toString()]}},this.getContentElement=function(){return document.querySelector(this.divId)},this.getPhone=function(e="root"){if(this.data.facade&&this.data.facade.whatsapp){var t=this.data.scraped.items||{},r=this.draft.entry||{},n=this.data.facade.whatsapp.phone,a=this.data.facade.submit||{};if(a[e]){var i=a[e],s=t[i.router]||{};return i.submitto?"whatsapp"==i.submitto?(n=i.waphone||n,r[s.entry]||n):null:r[s.entry]||n}return n}},this.showMessage=function(e){var t=this,r=this.getDocument();this.getPhone(e)?r.querySelectorAll("#ff-submit-"+e).forEach((function(e){e.innerHTML=t.lang("Launching WhatsApp...")})):r.querySelectorAll("#ff-submit-"+e+" img").forEach((function(e){e.src="https://formfacade.com/img/loading.svg"}))},this.clearSignature=function(e,t){this.signaturePad[e].clear();var r=document.getElementById(`Widget${e}`);r&&(r.value=""),this.draft.entry[t]="",this.saveDraft()},this.renderSignature=function(){var e=this;if("function"==typeof SignaturePad){var t=document.querySelectorAll(".ff-signature"),r=e.data.request.params,n=r.publishId;t.forEach((function(t){var a,i=t.dataset,s=i.id,o=i.entry,l=t.querySelector("canvas");if(e.draft&&e.draft.entry&&e.draft.entry[o]&&(a=e.draft.entry[o]),!t.dataset.esignAdded&&l){l.width=t.clientWidth,e.signaturePad[s]=new SignaturePad(l,{backgroundColor:"rgba(255,255,255,.1)",itemId:s});var c=e.signaturePad[s];c.addEventListener("endStroke",(t=>{var a=e.draft.savedId,i=`https://formfacade.com/uploaded/${n}/${a}/${o}/esign.png`;if(document.getElementById(`Widget${s}`).value=i,e.draft.entry[o]=i,e.saveSignImage(s,o),!r.publishId){var l={publishId:n,currParams:e.data.request.params,params:r,userAgent:navigator.userAgent};e.showWarning("Signature undefined issue",l,null,{ignorePopup:!0})}})),c&&c.isEmpty()&&a&&"string"==typeof a&&(e.data.devEnv&&(a=a.replace("https://formfacade.com","http://localhost:5000")),c.fromDataURL(a,{width:l.clientWidth,height:l.clientHeight})),t.dataset.esignAdded=!0}}))}},this.saveSignImage=function(e,t){var r=this,n="https://formfacade.com";r.data.devEnv&&(n="http://localhost:5000");var a=r.data.request.params.publishId,i=r.draft.savedId;i||(i=r.readCookie("ff-"+a));var s=Promise.resolve(i);return i||(s=r.saveDraft().then((e=>r.draft.savedId))),r.saving=s.then((function(i){if(!i)throw Error("Save failed! Try again.");return fetch(n+"/signature/"+a+"/"+i+"/"+t,{method:"post",headers:{accept:"application/json","content-type":"application/json"},body:JSON.stringify({image:r.signaturePad[e].toDataURL()})}).then((function(e){return e.json()})).then((function(n){var a=document.getElementById(`Widget${e}`);return n&&n.url&&a&&(r.draft.entry[t]=n.url,a.value=n.url),r.saveDraft()}))})),r.saving},this.debounce=function(e,t){var r=this;return function(){const n=this,a=arguments;clearTimeout(r.debounceTimer),r.debounceTimer=setTimeout((()=>{e.apply(n,a)}),t||500)}},this.renderUpload=function(e){if(window.Uppy){var t=this;this.data.locale||(this.data.locale=e),this.getDocument().querySelectorAll(".ff-file-upload").forEach((function(e){if(!e.dataset.uppied){var r=e.dataset,n=[];r.files&&(n=r.files.split(",")),n=n.map((function(e){return e.trim()})),t.renderUploadField(r.id,r.entry,n),e.dataset.uppied=!0}}))}},this.extensions="pdf, doc, docx, xls, xlsx, ppt, pptx, csv, txt, rtf, html, zip, mp3, wma, mpg, flv, avi, 3gp, m4v, mov, mp4, wmv, jpg, jpeg, png, gif",this.renderUploadField=function(e,t,r){var n=this,a="https://formfacade.com";n.data.devEnv&&(a="http://localhost:5000");var i,s,o=n.data.request.params.publishId;n.data.scraped.items&&(i=n.data.scraped.items[e]),i||(i={}),n.data.facade.items&&(s=n.data.facade.items[e]),s||(s={});var l=s.maxnum?s.maxnum:1,c=i.required?1:0,f=n.config.filemb||10,d=(c==l?l:c+"-"+l)+" file"+(1==l?"":"s")+", "+(f<1e3?f+" MB max":f/1e3+" GB max"),m={debug:!0,autoProceed:!0,restrictions:{maxFileSize:1024*f*1024,maxNumberOfFiles:l,minNumberOfFiles:c},onBeforeFileAdded:function(e,t){if(n.isIos()&&t){var r=[];for(let e in t)r.push(t[e].name);if(r.indexOf(e.name)>-1){var a=e.name.split("."),i=a.pop();a=a.join("."),e.name=`${a}_${Date.now()}.${i}`}}return e}};this.data.locale&&(m.locale=Uppy.locales[this.data.locale]||Uppy.locales.en_US);var p=s.extension?s.extension:this.extensions;"all"!=p&&(m.restrictions.allowedFileTypes=p.split(",").map((function(e){return"."+e.trim()})));var u=new Uppy.Uppy(m).use(Uppy.Dashboard,{trigger:"#Display"+e,note:d,showProgressDetails:!0,showRemoveButtonAfterComplete:!0,browserBackButtonClose:!0,proudlyDisplayPoweredByUppy:!1,doneButtonHandler:function(){u&&u.getPlugin("Dashboard")&&u.getPlugin("Dashboard").closeModal()}}).use(Uppy.AwsS3,{limit:1,timeout:36e5,getUploadParameters(e){var r=n.draft.savedId;r||(r=n.readCookie("ff-"+o));var i=Promise.resolve(r);return r||(i=n.saveDraft().then((e=>n.draft.savedId))),i.then((function(r){if(!r)throw Error("Save failed! Try again.");return fetch(a+"/signedurl/"+o+"/"+r+"/"+t,{method:"post",headers:{accept:"application/json","content-type":"application/json"},body:JSON.stringify({filename:e.name,contentType:e.type})}).then((function(e){return e.json()}))}))}}),h=function(){var r=u.getFiles().map((function(e){var r=n.draft.savedId;r||(r=n.readCookie("ff-"+o));var a=e.uploadURL.split("%2F").pop();return"https://formfacade.com/uploaded/"+o+"/"+r+"/"+t+"/"+a})),a=n.getDocument().getElementById("Widget"+e);a&&(a.value=r.join(", ")),n.draft.entry[t]=r.join(", "),n.saveDraft()};u.on("complete",(function(e){e.successful&&h(),n.getDocument().querySelectorAll('.uppy-StatusBar-content[title="Complete"] .uppy-StatusBar-statusPrimary').forEach((function(e){e.addEventListener("click",(function(){u.getPlugin("Dashboard").closeModal()}))}))})),u.on("file-removed",(function(e,t){h()}))},this.saveDraft=function(evt){var curr=this;return curr.cachedBill=null,curr.saving&&!curr.draft.savedId?curr.compute():(curr.saving=new Promise((function(resolve,reject){var elm=curr.getContentElement();if(elm){var frm=elm.querySelector("form");if(frm){var formData=new FormData(frm);if(formData.entries){for(var entries=formData.entries(),variants={},pairs={},next,entry;(next=entries.next())&&!1===next.done;){entry=next.value;var[ename,evalue]=entry;if("emailAddress"==ename&&evalue)formFacade.draft||(formFacade.draft={}),formFacade.draft.emailAddress=evalue;else if("responseId"==ename&&evalue)formFacade.draft||(formFacade.draft={}),formFacade.draft.responseId=evalue;else if(0==ename.indexOf("variant.")&&evalue){var[vprefix,ventry]=ename.split("."),vrn=variants[ventry]||[];vrn.push(evalue),variants[ventry]=vrn}else if(0==ename.indexOf("entry.")){var nms=ename.split("entry."),nm=nms.pop();nm=nm.replace(".","-");var val=pairs[nm];if(nm)if(val){var valarr=Array.isArray(val)?val:[val];valarr.push(evalue),pairs[nm]=valarr}else evalue&&(pairs[nm]=evalue);else console.warn("Invalid parameter",next,val)}}var fac=curr.data.facade||{},enhance=fac.enhance||{};if(!enhance.layout||"default"==enhance.layout){var txtareas=elm.querySelectorAll(".ff-item-prd textarea");txtareas.forEach((e=>{var t=e.name||"",[r,n]=t.split(".");if("entry"==r){var a=variants[n],i=a?a.join("\n"):"";e.value=i,pairs[n]=i}}))}formFacade.draft.entry=pairs;var mapping=fac.mapping||{},sitems=curr.data.scraped.items||{};["name","email","phone"].forEach((e=>{var t=mapping[e],r=sitems[t]||{},n=pairs[r.entry];r.entry&&n&&(formFacade.draft[`map-${e}`]=n)}));var http=new XMLHttpRequest,baseurl="https://formfacade.com";curr.data.devEnv&&(baseurl="http://localhost:5000");var publishId=curr.data.request.params.publishId,httpurl=baseurl+"/draft/"+publishId+"/save",userId=curr.data.request.params.userId;if(userId&&(httpurl=baseurl+"/draft/"+userId+"/form/"+publishId+"/save"),http.open("POST",httpurl,!0),http.setRequestHeader("Content-type","application/json; charset=UTF-8"),http.responseType="json",http.onload=function(){var e=http.response;if(e.savedId){curr.draft.savedId=e.savedId,e.draftSeq&&(curr.draft.draftSeq=e.draftSeq),curr.createCookie("ff-"+publishId,e.savedId,3/24);var t=evt&&evt.target&&evt.target.name?evt.target.name:"visit";curr.stat(t)}resolve(e)},http.onerror=e=>reject(http.response||"Couldn't connect to server"),formFacade.draft.originTime=formFacade.config.originTime,formFacade.draft.originId=formFacade.config.originId,http.send(JSON.stringify(formFacade.draft)),evt&&evt.target&&evt.target.name){var entrg=evt.target.name.split("entry.").pop(),scr=curr.data.scraped,fcd=curr.data.facade;for(var iid in scr.items){var itm=scr.items[iid],fitm=fcd&&fcd.items?fcd.items[iid]:null;if(itm.entry==entrg&&fitm&&fitm.js)try{eval(fitm.js)}catch(e){console.error(fitm.js+" failed with "+e)}}}curr.compute(),window.cartSidebar&&cartSidebar.fetch("save"),window.facadeListener&&facadeListener.onChange("save",curr)}}}})).then((function(){curr.saving=null})).catch((function(e){console.warn("Save failed: "+e),curr.saving=null})),curr.saving)},this.render=function(){var curr=this,styelm=this.getDocument().getElementById("ff-style-header");if(this.isEditMode()&&(styelm&&styelm.parentNode.removeChild(styelm),styelm=null),!styelm){styelm=document.createElement("div"),styelm.id="ff-style-header";var bodyelm=document.getElementsByTagName("body")[0];bodyelm&&bodyelm.appendChild(styelm),styelm.innerHTML=ejs.render(this.template.style,this)}var elm=this.getContentElement();if(elm){this.__compiledtext||(this.__compiledtext=ejs.compile(this.template.text)),elm.innerHTML=this.__compiledtext(this),this.renderUpload(),this.renderSignature();var pypanes=elm.querySelectorAll(".walletpane");if(pypanes.length>0){var peerhost=curr.data.devEnv?"//localhost:3000":"//pay.peergateway.com";window.loadingScripts=window.loadingScripts||curr.loadScripts([peerhost+"/js/pay/google-forms.js?_=v8"]);var fac=curr.data.facade||{},stg=fac.setting||{};window.loadingScripts.then((e=>{pypanes.forEach((e=>{var{wallet:t,to:r,amount:n}=e.dataset||{},a=(curr.draft.savedId||"Neartail").replace(/[^A-Z0-9]/gi,"");if(curr.draft.submitSeq){var i=curr.draft.submitSeq,s=curr.data.scraped.form||curr.data.scraped.title||"Order";s=(s=s.replace(/[^A-Z0-9]/gi,"").toUpperCase()).length>3?s.substring(0,3):"ORD",i.toString().length>5&&(a=i);let e="000000"+i;a=s+e.substr(e.length-5)}var o={app:"neartail",userId:curr.data.request.params.userId,wallet:t,orderId:curr.draft.savedId,amount:n,currency:stg.currency,currencyCode:stg.currencyCode,to:r,toname:curr.config.title||curr.data.scraped.title,note:a};e.payment=new GoogleFormsPayment(o),e.payment.load("#"+e.id)}))}))}curr.compute();var frm=elm.querySelector("form");if(!frm)return console.warn("Form not found in Formfacade");frm.addEventListener("change",(function(e){curr.saveDraft(e)}));var config=this.config||{};if("warned"==config.plan||"blocked"==config.plan){var fac=this.data.facade||{},facstg=fac.setting||{},params=this.data.request.params||{},pricingpage="https://formfacade.com/website/pricing.html";facstg.currency&&(pricingpage="https://neartail.com/order-form/pricing.html"),this.showPopup(("blocked"==config.plan?"âš¡":"âš ")+" Free limit exceeded","This form has exceeded its free limit. If you are the owner of this form, please upgrade to a paid plan. If not, contact the owner.",`<a class="btn btn-lg btn-primary" href="${pricingpage}?userId=${params.userId}" target="_blank">Upgrade</a>`,{render:"blocked"==config.plan})}var onload=curr.data.request.query.onload;onload&&window[onload]&&window[onload](curr);var fc=curr.data.facade,jsrender=fc&&fc.enhance?fc.enhance.js:null;jsrender&&eval(jsrender)}},this.stat=function(e){},this.showAll=function(){this.getDocument().querySelectorAll(".ff-section").forEach((function(e){e.style.display="block"}))},this.submit=function(frm,secid,callback){var invalids="-3"==secid?0:this.validate(frm,secid);if(!(invalids>0||this.submitting)){this.showMessage(secid);var curr=this,fc=curr.data.facade||{};if(fc.formfillable&&1!=this.consentAgreed){var fc=this.data.facade,submitSec=fc&&fc.submit&&fc.submit[secid]||{};if(submitSec.consent)return this.consentSecId=secid,this.consentDialog(submitSec),!1}return curr.submitting=Promise.resolve(curr.saving).then((function(){for(var e,t,r={},n=new FormData(frm).entries();(e=n.next())&&!1===e.done;){var a=r[(t=e.value)[0]];a?a.push(t[1]):t[1]&&(r[t[0]]=[t[1]])}var i={draftSeq:!0,submitSeq:!0,paymentId:!0,consumerId:!0,products:!0,quantity:!0,amount:!1,email:!1,phone:!1};for(var s in i){var o=i[s];if(r[s])r[s]=r[s];else if(1==o)r[s]=curr.draft[s];else if(s&&o)if("phone"==s)r[s]=o;else if("emailAddress"==o)r[s]=curr.draft.emailAddress;else{var l=curr.data.scraped.items[o];r[s]=l?curr.draft.entry[l.entry]:null}}return r.pageHistory=curr.getPageHistory(),curr.draft.responseId&&(r.responseId=curr.draft.responseId),"blocked"==curr.config.plan&&(r.plan="blocked"),curr.stat("submitting"),window.gtag&&window.gtag("event","submit",{event_label:curr.data.request.params.publishId,value:curr.data.request.params.userId}),curr.sendData(r)})).then((e=>Promise.resolve(callback?callback(e):null).then((t=>e)).catch((t=>e)))).then((rs=>{var publishId=curr.data.request.params.publishId;if(curr.stat("goal"),curr.result=rs,rs&&200==rs.code){var smtxt;curr.createCookie("ff-"+publishId,"",-1),rs.submitSeq&&(curr.draft.submitSeq=rs.submitSeq,curr.draft.submitted=(new Date).getTime());var submitto="default",fc=curr.data.facade;if(fc&&fc.submit&&fc.submit[secid]){var itmsubmit=fc.submit[secid];if(itmsubmit.js)try{eval(itmsubmit.js)}catch(e){console.error(itmsubmit.js+" failed due to "+e)}if(itmsubmit.submitto?submitto=itmsubmit.submitto:fc.whatsapp&&fc.whatsapp.phone?submitto="whatsapp":itmsubmit.onsubmit&&(submitto=itmsubmit.onsubmit),"custom"==submitto&&(itmsubmit.messageMark?curr.result.messageMark=itmsubmit.messageMark:curr.result.messagePlain=itmsubmit.message),"ifmsg"==submitto){var iftmpl='${computeCondition("'+secid+'")}';curr.result.messageMark=curr.calculateEngine(iftmpl),curr.result.messageMark||(curr.result.messageMark="(No message)")}else{if("redirect"==submitto&&itmsubmit.redirect){var reurl=curr.computeField(itmsubmit.redirect);return void(reurl?window.top.location.href=reurl.trim():console.error(itmsubmit.redirect+" is not a redirection url"))}"whatsapp"==submitto&&itmsubmit.wamsg&&(smtxt=curr.computeField(itmsubmit.wamsg))}var{status:status}=curr.config.mobile||{},{slug:slug}=curr.config.perma||{};if("active"==status||"LOGGED_IN"==status){var mapping=curr.data.facade.mapping||{},emailfld=curr.data.scraped.items[mapping.email]||{},emailval=curr.draft.entry[emailfld.entry];emailval&&curr.result.messageMark&&(curr.result.messageMark+='\n<div class="ff-cta-center" style="margin-top:40px;">\n    <h4>You can download Neartail app to track status and message us easily.</h4>\n    <a href="https://apps.apple.com/app/id6450004218" target="_blank" class="ff-app-install">\n        <img src="https://near.tl/images/app-store-badge.svg" style="width:150px;">\n    </a>\n    <a href="https://play.google.com/store/apps/details?id=com.neartale" target="_blank" class="ff-app-install">\n        <img src="https://near.tl/images/play-store-badge.svg" style="padding-left:10px; width:158px;">\n    </a>\n</div>\n                            ')}}var phn=curr.getPhone(secid);if(phn){curr.draft.waphone=phn;var ph=phn.match(/\d+/g).join("");if(curr.render(),!smtxt){var sfrm=curr.data.scraped||{},spref=sfrm.title||sfrm.form||"Untitled";spref="*"+spref+"* #"+curr.draft.submitSeq+"\n\n",smtxt=spref+curr.computeField('${TEXTSUMMARY(true, true, "*")}'),smtxt+="\n\n(Press send to confirm)"}var phurl="https://wa.me/"+ph+"?text="+encodeURIComponent(smtxt);if(curr.isMobile())setTimeout((function(){window.top.location.href=phurl}),500);else{var qrhtml=`\n                            <div class="ff-wa-qrcode form-group ff-item ff-section_header ff-full-width ff-item-noprd">\n                                <h4 class="ff-section-header">Scan this QR code to confirm your order!</h4>\n                                <img src="https://neartail.com/payment/qrcode/generate?url=${encodeURIComponent(phurl)}"><br>\n                                <div class="ff-description">\n                                    Once you scan this QR code, you will prompted to submit this order on WhatsApp.\n                                    If WhatsApp is already installed on this computer, \n                                    <a href="${phurl}">click here to continue</a>. \n                                </div>\n                            </div>\n                        `,su=document.getElementById("ff-success");su&&(su.innerHTML=qrhtml)}setTimeout((function(){var e=document.getElementById("ff-success"),t=document.getElementById("ff-success-hide");e&&t&&(e.innerHTML=t.innerHTML)}),1e3*(curr.isMobile()?10:1e3))}else curr.render();curr.scrollIntoView(),curr.getDocument().querySelectorAll(".ff-payment-form").forEach((e=>e.style.display="none"))}else{if(rs&&rs.code)throw curr.getDocument().querySelectorAll("#ff-submit-"+secid+" img").forEach((function(e){e.src="https://neartail.com/img/send.svg"})),new Error("Not able to update this response in Google Forms");formFacade.render()}var onsubmit=curr.data.request.query.onsubmit;window.cartSidebar&&cartSidebar.fetch("submit"),window.facadeListener&&facadeListener.onChange("submit",curr),onsubmit&&window[onsubmit]&&window[onsubmit](curr)})).catch((function(e){var t=e.toString()+". Submit it again. Contact owner, if this error occurs repeatedly.";curr.showError("Submit failed",t,'<button class="btn btn-lg btn-primary" id="resubmit">Resubmit</button>');document.getElementById("resubmit").addEventListener("click",(function(){curr.closePopup(!1),curr.submit(frm,secid,callback)})),curr.submitting=null})),!1}},this.confirmwa=function(e){var t=this,r="https://formfacade.com";t.data.devEnv&&(r="http://localhost:5000");var n=t.data.request.params;if(t.draft.savedId){var a=r+"/draft/"+n.publishId+"/whatsapp/"+t.draft.savedId,i=new XMLHttpRequest;i.open("POST",a,!0),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.send("phone="+encodeURIComponent(e))}return delete t.data.facade.whatsapp.askwa,t.render(),!1},this.savePayment=function(){var e=this,t="https://formfacade.com";e.data.devEnv&&(t="http://localhost:5000");var r=e.data.request.params;if(e.draft.savedId){var n=t+"/draft/"+r.publishId+"/payment/"+e.draft.savedId,a=new XMLHttpRequest;a.open("POST",n,!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.send("status=paid not verified")}},this.submitData=function(e){var t={id:this.data.request.params.publishId},r=this.data.scraped.items;for(var n in r){var a=r[n],i=e[a.title];i&&a.entry&&(t["entry."+a.entry]=i)}return this.sendData(t)},this.sendData=function(e,t){var r=this;return new Promise((function(n,a){var i="https://formfacade.com";r.data.devEnv&&(i="http://localhost:5000");var s=i+(t||"/submitForm"),o=r.data.request.params,l=r.draft.savedId;l||(l=r.readCookie("ff-"+o.publishId)),!t&&o.userId&&o.publishId&&(s=l?s+"/"+o.userId+"/form/"+o.publishId+"/draft/"+l:s+"/"+o.userId+"/form/"+o.publishId+"/draft");var{originId:c,originTime:f}=r.config||{};o=`callback=callbackFormFacade&originId=${c}&originTime=${f}`;for(var d in e){var m=e[d];m&&Array.isArray(m)?m.forEach((function(e){o+="&"+d+"="+encodeURIComponent(e)})):m&&(o+="&"+d+"="+encodeURIComponent(m))}var p=new XMLHttpRequest;p.open("POST",s,!0),p.setRequestHeader("Content-type","application/x-www-form-urlencoded"),p.onload=function(){try{var e=JSON.parse(p.response);200==p.status&&n(e),201==p.status?n(e):p.status>=400&&a(e)}catch(e){a(e)}},p.onerror=e=>a(p.response||"Couldn't connect to server"),p.send(o)}))},this.getHistory=function(e){if(e){var t=this;e=e.toLowerCase();var{userId:r,publishId:n}=this.data.request.params,a=`${this.data.devEnv?"http://localhost:5000":"https://formfacade.com"}/draft/${r}/history/${n}?email=${encodeURIComponent(e)}`;fetch(a).then((e=>e.json())).then((e=>{t.draft.history=e||null,t.saveDraft()}))}},this.getPrice=function(e,t="$"){if(e.price)return e.price;var r=(this.data.facade.items?this.data.facade.items:{})[e.id],n={min:0};if(r&&r.price?n.min=r.price:e.help&&e.help.indexOf("${")<0&&e.help.indexOf(t)>=0&&(n.min=formFacade.computeField('${price("'+e.help+'","'+t+'")}')),0==n.min)if("LIST"==e.type||"MULTIPLE_CHOICE"==e.type||"SCALE"==e.type||"CHECKBOX"==e.type)e.choices&&((i=e.choices.map((e=>e.value.indexOf(t)>=0?formFacade.computeField('${price("'+e.value+'","'+t+'")}'):0))).sort(((e,t)=>e-t)),n.min=i[0],n.max=i.pop());else if(r&&"Configurable"==r.measure){var a=r.variants||{};(i=Object.values(a).filter((e=>!e.remain||e.remain>0)).map((e=>Number(e.price)))).sort(((e,t)=>e-t)),n.min=i[0],n.max=i.pop()}else if("GRID"==e.type){var i;if(e.rows)(i=e.rows.map((e=>e.value.indexOf(t)>=0?formFacade.computeField('${price("'+e.value+'","'+t+'")}'):0))).sort(((e,t)=>e-t)),n.min=i[0],n.max=i.pop()}return n.min>0&&(n.minformat=formFacade.computeField("${format("+n.min+',"'+t+'")}')),n.max>0&&(n.maxformat=formFacade.computeField("${format("+n.max+',"'+t+'")}')),r&&r.fullprice>0&&(n.fullformat=formFacade.computeField("${format("+r.fullprice+',"'+t+'")}')),e.price=n,n},this.formatWeight=function(e){if(isNaN(e))return e;var t=new Number(e),r="kg",n=this.data.facade;return n.setting&&"USD"==n.setting.currencyCode&&(r="lb"),"kg"==r?t<1?1e3*t+" gm":t+" kg":t<1?16*t+" oz":t+" lb"},this.hasProducts=function(e){var t=this.data.facade.items?this.data.facade.items:{};return e.items.filter((function(e,r){if("product"==(t[e.id]?t[e.id]:{}).widget)return e})).length},this.getSections=function(e){if(this.__sections&&!e)return this.__sections;var t=this.data.scraped,r=0;if(t&&t.items&&(r=Object.keys(t.items).length),r>0){var n=this,a=this.data.facade;a||(a={}),a.setting||(a.setting={});var i=a.items?a.items:{},s="USD"==a.setting.currencyCode?"lb":"kg",o=a.setting.officeUseSections||{},l=Object.keys(o);return this.__sections=this.asSections(t),this.__sections.forEach(((e,t)=>{e.items.filter((e=>["SECTION_HEADER","PAGE_BREAK","DATE","TIME","IMAGE","VIDEO"].indexOf(e.type)<0)).forEach((function(e,t){var r;if(i[e.id]||(i[e.id]={}),(r=i[e.id]).deleted&&(e.deleted=r.deleted),n.data.fulledit?"hide"!=r.mode&&"officeuse"!=r.mode||(r.mode="edit"):n.data.restoreId&&("officeuse"==n.data.appearance?"officeuse"==r.mode?r.mode="edit":"hide"==r.mode?r.mode="hide":r.mode="read":"officeuse"==r.mode&&(r.mode="hide")),e.price=a.setting.currency?n.getPrice(e,a.setting.currency):{},e.product=(e.price.min>0||e.price.max>0)&&e.titleImage?{i:t}:null,("product"==r.widget||r.prdimage)&&(e.product={i:t,noun:a.setting.noun}),e.product){if("TEXT"==e.type&&r.choices||"TEXT"==e.basetype)e.type="LIST",e.basetype="TEXT",0==(r.discounted?r.discounted.filter((e=>e)).length:0)&&delete r.discounted,r.choices?e.choices=r.choices.map(((e,t)=>{var i={value:e};if("Weight"==r.measure&&(i.display=n.formatWeight(i.value)),r.discounted&&(i.discounted=r.discounted[t],i.discounted)){var s=i.display?i.display:i.value;i.display=s+" <small>"+n.computeField("${format("+i.discounted+',"'+a.setting.currency+'")}')+"</small>"}return i})):(e.choices=null,e.type="TEXT"),"yes"==r.inventory&&r.measure&&0==isNaN(r.remain)&&e.choices&&(e.choices=e.choices.filter((e=>{if(0==isNaN(e.value)&&parseFloat(e.value)>r.remain)return!1;return!0})));else if("PARAGRAPH_TEXT"==e.type&&r.variants){for(var o in r.variants){var l=r.variants[o];l.price&&(l.display=l.name+" <small>"+n.computeField("${format("+l.price+',"'+a.setting.currency+'")}')+"</small>")}if("yes"==r.inventory){var c=Object.values(r.variants).filter((e=>e.remain<=0));Object.keys(r.variants).length==Object.keys(c).length?r.remain=0:r.remain=1}}r.measure&&(r.choices&&r.choices.length>0?r.placeholder=n.lang("Select "+r.measure):r.placeholder=n.lang("Enter "+r.measure),"Weight"==r.measure&&(r.placeholder+=" ("+s+")"))}})),l.length>0&&e.headers.forEach(((e,t)=>{if(e.head){var r,a=e.head.id;if(i[a]||(i[a]={}),r=i[a],n.data.fulledit)"hide"!=r.mode&&"officeuse"!=r.mode||(r.mode="edit");else if("officeuse"==n.data.appearance)if(n.data.officeuseSectionId==a)r.mode="edit";else if(n.officeUseSectionHasEntry(e))r.mode="read";else{r.mode="read",(n.data.facade.titles[a]||{}).messageMark="-- Not yet completed --"}else l.indexOf(a)>-1&&(r.mode="hide");e.items.forEach(((t,s)=>{var o;i[t.id]||(i[t.id]={}),o=i[t.id],"officeuse"==n.data.appearance?l.indexOf(a)>-1&&(o.mode=r.mode,n.data.officeuseSectionId==a||n.officeUseSectionHasEntry(e)||(o.mode="hide"),i[t.id]&&"approver"==i[t.id].required&&"edit"==o.mode&&(t.required=1)):"hide"==r.mode&&(o.mode=r.mode),n.isEditMode()&&i[t.id]&&"approver"==i[t.id].required&&(t.required=1),o.isOfficeuseHeader=l.indexOf(a)>-1}))}})),e.allItems=e.items,e.items=e.items.filter((e=>!e.deleted))})),this.__sections}return[]},this.officeUseSectionHasEntry=function(e){var t=!1,r=this.draft.entry||{};return e.items.forEach(((e,n)=>{e.entry&&r[e.entry]&&(t=!0)})),t},this.splitHeaders=function(e){var t=this,r=[],n=(this.data.facade||{}).items||{};return e.forEach((e=>{var a=[],i=[];e.items.forEach((function(e,t){var r=n[e.id]||{};"yes"==r.inventory&&r.remain<=0?i.push(e):a.push(e)}));var s=Object.assign({},e,{items:a});if(r.push(s),i.length>0){var o={outstock:!0,head:{outstock:"out-"+(i[0]||{}).id,title:t.lang("Sold out!"),help:t.lang("Order early to avoid missing out next time")},items:i};r.push(o)}})),r},this.validate=function(e,t){var r=this,n=[],a=this.getDocument(),i=new FormData(e),s=this.getSections(),o=s[0];s.forEach((function(e,r){e.id==t&&(o=e)})),a.querySelectorAll("#ff-sec-"+o.id+" .ff-widget-error").forEach((function(e){e.style.display="none"}));var l=a.getElementById("WidgetemailAddress");if(l&&0==l.checkValidity()){var c=a.getElementById("ErroremailAddress");l.value?c.innerHTML="<b>!</b>"+r.lang("Must be a valid email address"):c.innerHTML="<b>!</b>"+r.lang("This is a required question"),c.style.display="block",n.push(l)}return o.items.forEach((function(e,t){var s=a.querySelector("#ff-id-"+e.id+" input");"PARAGRAPH_TEXT"==e.type?s=a.querySelector("#ff-id-"+e.id+" textarea"):"LIST"==e.type&&((s=a.querySelector("#ff-id-"+e.id+" select"))||(s=a.querySelector("#ff-id-"+e.id+" input")));var o,l=function(t){n.push(s);var r=a.getElementById("Error"+e.id);r&&(r.innerHTML="<b>!</b>"+t,r.style.display="block")},c=!0;if(s&&(s.readOnly?(s.readOnly=!1,c=s.checkValidity(),s.readOnly=!0):c=s.checkValidity(),o=i.get(s.name)),0==c)e.required&&!o?l(r.lang("This is a required question")):o?"email"==s.type?l(r.lang("Must be a valid email address")):"date"==s.type||"datetime-local"==s.type?l(r.lang("Invalid date")):l(r.lang("Invalid input")):l(r.lang("Invalid input"));else if(s&&s.list&&o&&e.choices){0==e.choices.filter((e=>e.value==o.trim())).length&&l(r.lang("Invalid answer. Clear & select a valid answer from the list"))}else r.data.facade&&r.data.facade.items&&(e.overwrite=r.data.facade.items[e.id]),r.validateEngine(e,i,l)})),n.length>0&&(n[0].focus(),this.scrollIntoView(n[0])),n.length},this.getPairs=function(e){for(var t,r,n={},a=(e?new FormData(e):new FormData).entries();(t=a.next())&&!1===t.done;){var i=n[(r=t.value)[0]];i?i.push(r[1]):r[1]&&(n[r[0]]=[r[1]])}return n},this.getNextSectionId=function(e){var t=this.getSections(),r=(this.data.facade||{}).items||{},n=t.filter((e=>{var t=e.items.filter((e=>e.product));return!(t.length>0)||t.filter((e=>{var t=r[e.id]||{};return!("hide"==t.mode||"yes"==t.inventory&&t.remain<=0)})).length>0})),a=n.findIndex((t=>t.id==e)),i=n[a+1];return i?i.id:(a=t.findIndex((t=>t.id==e)),(i=t[a+1])?i.id:e)},this.gotoSection=function(e={},t,r){var n,a=this.getDocument();if("back"==r){n=this.draft.pageHistory.pop();var i=this.data.facade||{};(i.neartail||i.whatsapp)&&(this.draft.pageHistory.unshift(n),this.draft.pageHistory.unshift(t))}else{if(this.saveDraft(),this.validate(e,t)>0)return;n=r||this.getNextSectionId(t);var s=this.data.scraped.items||{};a.querySelectorAll("#ff-sec-"+t+" .ff-nav-dyn").forEach((function(t={},r){var a=[],i=t.id?t.id.split("-").pop():null,o=s[i]||{},l=e["entry."+o.entry]||{};o.choices&&(a=o.choices.filter((e=>e.value==l.value))),a.length>0&&(n=a[0].navigateTo)})),-1==n?n=t:-2==n?n=this.getNextSectionId(t):-3==n&&(n="ending")}this.jumptoSection(e,t,r,n)},this.directtoSection=function(e,t){document.body.style.overflowY="auto";var r=this.getContentElement().querySelector("form"),n=this.draft.activePage||"root";this.jumptoSection(r,n,n,e,t)},this.login=function(e={}){var t=this;if(e.sub){this.draft.consumerId=e.sub;var{mapping:r}=this.data.facade||{};r||(r={});var{items:n}=this.data.scraped||{};n||(n={});var a=this.draft.entry||{},i=this.data.request.params.publishId,s="";return window&&window.location&&"near.tl"===window.location.hostname&&(s="https://neartail.com"),fetch(s+"/consumer/"+i+"/google/"+e.sub,{method:"post",body:JSON.stringify(e),headers:{accept:"application/json","content-type":"application/json"}}).then((e=>e.json())).then((function(e){for(var i in e){var s=e[i],o=r[i],l=n[o]||{};if(l.entry&&s)a[l.entry]||(a[l.entry]=s)}return t.draft.entry=a,t.render(),t.saveDraft()})).catch((e=>e))}},this.zoomImage=e=>{var t=e.getAttribute("activeIndex");null==t&&(t="-1"),document.querySelector("[prd-img-index='"+t+"']").click()},this.scrollAdditionalImage=e=>{"down"===e?(document.querySelector(".ff-prdimglast").scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"}),document.querySelector(".ff-downarrow-button").style.display="none",document.querySelector(".ff-uparrow-button").style.display="flex"):(document.querySelector(".ff-prdimgfirst").scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),document.querySelector(".ff-downarrow-button").style.display="flex",document.querySelector(".ff-uparrow-button").style.display="none")},this.changeAdditionalImage=e=>{document.querySelector(".ff-prdimg.ff-prdimage-zoom").src=e.src,document.querySelector(".ff-prdimg.ff-prdimage-zoom").setAttribute("activeIndex",e.getAttribute("index")),document.querySelectorAll(".ff-prdimg-thumbnail.ff-prdimg-active").forEach((e=>{e.classList.remove("ff-prdimg-active")})),e.classList.add("ff-prdimg-active")},this.jumptoSection=function(e,t,r,n,a){var i=this;this.scrapeSection(this.getPageHistory()),this.draft.activePage=n;var{setting:s}=this.data.facade||{},{loginpage:o}=s||{};if(o==n&&window.loadOneTap&&!this.draft.consumerId){this.data&&(this.data.fulledit||this.data.officeuseSectionId)||loadOneTap().then((e=>i.login(e))).catch((e=>e))}if(this.render(),a){var l=document.getElementById("ff-id-"+a)||{};l.scrollIntoView&&setTimeout((()=>{l.scrollIntoView(!0)}),100)}else this.scrollIntoView();"back"!=r&&(this.draft.pageHistory.push(t),window.gtag&&window.gtag("event","goto",{event_category:"formfacade",event_label:this.data.request.params.publishId+"-"+t,value:this.draft.pageHistory.length}))},this.scrollIntoView=function(e){if(e||(e=this.getContentElement()||{}),"hidden"==e.type&&(e=e.parentElement),e.scrollIntoView){"ff-compose"==e.id&&e.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"});const t=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0);let r=e.offsetTop,n=e.offsetParent;for(;n;)r+=n.offsetTop,n=n.offsetParent;const a=r-.3*t;if(a<0)return;window.scrollTo({top:a,behavior:"smooth"});try{window.parent&&window.parent.scrollIntoView&&window.parent.scrollIntoView()}catch(e){}}},this.scrapeSection=function(e){var t=this,r=this.getContentElement();if(!r)return Promise.resolve();var n=r.querySelector("form"),a=t.getPairs(n),i=this.data.request.params.publishId;return e&&(a.pageHistory=e,a.continue=1),this.sendData(a,"/nextSection/"+i).then((function(e={}){if(e.images){t.data.form||(t.data.form={});var r=t.data.form.images;t.data.form.images=Object.assign(r||{},e.images)}})).catch((function(e){console.warn("nextSection failed with "+e)}))},this.getPageHistory=function(){var e=this,t=[];return this.getDocument().querySelectorAll(".ff-section").forEach((function(r,n){var a=r.id.split("-").pop();e.data.scraped.items[a];(e.draft.pageHistory.indexOf(a)>=0||e.draft.activePage==a)&&t.push("ending"==a?"-3":n)})),t.join(",")},this.getDocument=function(){return document},this.lang=function(e,t){if(this.langtext&&this.langtext[e]&&(e=this.langtext[e]),e&&t)for(var r in t){var n=t[r];e=e.split("$"+r).join(n)}return e},this.isMobile=function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t},this.isIos=function(){return/iphone|ipad|ipod/gi.test(navigator.userAgent)||null!==navigator.userAgent.match(/iPad|Macintosh/i)&&"ontouchend"in document},this.isTestUser=function(e){return["115950622256526421100","114565391771428289104","105242287939464144485","111716875395075072856","110010512446331946668"].indexOf(e)>-1},this.uploadFile=function(e,t,r){var n=this,a=n.getDocument(),i=a.getElementById("Status"+e);return i&&(i.innerHTML="Uploading..."),new Promise((function(e,a){var i="https://formfacade.com/upload/"+n.data.request.params.publishId+"/"+(n.draft&&n.draft.savedId?n.draft.savedId:"none")+"/"+t,s=new FormData;s.append("file",r.files[0]);var o=new XMLHttpRequest;o.open("POST",i,!0),o.onload=function(){try{var t=JSON.parse(o.response);200==o.status&&e(t),201==o.status?e(t):o.status>=400&&a(t)}catch(e){a(e)}},o.onerror=e=>a(o.response||"Couldn't connect to server"),o.send(s)})).then((function(t){n.draft.savedId=t.savedId;var r=a.getElementById("Widget"+e);r&&(r.value=t.file,r.dispatchEvent(new Event("change",{bubbles:!0}))),i&&(i.innerHTML=t.file.split("/").pop())}))},this.getPaymentButtons=function(){var e=[];if(!this.data.scraped.items)return e;var t=this.data.facade||{};if("on"==(t.enhance||{}).closed)return e;var r=t.submit||{};for(var n in r){var a=r[n]||{};"peergateway"==a.payConfig?(a.id=n,e.push(a)):"disabled"==a.payConfig||a.amountFrom&&(a.id=n,e.push(a))}return e},this.showPayment=function(e,t){if(this.validate(e,t)>0)return;const r=document&&document.querySelector(".ff-form");r&&r.scrollIntoView(),this.draft.pageHistory.push(t);var n=this.getDocument().querySelectorAll("#ff-submit-"+t+" img");n.forEach((e=>e.src="https://formfacade.com/img/loading.svg"));var a,i,s=this.data.facade?this.data.facade:{},o=this.data.scraped.items||{},l=s.mapping||{},c=(s.submit?s.submit:{})[t]||{};if(c.amountFrom?a=o[c.amountFrom]:l["net-amount"]?a=o[l["net-amount"]]:l.amount&&(a=o[l.amount]),!a||!a.entry){this.showPopup("Submit failed",'<span style="color:red">âš  Amount is not configured correctly. Please contact your admin to resolve.</span>');var f=l["net-amount"]?"Net Amount":"Amount";return this.showWarning("Invalid amount configuration",`You have not mapped the amount field required for payment. Please select the correct field for the ${f} option`,null,{ignorePopup:!0}),n.forEach((e=>e.src="https://formfacade.com/img/send.svg")),!1}if((i=this.draft.entry[a.entry])&&(this.draft.amount=i),isNaN(i))return this.showPopup("Submit failed",'<span style="color:red">âš  Amount is not configured correctly. Please contact your admin to resolve.</span>'),this.showWarning("Invalid amount configuration","You have mapped a text field for Amount. Please select the correct field for the Amount option.",null,{ignorePopup:!0}),n.forEach((e=>e.src="https://formfacade.com/img/send.svg")),!1;"peergateway"==c.payConfig&&c.configId?this.showPeerPayment(t,i):this.showCardPayment(t,i),r&&r.scrollIntoView()},this.showPeerPayment=function(e,t){var r=this;this.draft.paymentStatus="initiated",this.saveDraft(),this.draft.activePage=e+"-pay",this.render(),this.getDocument().getElementById("ff-payment-form-"+e).innerHTML="<h3>Loading...</h3>";const n=document.querySelector(".ff-form");n&&n.scrollIntoView();var a=this.data.request.params.userId,i=[(this.data.devEnv?"//localhost:3000":"//pay.peergateway.com")+"/js/pay_v1/payment-forms.js?_=v18"];Promise.resolve(window.PaymentForm||this.loadScripts(i)).then((n=>{var i={};["name","email","phone","address"].forEach((e=>{var t=r.data.facade.mapping[e],n=t?r.data.scraped.items[t]:null;i[e]=n?r.draft.entry[n.entry]:null}));var{name:s,email:o,phone:l,address:c}=i,f=r.draft.savedId,d=Promise.resolve(f);f||(d=r.saving?r.saving.then((e=>r.draft.savedId)):r.saveDraft().then((e=>r.draft.savedId))),d.then((function(n){f=n;var i=r.draft.savedId+"*"+r.draft.draftSeq,d={name:s,email:o,phone:l,orderId:f,address:c,trackingNumber:i},m=r.data.facade.setting||{},{currency:p,currencyCode:u}=m,h=(r.data.facade.submit||{})[e]||{},g=(r.calculateEngine("${getBill()}",{returntype:!0})||[])[0];g=r.calculateEngine("${getBill()}",{returntype:!0}).map((function(e){return{name:e[0],quantity:e[2],quantity:e[2],unit_amount:{value:e[1],currency_code:u}}}));var v={app:"neartail",userId:a,configId:h.configId,currency:p,currencyCode:u,publishId:r.data.request.params.publishId,lineItems:g};window.paymentForm=new PaymentForm(v,{includeEJS:!1,translate:r.lang.bind(r),walletSelectCallback:function(t){var n=r.getDocument(),a=r.data.request.params.publishId,i=n.getElementById("PaymentData"+a);i&&(i.value=JSON.stringify(t));var s,o=n.getElementById("Publish"+a);r.draft.paymentStatus=t&&t.status||null;r.submit(o,e,(function(e){return r.createCookie("ff-"+a,"",-1),e.submitSeq&&(r.draft.submitSeq=e.submitSeq,r.draft.submitted=(new Date).getTime()),window.cartSidebar&&cartSidebar.fetch("submit"),window.facadeListener&&facadeListener.onChange("submit",r),e.submitSeq&&(s=r.paddingWithZero(e.submitSeq)),window.paymentForm.loadPeerGatewayWallets({note:s,orderId:r.draft.savedId}),new Promise((function(e,t){window.paymentConfirmPromise=e}))}))},markAsPaidCallback:function(e){r.draft.paymentStatus="paid not verified",r.savePayment(),window.paymentConfirmPromise&&window.paymentConfirmPromise()},paymentCallback:function(t){var n=r.getDocument(),a=r.data.request.params.publishId,i=n.getElementById("PaymentData"+a);i&&(i.value=JSON.stringify(t));var s=n.getElementById("Payment"+a);s&&t.tid&&(s.value=t.tid);var o=n.getElementById("Publish"+a);r.draft.paymentStatus=t.status||null,r.submit(o,e)}}),window.paymentForm.init("#ff-payment-form-"+e,t,d)}))}))},this.showCardPayment=function(e,t){var r=this,n="https://neartail.com";this.data.devEnv&&(n="http://localhost:5000");var a=this.data.request.params.userId;fetch(n+"/payment/"+a+"/intent/"+t,{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){if(r.paymentIntent=t,t.payment_method_types)t.payment_method_types.length>1?(r.draft.activePage=e+"-paylist",r.render()):r.showPaymentMethod(0,e);else{doc.getElementById("ff-card-element-"+e).innerHTML='<b style="color:red">Payment not configured correctly</b>';doc.getElementById("ff-card-errors-"+e).innerHTML=t.error?t.error:"Unknown error"}}))},this.showPaymentMethod=function(e,t){var r=this,n=this.getDocument();this.draft.activePage=t+"-pay",this.render();var a=this.paymentIntent,i=a.payment_method_types[e];paymentIntentClientSecret=a.clientSecret;var s,o=n.getElementById("ff-card-errors-"+t),l=Stripe(a.publishableKey,{stripeAccount:a.accountID}),c={payment_method:{billing_details:{}}};if(r.data.facade.mapping){var f={};["name","email","phone","address"].forEach((e=>{var t=r.data.facade.mapping[e],n=t?r.data.scraped.items[t]:null;f[e]=n?r.draft.entry[n.entry]:null}));var{name:d,email:m,phone:p,address:u}=f;c.payment_method.billing_details={name:d,email:m,phone:p};var h=r.draft.savedId+"*"+r.draft.draftSeq;c.shipping={tracking_number:h,name:d||"-",address:{line1:u||"-"}}}if(i.mount){(s=l.elements().create(i.mount,{style:{base:{color:"#32325d"}}})).mount("#ff-card-element-"+t),s.on("change",(({error:e})=>{o.textContent=e?e.message:""})),c.payment_method[i.id]=s}else{c.payment_method.billing_details.name||(c.payment_method.billing_details.name="neartail");var g=n.getElementById("ff-card-element-"+t);g&&(g.style.display="none")}n.getElementById("ff-payment-form-"+t).addEventListener("submit",(function(e){e.preventDefault(),o.textContent="",n.querySelectorAll("#ff-pay-"+t+" img").forEach((function(e){e.src="https://formfacade.com/img/loading.svg"})),"redirect"==i.flow&&(c.return_url=location.href.split("?")[0],r.createCookie("ff-payment-section",t,1/24),r.createCookie("ff-payment_intent_client_secret",paymentIntentClientSecret,1/24),r.draft.activePage=t,r.saveDraft()),l[i.invoke](a.clientSecret,c).then((function(e){if(e.error)o.innerHTML=e.error.message,n.querySelectorAll("#ff-pay-"+t+" img").forEach((function(e){e.src="https://formfacade.com/img/send.svg"}));else if(e.paymentIntent&&"succeeded"===e.paymentIntent.status){var a=n.getElementById("Payment"+r.data.request.params.publishId);a&&(a.value=e.paymentIntent.id);var i=n.getElementById("Publish"+r.data.request.params.publishId);r.draft.activePage=null,n.querySelectorAll("#ff-pay-"+t+" img").forEach((function(e){e.src="https://formfacade.com/img/loading.svg"})),r.submit(i,t)}}))}))},this.showNavigation=function(){document.getElementById("ff-addprd-overlay").classList.add("active");var e=document.getElementById("ff-addprd-popup");e.classList.add("active"),e.innerHTML=ejs.render(this.template.navigation,this),document.body.style.overflowY="hidden"},this.closeNavigation=function(){document.body.style.overflowY="auto",document.getElementById("ff-addprd-overlay").classList.remove("active"),document.getElementById("ff-addprd-popup").classList.remove("active")},this.checkInventory=function(e){var t=this,r=((this.data.facade||{}).items||{})[e]||{};if("yes"==r.inventory){var{publishId:n}=t.data.request.params;return fetch("https://cache.formfacade.com/data/facade/"+n+"-editable").then((e=>e.json())).then((n=>{var a=n.items[e]||{};if(t.data.facade=n,t.getSections(!0),"Configurable"==r.measure&&r.variants){var i=r.variants||{};for(var s in i){var o=i[s];if(a.variants[s].remain<o.remain)return!0}}else if("Quantity"==r.measure||"Weight"==r.measure)return a.remain<r.remain}))}return Promise.resolve(!1)},this.showProduct=function(e,t,r=0){var n=this;this.product={id:e};var a=this.data.scraped.items[e];if(a&&"PARAGRAPH_TEXT"==a.type){var i=this.draft.entry?this.draft.entry[a.entry]:null;this.product.configurable=this.toConfigurable(i),this.product.configurable.index=r;var s=this.product.configurable.configItem[r];this.product.configItem=s||{lineItem:{},selected:null,page:"variant"},this.product.configurable.configItem[r]=this.product.configItem}document.getElementById("ff-addprd-overlay").classList.add("active");var o=document.getElementById("ff-addprd-popup");o.classList.add("active"),a&&this.draft.entry[a.entry]&&(t=2),this.initialActiveTab=2===t?"cart":"description",this.params={},this.data&&this.data.request&&this.data.request.params&&(this.params=this.data.request.params),o.innerHTML=ejs.render(this.template.product,this),document.body.style.overflowY="hidden",this.checkInventory(e).then((t=>{t&&n.showProduct(e)}))},this.addProduct=function(e,t,r){var n=this.draft.entry[e];n=(n=n?Array.isArray(n)?n:[n]:[]).concat(t),this.updateProduct(e,n,r)},this.removeProduct=function(e,t,r){var n=this.draft.entry[e];const a=(n=n?Array.isArray(n)?n:[n]:[]).indexOf(t);a>-1&&n.splice(a,1),this.updateProduct(e,n,r)},this.getModifiers=function(e){var t=(this.data.facade.items[e]||{}).modifiers||{},r=Object.entries(t).map((e=>{var[t,r]=e;return Object.assign({id:t},r)}));return r.sort(((e,t)=>e.index-t.index)),r},this.updateProduct=function(e,t,r){if(e&&(t?this.draft.entry[e]=t:delete this.draft.entry[e]),r){var n=this.product.id;if((this.data.facade.items[n]||{}).modifiers){var a=this.getModifiers(n)[0]||{};a.id?this.draft.entry[e]?this.showProduct(a.id,2):this.renderProduct():this.closePopup()}else this.closePopup()}else this.renderProduct()},this.renderProduct=function(e){var t=document.getElementById("ff-addprd-popup");this.initialActiveTab="cart",t.innerHTML=ejs.render(this.template.product,this);const r=document&&document.querySelector("#prdtab-cart");r&&r.scrollIntoView({behavior:"instant"})},this.submitConsent=function(){var{userId:e,publishId:t}=this.data.request.params;this.consentAgreed=!0;var r=document.getElementById(`Accepted${t}`),n=document.getElementById(`AcceptedAt${t}`);r&&(r.value=this.consentSecId),n&&(n.value=(new Date).getTime()),this.submit(document.getElementById(`Publish${t}`),this.consentSecId),this.closePopup(!1)},this.closeConsent=function(){document.querySelectorAll(`#ff-submit-${this.consentSecId} img`).forEach((function(e){e.src="https://formfacade.com/img/send.svg"})),this.closePopup(!1)},this.consentDialog=function(e){var{userId:t,publishId:r}=this.data.request.params,n="https://formfacade.com";this.data.devEnv&&(n="http://localhost:5000");var a=this;this.data.facade,this.data.scraped.items;if(null==e.template){a.addLinkTag("/js/mailrecipe/kanban.css");var i,{savedId:i}=this.draft||{};(i=a.draft.savedId)||(i=a.readCookie("ff-"+r));var s=Promise.resolve(i);i||(s=a.saveDraft().then((e=>a.draft.savedId))),s.then((function(e){if(!e)throw Error("Save failed! Try again.");fetch(`${n}/draft/${r}/summary/${i}`,{method:"GET"}).then((function(e){return e.text()})).then((function(e){var t=`<div class="ff-consent-start ff-consent-default"> ${e} </div>`;a.showConsentDialog(t)}))}))}else fetch(`${n}/consent/docs/${e.template}`,{method:"GET"}).then((e=>e.json())).then((e=>e||{})).then((function(e){var t=a.computeField(e.html);a.showConsentDialog(t)}))},this.showConsentDialog=function(e){document.getElementById("ff-addprd-overlay").classList.add("active");var t=document.getElementById("ff-addprd-popup");t.classList.add("active"),t.classList.add("ff-consent-confirm"),t.innerHTML=`\n            <div class="ff-consent-content"> <div class="ff-consent-body">${e} </div> </div>\n            <div class="ff-consent-footer ff-form">\n                <button type="button" class="rest-btn rest-btn-lg ff-submit" onClick="formFacade.submitConsent()" >Agree</button>\n                <button type="button" class="rest-btn rest-btn-lg ff-consent-close" onClick="formFacade.closeConsent()">Close</button>\n            </div>\n        `},this.toConfigurable=function(e=""){var t=this,r={configItem:[],index:0};return r.configItem=e.split("\n-----\n").map((e=>t.toConfigItem(e))),r.toValue=function(e){return this.configItem.map((t=>{var r=[];for(var n in t.lineItem){var a=t.lineItem[n],i=((e.variants||{})[n]||{}).name||"-";r.push(i+" | "+n+" * "+a)}return r.join("\n")})).join("\n-----\n")},r},this.toConfigItem=function(e){var t={lineItem:{},selected:null,page:"variant"};return(e?e.split("\n"):[]).forEach((e=>{var r=e.trim().split(" | ").pop(),[n,a]=r.trim().split(" * "),i=isNaN(a)?0:parseFloat(a);i>0&&(t.lineItem[n]=i)})),t},this.selectVariant=function(e){var t=this.product.configItem;t.selected=e,t.page="quantity",this.renderProduct()},this.updateQuantity=function(e,t,r){var n=this.data.scraped.items[this.product.id],a=this.data.facade.items[this.product.id],i=this.product.configItem;t?i.lineItem[e]=t:delete i.lineItem[e];var s=this.product.configurable.toValue(a);if(r){this.updateProduct(n.entry,s,r);var o=this.data.facade.items[this.product.id];(o=this.getModifiers()[0]||{}).id?this.showProduct(o.id):this.closePopup()}else"yes"==a.multiselect||a.modifierfor?(s?this.draft.entry[n.entry]=s:delete this.draft.entry[n.entry],this.product.configItem.page="variant",this.renderProduct()):this.updateProduct(n.entry,s,!0)},this.deleteCombo=function(e){var t=this,r=this.data.scraped.items[e]||{};delete this.draft.entry[r.entry],this.getModifiers(e).forEach((e=>{var r=t.data.scraped.items[e.id]||{};delete t.draft.entry[r.entry]})),this.closePopup()},this.showPopup=function(e,t,r,n={}){document.getElementById("ff-addprd-overlay").classList.add("active");var a=document.getElementById("ff-addprd-popup");a.classList.add("active"),a.innerHTML=`\n            <div class="ff-popup-header ff-error-popup">\n                <span class="ff-popup-title">${e}</span>\n                <span class="material-icons" onclick="formFacade.closePopup(${!!n.render})">close</span>\n            </div>\n            <div class='ff-error-popup'>\n                <div class="ff-popup-content">\n                    ${t}\n                </div>\n                <div class="ff-popup-footer">\n                    ${r||""}\n                </div>\n            </div>\n        `,document.body.style.overflowY="hidden"},this.showWarning=function(e,t,r,n={}){var a=e;t&&(a="string"==typeof t||t instanceof String?t:t instanceof Error?t.message:JSON.stringify(t)),1!=n.ignorePopup&&this.showPopup(`${e}`,`<span style="color:red">âš  ${a}</span>`,r);var{userId:i,publishId:s}=this.data.request.params,{savedId:o}=this.draft||{};if(s&&o){var{form:l,title:c}=this.data.scraped||{};const t=new URLSearchParams;t.append("title",e),t.append("message",a),t.append("form",l||c),t.append("critical",n.critical);var f=this.data.devEnv?"http://localhost:5000":"https://formfacade.com";fetch(`${f}/draft/${i}/form/${s}/error/${o}`,{method:"POST",body:t}).then((e=>e.json()))}},this.showError=function(e,t,r,n={}){n.critical=1,this.showWarning(e,t,r,n)},this.togglePrdTabPopup=function(e){const t=document.getElementById("prdtab-"+e),r=document.getElementById("prdtab-"+e+"-header");document.querySelectorAll(".prdtab-header").forEach((e=>{e.classList.remove("prdtab-active-header")})),document.querySelectorAll(".prdtab-content").forEach((e=>{e.classList.remove("prdtab-active")})),t.classList.add("prdtab-active"),r.classList.add("prdtab-active-header")},this.closePopup=function(e=!0){document.body.style.overflowY="auto",document.getElementById("ff-addprd-overlay").classList.remove("active");var t=document.getElementById("ff-addprd-popup");t.classList.remove("active"),t.classList.remove("ff-consent-confirm"),setTimeout((function(){e&&formFacade.render(),formFacade.saveDraft(),window.customizeTemplate&&window.customizeTemplate.renderFacadeInSinglePage()}),10)},this.slugify=function(e){return e?e.toString().trim().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,""):""},this.paddingWithZero=function(e,t=5){if((e=parseInt(e)).toString().length>t)return e;let r="0000000"+e;return"ORD"+r.substr(r.length-t)},this.encode=function(e){return e?"undefined"!=typeof window?window.btoa(e):Buffer.from(e).toString("base64"):""},this.getMinMaxDate=function(e,t){var r="1900-01-01",n="2200-01-01",a=(new Date,this.formatDate(new Date,"yyyy-MM-dd")),i=t.validation;if(i&&"Date"==i.validType)if("Past"==i.validOperator)n=a;else if("Future"==i.validOperator)r=a;else if("FutureLead"==i.validOperator){var s=this.addDays(new Date,parseInt(i.validValue||0));r=s=this.formatDate(s,"yyyy-MM-dd")}else"Between"==i.validOperator&&(i.validValue&&10==i.validValue.length&&(r=this.formatDate(new Date(i.validValue),"yyyy-MM-dd")),i.validValue2&&10==i.validValue2.length&&(n=this.formatDate(new Date(i.validValue2),"yyyy-MM-dd")));return 1==e.time&&(r+="T01:01",n+="T23:59"),[r,n]},this.formatDate=function(e,t){var r={M:e.getMonth()+1,d:e.getDate(),h:e.getHours(),m:e.getMinutes(),s:e.getSeconds()};return(t=t.replace(/(M+|d+|h+|m+|s+)/g,(function(e){return((e.length>1?"0":"")+r[e.slice(-1)]).slice(-2)}))).replace(/(y+)/g,(function(t){return e.getFullYear().toString().slice(-t.length)}))},this.addDays=function(e,t){var r=new Date(e);return r.setDate(r.getDate()+t),r},this.switchCDN=function(e){return e},this.switchAllCDN=function(e){return e&&e.indexOf("https://cdn.neartail.com/")>-1?e.replaceAll("https://cdn.neartail.com/","https://cdn.formfacade.com/"):e}}!function(e){"function"==typeof define&&define.amd,("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).ejs=e()}((function(){return function e(t,r,n){function a(s,o){if(!r[s]){if(!t[s]){var l="function"==typeof require&&require;if(!o&&l)return l(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var f=r[s]={exports:{}};t[s][0].call(f.exports,(function(e){return a(t[s][1][e]||e)}),f,f.exports,e,t,r,n)}return r[s].exports}for(var i="function"==typeof require&&require,s=0;s<n.length;s++)a(n[s]);return a}({1:[function(e,t,r){"use strict";var n=e("fs"),a=e("path"),i=e("./utils"),s=!1,o=e("../package.json").version,l="locals",c=["delimiter","scope","context","debug","compileDebug","client","_with","rmWhitespace","strict","filename","async"],f=c.concat("cache"),d=/^\uFEFF/;function m(e,t){var a;if(t.some((function(t){return a=r.resolveInclude(e,t,!0),n.existsSync(a)})))return a}function p(e,t){var n,a=e.filename,i=arguments.length>1;if(e.cache){if(!a)throw new Error("cache option requires a filename");if(n=r.cache.get(a))return n;i||(t=u(a).toString().replace(d,""))}else if(!i){if(!a)throw new Error("Internal EJS error: no file name or template provided");t=u(a).toString().replace(d,"")}return n=r.compile(t,e),e.cache&&r.cache.set(a,n),n}function u(e){return r.fileLoader(e)}function h(e,t){var a=i.shallowCopy({},t);if(a.filename=function(e,t){var a,i,s=t.views,o=/^[A-Za-z]+:\\|^\//.exec(e);if(o&&o.length)e=e.replace(/^\/*/,""),a=Array.isArray(t.root)?m(e,t.root):r.resolveInclude(e,t.root||"/",!0);else if(t.filename&&(i=r.resolveInclude(e,t.filename),n.existsSync(i)&&(a=i)),!a&&Array.isArray(s)&&(a=m(e,s)),!a&&"function"!=typeof t.includer)throw new Error('Could not find the include file "'+t.escapeFunction(e)+'"');return a}(e,a),"function"==typeof t.includer){var s=t.includer(e,a.filename);if(s&&(s.filename&&(a.filename=s.filename),s.template))return p(a,s.template)}return p(a)}function g(e,t,r,n,a){var i=t.split("\n"),s=Math.max(n-3,0),o=Math.min(i.length,n+3),l=a(r),c=i.slice(s,o).map((function(e,t){var r=t+s+1;return(r==n?" >> ":"    ")+r+"| "+e})).join("\n");throw e.path=l,e.message=(l||"ejs")+":"+n+"\n"+c+"\n\n"+e.message,e}function v(e){return e.replace(/;(\s*$)/,"$1")}function y(e,t){t=t||{};var n={};this.templateText=e,this.mode=null,this.truncate=!1,this.currentLine=1,this.source="",n.client=t.client||!1,n.escapeFunction=t.escape||t.escapeFunction||i.escapeXML,n.compileDebug=!1!==t.compileDebug,n.debug=!!t.debug,n.filename=t.filename,n.openDelimiter=t.openDelimiter||r.openDelimiter||"<",n.closeDelimiter=t.closeDelimiter||r.closeDelimiter||">",n.delimiter=t.delimiter||r.delimiter||"%",n.strict=t.strict||!1,n.context=t.context,n.cache=t.cache||!1,n.rmWhitespace=t.rmWhitespace,n.root=t.root,n.includer=t.includer,n.outputFunctionName=t.outputFunctionName,n.localsName=t.localsName||r.localsName||l,n.views=t.views,n.async=t.async,n.destructuredLocals=t.destructuredLocals,n.legacyInclude=void 0===t.legacyInclude||!!t.legacyInclude,n.strict?n._with=!1:n._with=void 0===t._with||t._with,this.opts=n,this.regex=this.createRegex()}r.cache=i.cache,r.fileLoader=n.readFileSync,r.localsName=l,r.promiseImpl=new Function("return this;")().Promise,r.resolveInclude=function(e,t,r){var n=a.dirname,i=a.extname,s=(0,a.resolve)(r?t:n(t),e);return i(e)||(s+=".ejs"),s},r.compile=function(e,t){return t&&t.scope&&(s||(console.warn("`scope` option is deprecated and will be removed in EJS 3"),s=!0),t.context||(t.context=t.scope),delete t.scope),new y(e,t).compile()},r.render=function(e,t,r){var n=t||{},a=r||{};return 2==arguments.length&&i.shallowCopyFromList(a,n,c),p(a,e)(n)},r.renderFile=function(){var e,t,n,a=Array.prototype.slice.call(arguments),s=a.shift(),o={filename:s};return"function"==typeof arguments[arguments.length-1]&&(e=a.pop()),a.length?(t=a.shift(),a.length?i.shallowCopy(o,a.pop()):(t.settings&&(t.settings.views&&(o.views=t.settings.views),t.settings["view cache"]&&(o.cache=!0),(n=t.settings["view options"])&&i.shallowCopy(o,n)),i.shallowCopyFromList(o,t,f)),o.filename=s):t={},function(e,t,n){var a;if(!n){if("function"==typeof r.promiseImpl)return new r.promiseImpl((function(r,n){try{r(a=p(e)(t))}catch(e){n(e)}}));throw new Error("Please provide a callback function")}try{a=p(e)(t)}catch(e){return n(e)}n(null,a)}(o,t,e)},r.Template=y,r.clearCache=function(){r.cache.reset()},y.modes={EVAL:"eval",ESCAPED:"escaped",RAW:"raw",COMMENT:"comment",LITERAL:"literal"},y.prototype={createRegex:function(){var e="(<%%|%%>|<%=|<%-|<%_|<%#|<%|%>|-%>|_%>)",t=i.escapeRegExpChars(this.opts.delimiter),r=i.escapeRegExpChars(this.opts.openDelimiter),n=i.escapeRegExpChars(this.opts.closeDelimiter);return e=e.replace(/%/g,t).replace(/</g,r).replace(/>/g,n),new RegExp(e)},compile:function(){var e,t,r,n=this.opts,s="",o="",l=n.escapeFunction,c=n.filename?JSON.stringify(n.filename):"undefined";if(!this.source){if(this.generateSource(),s+='  var __output = "";\n  function __append(s) { if (s !== undefined && s !== null) __output += s }\n',n.outputFunctionName&&(s+="  var "+n.outputFunctionName+" = __append;\n"),n.destructuredLocals&&n.destructuredLocals.length){for(var f="  var __locals = ("+n.localsName+" || {}),\n",d=0;d<n.destructuredLocals.length;d++){var m=n.destructuredLocals[d];d>0&&(f+=",\n  "),f+=m+" = __locals."+m}s+=f+";\n"}!1!==n._with&&(s+="  with ("+n.localsName+" || {}) {\n",o+="  }\n"),o+="  return __output;\n",this.source=s+this.source+o}e=n.compileDebug?"var __line = 1\n  , __lines = "+JSON.stringify(this.templateText)+"\n  , __filename = "+c+";\ntry {\n"+this.source+"} catch (e) {\n  rethrow(e, __lines, __filename, __line, escapeFn);\n}\n":this.source,n.client&&(e="escapeFn = escapeFn || "+l.toString()+";\n"+e,n.compileDebug&&(e="rethrow = rethrow || "+g.toString()+";\n"+e)),n.strict&&(e='"use strict";\n'+e),n.debug&&console.log(e),n.compileDebug&&n.filename&&(e=e+"\n//# sourceURL="+c+"\n");try{if(n.async)try{r=new Function("return (async function(){}).constructor;")()}catch(e){throw e instanceof SyntaxError?new Error("This environment does not support async/await"):e}else r=Function;t=new r(n.localsName+", escapeFn, include, rethrow",e)}catch(e){throw e instanceof SyntaxError&&(n.filename&&(e.message+=" in "+n.filename),e.message+=" while compiling ejs\n\n",e.message+="If the above error is not helpful, you may want to try EJS-Lint:\n",e.message+="https://github.com/RyanZim/EJS-Lint",n.async||(e.message+="\n",e.message+="Or, if you meant to create an async function, pass `async: true` as an option.")),e}var p=n.client?t:function(e){return t.apply(n.context,[e||{},l,function(t,r){var a=i.shallowCopy({},e);return r&&(a=i.shallowCopy(a,r)),h(t,n)(a)},g])};if(n.filename&&"function"==typeof Object.defineProperty){var u=n.filename,v=a.basename(u,a.extname(u));try{Object.defineProperty(p,"name",{value:v,writable:!1,enumerable:!1,configurable:!0})}catch(e){}}return p},generateSource:function(){this.opts.rmWhitespace&&(this.templateText=this.templateText.replace(/[\r\n]+/g,"\n").replace(/^\s+|\s+$/gm,"")),this.templateText=this.templateText.replace(/[ \t]*<%_/gm,"<%_").replace(/_%>[ \t]*/gm,"_%>");var e=this,t=this.parseTemplateText(),r=this.opts.delimiter,n=this.opts.openDelimiter,a=this.opts.closeDelimiter;t&&t.length&&t.forEach((function(i,s){var o;if(0===i.indexOf(n+r)&&0!==i.indexOf(n+r+r)&&(o=t[s+2])!=r+a&&o!="-"+r+a&&o!="_"+r+a)throw new Error('Could not find matching close tag for "'+i+'".');e.scanLine(i)}))},parseTemplateText:function(){for(var e,t=this.templateText,r=this.regex,n=r.exec(t),a=[];n;)0!==(e=n.index)&&(a.push(t.substring(0,e)),t=t.slice(e)),a.push(n[0]),t=t.slice(n[0].length),n=r.exec(t);return t&&a.push(t),a},_addOutput:function(e){if(this.truncate&&(e=e.replace(/^(?:\r\n|\r|\n)/,""),this.truncate=!1),!e)return e;e=(e=(e=(e=e.replace(/\\/g,"\\\\")).replace(/\n/g,"\\n")).replace(/\r/g,"\\r")).replace(/"/g,'\\"'),this.source+='    ; __append("'+e+'")\n'},scanLine:function(e){var t,r=this.opts.delimiter,n=this.opts.openDelimiter,a=this.opts.closeDelimiter;switch(t=e.split("\n").length-1,e){case n+r:case n+r+"_":this.mode=y.modes.EVAL;break;case n+r+"=":this.mode=y.modes.ESCAPED;break;case n+r+"-":this.mode=y.modes.RAW;break;case n+r+"#":this.mode=y.modes.COMMENT;break;case n+r+r:this.mode=y.modes.LITERAL,this.source+='    ; __append("'+e.replace(n+r+r,n+r)+'")\n';break;case r+r+a:this.mode=y.modes.LITERAL,this.source+='    ; __append("'+e.replace(r+r+a,r+a)+'")\n';break;case r+a:case"-"+r+a:case"_"+r+a:this.mode==y.modes.LITERAL&&this._addOutput(e),this.mode=null,this.truncate=0===e.indexOf("-")||0===e.indexOf("_");break;default:if(this.mode){switch(this.mode){case y.modes.EVAL:case y.modes.ESCAPED:case y.modes.RAW:e.lastIndexOf("//")>e.lastIndexOf("\n")&&(e+="\n")}switch(this.mode){case y.modes.EVAL:this.source+="    ; "+e+"\n";break;case y.modes.ESCAPED:this.source+="    ; __append(escapeFn("+v(e)+"))\n";break;case y.modes.RAW:this.source+="    ; __append("+v(e)+")\n";break;case y.modes.COMMENT:break;case y.modes.LITERAL:this._addOutput(e)}}else this._addOutput(e)}this.opts.compileDebug&&t&&(this.currentLine+=t,this.source+="    ; __line = "+this.currentLine+"\n")}},r.escapeXML=i.escapeXML,r.__express=r.renderFile,r.VERSION=o,r.name="ejs","undefined"!=typeof window&&(window.ejs=r)},{"../package.json":6,"./utils":2,fs:3,path:4}],2:[function(e,t,r){"use strict";var n=/[|\\{}()[\]^$+*?.]/g;r.escapeRegExpChars=function(e){return e?String(e).replace(n,"\\$&"):""};var a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},i=/[&<>'"]/g;function s(e){return a[e]||e}r.escapeXML=function(e){return null==e?"":String(e).replace(i,s)},r.escapeXML.toString=function(){return Function.prototype.toString.call(this)+';\nvar _ENCODE_HTML_RULES = {\n      "&": "&amp;"\n    , "<": "&lt;"\n    , ">": "&gt;"\n    , \'"\': "&#34;"\n    , "\'": "&#39;"\n    }\n  , _MATCH_HTML = /[&<>\'"]/g;\nfunction encode_char(c) {\n  return _ENCODE_HTML_RULES[c] || c;\n};\n'},r.shallowCopy=function(e,t){for(var r in t=t||{})e[r]=t[r];return e},r.shallowCopyFromList=function(e,t,r){for(var n=0;n<r.length;n++){var a=r[n];void 0!==t[a]&&(e[a]=t[a])}return e},r.cache={_data:{},set:function(e,t){this._data[e]=t},get:function(e){return this._data[e]},remove:function(e){delete this._data[e]},reset:function(){this._data={}}},r.hyphenToCamel=function(e){return e.replace(/-[a-z]/g,(function(e){return e[1].toUpperCase()}))}},{}],3:[function(e,t,r){},{}],4:[function(e,t,r){(function(e){function t(e,t){for(var r=0,n=e.length-1;n>=0;n--){var a=e[n];"."===a?e.splice(n,1):".."===a?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}function n(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}r.resolve=function(){for(var r="",a=!1,i=arguments.length-1;i>=-1&&!a;i--){var s=i>=0?arguments[i]:e.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(r=s+"/"+r,a="/"===s.charAt(0))}return(a?"/":"")+(r=t(n(r.split("/"),(function(e){return!!e})),!a).join("/"))||"."},r.normalize=function(e){var i=r.isAbsolute(e),s="/"===a(e,-1);return(e=t(n(e.split("/"),(function(e){return!!e})),!i).join("/"))||i||(e="."),e&&s&&(e+="/"),(i?"/":"")+e},r.isAbsolute=function(e){return"/"===e.charAt(0)},r.join=function(){var e=Array.prototype.slice.call(arguments,0);return r.normalize(n(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},r.relative=function(e,t){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=r.resolve(e).substr(1),t=r.resolve(t).substr(1);for(var a=n(e.split("/")),i=n(t.split("/")),s=Math.min(a.length,i.length),o=s,l=0;l<s;l++)if(a[l]!==i[l]){o=l;break}var c=[];for(l=o;l<a.length;l++)c.push("..");return(c=c.concat(i.slice(o))).join("/")},r.sep="/",r.delimiter=":",r.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),r=47===t,n=-1,a=!0,i=e.length-1;i>=1;--i)if(47===(t=e.charCodeAt(i))){if(!a){n=i;break}}else a=!1;return-1===n?r?"/":".":r&&1===n?"/":e.slice(0,n)},r.basename=function(e,t){var r=function(e){"string"!=typeof e&&(e+="");var t,r=0,n=-1,a=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!a){r=t+1;break}}else-1===n&&(a=!1,n=t+1);return-1===n?"":e.slice(r,n)}(e);return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},r.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,r=0,n=-1,a=!0,i=0,s=e.length-1;s>=0;--s){var o=e.charCodeAt(s);if(47!==o)-1===n&&(a=!1,n=s+1),46===o?-1===t?t=s:1!==i&&(i=1):-1!==t&&(i=-1);else if(!a){r=s+1;break}}return-1===t||-1===n||0===i||1===i&&t===n-1&&t===r+1?"":e.slice(t,n)};var a="b"==="ab".substr(-1)?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return t<0&&(t=e.length+t),e.substr(t,r)}}).call(this,e("_process"))},{_process:5}],5:[function(e,t,r){var n,a,i=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function l(e){if(n===setTimeout)return setTimeout(e,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(e){n=s}try{a="function"==typeof clearTimeout?clearTimeout:o}catch(e){a=o}}();var c,f=[],d=!1,m=-1;function p(){d&&c&&(d=!1,c.length?f=c.concat(f):m=-1,f.length&&u())}function u(){if(!d){var e=l(p);d=!0;for(var t=f.length;t;){for(c=f,f=[];++m<t;)c&&c[m].run();m=-1,t=f.length}c=null,d=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===o||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{return a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];f.push(new h(e,t)),1!==f.length||d||l(u)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],6:[function(e,t,r){t.exports={name:"ejs",description:"Embedded JavaScript templates",keywords:["template","engine","ejs"],version:"3.1.6",author:"Matthew Eernisse <mde@fleegix.org> (http://fleegix.org)",license:"Apache-2.0",bin:{ejs:"./bin/cli.js"},main:"./lib/ejs.js",jsdelivr:"ejs.min.js",unpkg:"ejs.min.js",repository:{type:"git",url:"git://github.com/mde/ejs.git"},bugs:"https://github.com/mde/ejs/issues",homepage:"https://github.com/mde/ejs",dependencies:{jake:"^10.6.1"},devDependencies:{browserify:"^16.5.1",eslint:"^6.8.0","git-directory-deploy":"^1.5.1",jsdoc:"^3.6.4","lru-cache":"^4.0.1",mocha:"^7.1.1","uglify-js":"^3.3.16"},engines:{node:">=0.10.0"},scripts:{test:"mocha"}}},{}]},{},[1])(1)})),FormFacade.prototype.getExpiry=function(e){if(e){var t=Math.floor(e/1e4),r=e-1e4*t,n=Math.floor(r/100);return new Date(t,n-1,r-100*n)}return null},FormFacade.prototype.isPaid=function(e,t){if(t&&t.paid){if(t.paid.expires){var r=this.getExpiry(t.paid.expires);if((new Date).getTime()>r.getTime())return!1}return!0}return!1},FormFacade.prototype.asSections=function(e){var t=[],r=(e=e||{}).items?e.items:{};for(var n in r){var a=r[n];a.id=n,t.push(a)}t.sort((function(e,t){return e.index-t.index}));var i={id:"root",items:[],headers:[],title:e.title,description:e.description,titleMark:e.titleMark,helpMark:e.helpMark},s=[i];return t.forEach((function(e){"PAGE_BREAK"==e.type?(s[s.length-1].next=e.navigateTo,i={title:e.title,id:e.id,headers:[],items:[],titleMark:e.titleMark,helpMark:e.helpMark},e.help&&(i.description=e.help),s.push(i)):(e.section=i,i.items.push(e))})),s.forEach(((e,t)=>{var r={items:[]};e.headers.push(r),e.items.forEach((function(t,n){if(t.deleted);else if("SECTION_HEADER"==t.type)r={head:t,items:[]},e.headers.push(r);else{if(t.choices){var a=t.choices.filter((e=>String(e.value||"").length<40));t.wrap=t.choices.length>=8&&t.choices.length==a.length}r.items.push(t)}}))})),s},FormFacade.prototype.validateEngine=function(e,t,r){var n=this,a=t.get("entry."+e.entry);if(!e.validType&&e.overwrite&&e.overwrite.validation&&e.overwrite.validation.validType&&Object.assign(e,e.overwrite.validation),"CHECKBOX"==e.type){var i=t.getAll("entry."+e.entry),s=!(f=t.get("entry."+e.entry+".other_option_response"))||!f.trim(),o=e.validOperator,l=e.validValue;0==isNaN(l)&&(l=parseInt(l));var c=e.validMessage;e.required&&0==i.length||e.required&&1==i.length&&"__other_option__"==i[0]&&s?r(n.lang("This is a required question")):"Atmost"==o&&i.length>l?(c||(c="Must select at most "+l+" options"),r(c)):"Atleast"==o&&i.length<l?(c||(c="Must select at least "+l+" options"),r(c)):"Exactly"==o&&i.length!=l&&(c||(c="Must select exactly "+l+" options"),r(c))}else if("MULTIPLE_CHOICE"==e.type){var f;s=!(f=t.get("entry."+e.entry+".other_option_response"))||!f.trim();e.required&&"__other_option__"==a&&s&&r(n.lang("This is a required question"))}else if("GRID"==e.type){if(e.required&&e.rows.forEach((function(e,a){0==t.getAll("entry."+e.entry).length&&(c="This question requires one response per row",1==e.multiple&&(c="This question requires at least one response per row"),c=n.lang(c),r(c))})),e.onepercol){var d={};e.rows.forEach((function(e,a){t.getAll("entry."+e.entry).forEach((function(t){d[t]&&(c="Please don't select more than one response per column",c=n.lang(c),r(c)),d[t]=e.entry}))}))}}else if(e.overwrite&&"FILE_UPLOAD"==e.overwrite.type){var m=t.get("entry."+e.entry);c=e.validMessage;e.required&&!m&&(c||(c=n.lang("This is a required question")),r(c))}else if(a&&("TEXT"==e.type||"PARAGRAPH_TEXT"==e.type)){var p=e.validType;o=e.validOperator,c=e.validMessage;if(e.validDynamic&&e.validEntryId){var u,h=t.get("entry."+e.validEntryId);if("Number"==p)0==isNaN(h)&&(u=parseFloat(h)),0==isNaN(a)&&(g=parseFloat(a)),isNaN(a)?b="Must be a number":!h||isNaN(h)?b="Comparison field must be a number":"GreaterThan"==o&&g>u==0?b="Must be a number greater than "+u:"GreaterEqual"==o&&g>=u==0?b="Must be a number greater than or equal to "+u:"LessThan"==o&&g<u==0?b="Must be a number less than "+u:"LessEqual"==o&&g<=u==0?b="Must be a number less than or equal to "+u:"EqualTo"==o&&g!=u?b="Must be a number equal to "+u:"NotEqualTo"==o&&g==u&&(b="Must be a number not equal to "+u),b&&r(c||b);else if("Text"==p){h=t.get("entry."+e.validEntryId);"EqualTo"==o&&a!=h?b="Must equal to "+e.validValue:"NotEqualTo"==o&&a==h&&(b="Must not equal to "+e.validValue),b&&r(c||b)}}else if("Number"==p){var g;e.validValue||(e.validValue=0),0==isNaN(a)&&(g=parseFloat(a));l=e.validValue;0==isNaN(l)&&(l=parseFloat(l)),isNaN(a)||"IsNumber"==o&&isNaN(a)?b="Must be a number":"WholeNumber"==o&&(isNaN(a)||a.indexOf(".")>=0)?b="Must be a whole number":"GreaterThan"==o&&g>l==0?b="Must be a number greater than "+l:"GreaterEqual"==o&&g>=l==0?b="Must be a number greater than or equal to "+l:"LessThan"==o&&g<l==0?b="Must be a number less than "+l:"LessEqual"==o&&g<=l==0?b="Must be a number less than or equal to "+l:"EqualTo"==o&&g!=l?b="Must be a number equal to "+l:"NotEqualTo"==o&&g==l?b="Must be a number not equal to "+l:"Between"==o&&e.validValue2&&(g<l||g>parseFloat(e.validValue2))?b="Must be a number between "+e.validValue+" and "+e.validValue2:"NotBetween"==o&&e.validValue2&&g>=l&&g<=parseFloat(e.validValue2)&&(b="Must be a number less than "+e.validValue+" or greater than "+e.validValue2),b&&r(c||b)}else if("Text"==p){"EqualTo"==o&&a!=e.validValue?b="Must equal to "+e.validValue:"NotEqualTo"==o&&a==e.validValue?b="Must not equal to "+e.validValue:"Contains"==o&&e.validValue&&a.indexOf(e.validValue)>=0==0?b="Must contain "+e.validValue:"NotContains"==o&&e.validValue&&a.indexOf(e.validValue)>=0?b="Must not contain "+e.validValue:"Email"==o&&0==/[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,63}$/.test(a)?b="Must be an email":"URL"==o&&0==/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)/.test(a)&&(b="Must be a URL"),b&&r(c||b)}else if(e.validValue&&"Regex"==p){a||(a="");var v=new RegExp(e.validValue,"g");if("Contains"==o&&0==v.test(a))b="Must contain "+e.validValue;else if("NotContains"==o&&v.test(a))b="Must not contain "+e.validValue;else if("Matches"==o){(y=a.match(v))&&1==y.length&&y[0]==a||(b="Must match "+e.validValue)}else if("NotMatches"==o&&a.match(v)){var y;(y=a.match(v))&&1==y.length&&y[0]==a&&(b="Must not match "+e.validValue)}b&&r(c||b)}else if("Length"==p){var b;e.validValue||(e.validValue=0),"MaxChar"==o&&a.length>parseInt(e.validValue)?b="Must be fewer than "+e.validValue+" characters":"MinChar"==o&&a.length<parseInt(e.validValue)&&(b="Must be at least "+e.validValue+" characters"),b&&r(c||b)}}},FormFacade.prototype.calculateEngine=function(tmpl,opts={}){var curr=this,citm=opts.calcfield,config=this.config||{},request=this.data.request||{},scraped=this.data.scraped||{},items=scraped.items||{},draft=this.draft||{},entr=draft.entry||{},fac=this.data.facade||{},fcitms=fac.items||{},setting=fac.setting||{},defcurrency=setting.currency||"$",params={ALL:"__all__",VISIBLE:"__all__",FULL:"__full__",SECTION:"__section__",CATEGORY:"__category__",SYMBOL:defcurrency},asNumber=function(e,t){var r=new Number(isNaN(t)?0:parseFloat(t));return r.getMetadata=function(){return e},r},asString=function(e,t){var r=new String(t||"");return r.getMetadata=function(){return e},r.valueOf=function(){var r=citm?citm.format:null;return(e.format||r)&&0==isNaN(t)?Number(t):t},r},asArray=function(e,t){var r=t||[];return r.getMetadata=function(){return e},r},toDate=function(e){var t=function(e){return e<10?"0"+e:e};return citm&&(e.getMetadata=function(){return citm}),e.valueOf=function(){return this.getTime()},e.toString=function(){return(e=this).getMetadata&&1==e.getMetadata().time?e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())+"T"+t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds()):e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate());var e},e.format=function(){return params.formatDate(this)},e.add=function(e,t){var r=this.getTime();return t&&"days"!=t?"months"==t?toDate(new Date(this.getFullYear(),this.getMonth()+e,this.getDate(),this.getHours(),this.getMinutes(),this.getSeconds())):"years"==t?toDate(new Date(this.getFullYear()+e,this.getMonth(),this.getDate(),this.getHours(),this.getMinutes(),this.getSeconds())):"hours"==t?toDate(new Date(this.getFullYear(),this.getMonth(),this.getDate(),this.getHours()+e,this.getMinutes(),this.getSeconds())):"minutes"==t?toDate(new Date(this.getFullYear(),this.getMonth(),this.getDate(),this.getHours(),this.getMinutes()+e,this.getSeconds())):"seconds"==t?toDate(new Date(this.getFullYear(),this.getMonth(),this.getDate(),this.getHours(),this.getMinutes(),this.getSeconds()+e)):e:toDate(new Date(r+24*e*60*60*1e3))},e.subtract=function(e,t){var r=this.getTime();return t&&"days"!=t?"months"==t?toDate(new Date(this.getFullYear(),this.getMonth()-e,this.getDate(),this.getHours(),this.getMinutes(),this.getSeconds())):"years"==t?toDate(new Date(this.getFullYear()-e,this.getMonth(),this.getDate(),this.getHours(),this.getMinutes(),this.getSeconds())):"hours"==t?toDate(new Date(this.getFullYear(),this.getMonth(),this.getDate(),this.getHours()-e,this.getMinutes(),this.getSeconds())):"minutes"==t?toDate(new Date(this.getFullYear(),this.getMonth(),this.getDate(),this.getHours(),this.getMinutes()-e,this.getSeconds())):"seconds"==t?toDate(new Date(this.getFullYear(),this.getMonth(),this.getDate(),this.getHours(),this.getMinutes(),this.getSeconds()-e)):e:toDate(new Date(r-24*e*60*60*1e3))},e.diff=function(t,r){return r&&"days"!=r?"months"==r?params.DATEDIF(t,e,"M"):"years"==r?params.DATEDIF(t,e,"Y"):"hours"==r?params.DATEDIF(t,e,"h"):"minutes"==r?params.DATEDIF(t,e,"m"):"seconds"==r?params.DATEDIF(t,e,"s"):void 0:params.DATEDIF(t,e,"D")},e.year=function(){return this.getFullYear()},e.month=function(){return this.getMonth()+1},e.date=function(){return this.getDate()},e.day=function(){return this.getDay()+1},e},asDate=function(e,t){if(t.add)return t;var r;if(t instanceof Date)r=toDate(t);else{var n=(r=new String(t||"")).split(/\D/),a=new Date;n.length>=3&&(n[1]=n[1]-1,a=new Date(...n)),r=toDate(a)}return r.getMetadata=function(){return e},r},encode=function(e){return e?"undefined"!=typeof window?window.btoa(e):Buffer.from(e).toString("base64"):""},secs=curr.getSections();secs.forEach((function(e,t){e.items.forEach((function(e,t){var r=entr[e.entry];if(e.entry)if("CHECKBOX"==e.type)r||(r=[]),r=(r=Array.isArray(r)?r:[r]).map((function(t){return"__other_option__"==t?entr[e.entry+"-other_option_response"]:t})),params["entry"+e.entry]=asArray(e,r);else if("MULTIPLE_CHOICE"==e.type)"__other_option__"==r&&(r=entr[e.entry+"-other_option_response"]),params["entry"+e.entry]=asString(e,r||"");else if("GRID"==e.type){var n=[];(e.rows?e.rows:[]).forEach((function(e,t){var r=entr[e.entry];r=e.multiple?r?Array.isArray(r)?r:[r]:[]:r||null,n.push(r)})),params["entry"+e.entry]=asArray(e,n)}else"Number"==e.validType||"SCALE"==e.type?(r||(r=0),params["entry"+e.entry]=asNumber(e,r)):"DATE"==e.type?(r||(r=new Date(0)),params["entry"+e.entry]=asDate(e,r)):params["entry"+e.entry]=asString(e,r||"")}))}));var mapping=fac.mapping||{};for(var attr in mapping){var iid=mapping[attr],itm=items[iid]||{},varname=attr.split("-").join("");"score"==attr&&(varname="totalscore"),params[varname]=params["entry"+itm.entry]||""}params.setContext=function(e){curr=e,items=e.data.scraped?e.data.scraped.items:{},fac=e.data.facade?e.data.facade:{},fcitms=fac&&fac.items?fac.items:{},defcurrency=fac.setting&&fac.setting.currency?fac.setting.currency:"$",entr=e.draft&&e.draft.entry?e.draft.entry:{}},params.grid=params.GRID=function(e,t,r){var n=e;return t&&(n=e[t-1],r&&(n=n[r-1])),n},params.num=params.NUM=function(e){return e&&0==isNaN(e)?Number(e):0},params.sum=params.SUM=function(){var e=0;return Array.prototype.slice.call(arguments).map((t=>{e+=params.NUM(t)})),e},params.round=params.ROUND=function(e,t=2){e+=Number.EPSILON;var r=10**t;return Math.round(e*r)/r},params.rounddown=params.ROUNDDOWN=e=>Math.floor(e),params.roundup=params.ROUNDUP=e=>Math.ceil(e),params.remainder=params.REMAINDER=(e,t)=>Math.round(e%t*1e6)/1e6,params.max=params.MAX=function(){var e=Array.prototype.slice.call(arguments);return e.sort(((e,t)=>t-e)),e[0]},params.min=params.MIN=function(){var e=Array.prototype.slice.call(arguments);return e.sort(((e,t)=>e-t)),e[0]},params.title=params.TITLE=function(e,t={}){if(e&&e.getMetadata){var{title:r}=e.getMetadata()||{};return r||""}return""},params.pretty=params.PRETTY=function(){return Array.prototype.slice.call(arguments).filter((function(e){return e})).join("<br>")},params.ifs=params.IFS=function(){var e,t=Array.prototype.slice.call(arguments);t.length%2==1&&(e=t.pop());for(var r=0;r<t.length;r+=2)if(t[r])return t[r+1];return 0==e?e:e||""},params.price=params.PRICE=function(e,t){return t||(t=defcurrency),e?0==(e=Array.isArray(e)?e:[e]).length?0:e.map((function(e){if(!e||!e.split)return 0;var r=e.split(t);if(r.length>1){var n=r[r.length-1];if(n=n.trim(),isNaN(n.charAt(0))){var a=(n=r[r.length-2]).charAt(n.length-1);if(isNaN(a))n=r.join("");else{var i=n.trim().split(/[^0-9.,]/g);n=i[i.length-1]}}if((n=(n="â‚¬"==t||"Rp"==t?n.split(",").map((e=>e.split(".").join(""))).join("."):"R"==t?n.split(",").join(".").split(" ").join(""):n.split(",").join("")).trim().split(/[^0-9.]/g)[0])&&0==isNaN(n))return Number(n);if(n=(n=r[0]).trim().split(" ").pop(),(n="â‚¬"==t||"Rp"==t?n.split(",").map((e=>e.split(".").join(""))).join("."):n.split(",").join(""))&&0==isNaN(n))return Number(n)}return 0})).reduce((function(e,t){return e+t})):0},params.quantityin=params.QUANTITYIN=e=>params.QUANTITY(null,e),params.quantity=params.QUANTITY=function(e,t){e||(e=defcurrency);var r=0;return params.getBill(e).forEach((e=>{var[n,a,i,s,o,l,c]=e;"Modifier"==(fcitms[s]||{}).configurable||(t?t==c&&(r+=Number(i||0)):r+=Number(i||0))})),r},params.total=params.TOTAL=params.amount=params.AMOUNT=params.amt=params.AMT=function(e){e||(e=defcurrency);var t=0;return params.getBill(e).forEach((e=>{var[r,n,a,i,s,o,l]=e,c=Number(o)||Number(n||0)*Number(a||0)||0;t+=c})),citm&&(citm.format=function(e){return params.FORMAT(e,setting.currency)}),t=Math.round(100*(t+Number.EPSILON))/100},params.totalin=params.TOTALIN=function(e){var t=0;setting.currency&&(params.getBill().forEach((r=>{var[n,a,i,s,o,l,c]=r,f=Number(l)||Number(a||0)*Number(i||0)||0;(e&&e==c||citm&&citm.section&&citm.section.title==c)&&(t+=f)})),citm&&(citm.format=function(e){return params.FORMAT(e,setting.currency)}),t=Math.round(100*(t+Number.EPSILON))/100);return t},params.html=params.HTML=e=>e?e.split("\n").join("<br>"):"",params.format=params.FORMAT=function(e,t){if(t||(t=defcurrency),e&&e instanceof Date){var r=toDate(e);return params.formatDate(r)}if(0==isNaN(e)){var n=Number(e),a="";n<0&&(a="-",n*=-1);var i={minimumFractionDigits:2,maximumFractionDigits:2};n-Math.floor(n)==0&&n>=1e3&&(i={}),"💰"==t&&(i={});var s=Number(n).toLocaleString("en",i);return"â‚¬"==t.trim()||"Rp"==t.trim()?(s=s.split(".").map((e=>e.split(",").join("."))).join(","),"â‚¬"==t.trim()?a+s+t:a+t+s):"R"==t.trim()?a+t+(s=s.split(",").join(" ").split(".").join(",")):"kn"==t.trim()||"💰"==t.trim()?a+s+" "+t.trim():"CHF"==t.trim()?a+t+" "+s:a+t+s}return e},params.currency=params.CURRENCY=function(e,t){return e||(e=defcurrency),citm?(citm.format=function(t){return params.format(t,e)},t):params.format(t,e)};var findText=function(e,t="$"){if(e){e=Array.isArray(e)?e:[e];var r=0;return e.map((function(e){1==isNaN(e)&&e.indexOf&&e.indexOf(t)>=0&&(r+=1)})),r>0}return!1},filterItems=function(e="$",t=!0){var r=[];return secs.forEach((function(n,a){n.items.forEach((function(a,i){var s=params["entry"+a.entry],o=!1;if(citm&&citm.id==a.id)o=!1;else if(1==t||t==params.VISIBLE||t==params.FULL)o=!0;else if(t==params.SECTION)citm&&citm.section&&citm.section.id==n.id&&(o=!0);else if(t.getMetadata){var l=t.getMetadata();l&&l.id==a.id&&(o=!0)}var c=!1;if(o){var f=!1;if(a.logic)if("hide"==a.logic.mode)f=t!=params.FULL&&!a.logic.modifierfor;else if(a.logic.calculated){var d=a.logic.calculated.split("(")[0];"${textsummary"==(d=d.toLowerCase().trim())&&(f=!0)}if(1==f)c=!1;else if(1==e)c=!0;else{var m=findText(a.help,e);if(m>0)c=!0;else if((m=findText(s,e))>0)c=!0;else if("GRID"==a.type&&a.rows){a.rows.filter((function(t){return findText(t.value,e)>0})).length==a.rows.length&&(c=!0)}}}c&&r.push(a)}))})),r};params.textsummary=params.TEXTSUMMARY=function(e,t=!0,r=""){e||(e="$");var n=filterItems(e,t),a=[];if(entr.emailAddress){var i=r+"Email:"+r+" "+entr.emailAddress;a.push(i)}return n.forEach((function(e,t){var n=fcitms[e.id]||{},i=params["entry"+e.entry],s=i;if(s&&0==s&&(s=null),s&&0==s.length&&(s=null),"DATE"==e.type&&"1970-01-01"==s&&(s=null),"DATE"==e.type&&"1970-01-01T01:00:00"==s&&(s=null),n.encrypt&&s&&(s="******"),citm&&citm.id==e.id);else if("GRID"==e.type&&s){(s?s.filter((function(e){return e&&e.length>0})):[]).length>0&&(e.title&&a.push(e.title),e.rows.forEach((function(e,t){var n=s[t];if(n&&0==n.length&&(n=null),n){n=Array.isArray(n)?n:[n];var i=r+e.value+":"+r+" "+n.join(", ");a.push(i)}})))}else if("PARAGRAPH_TEXT"==e.type&&"Configurable"==n.measure&&s){e.title&&a.push(r+e.title+r),(s.split("\n-----\n")||[]).forEach(((e,t)=>{e.split("\n").forEach((e=>{var t=e.trim().split(" | "),i=t.pop(),[s,o]=i.trim().split(" * "),l=t.join(" | ");n.modifierfor&&(l="â†³ "+l),s&&o&&a.push(r+l+":"+r+" "+o)}))}))}else if(e.product||"LIST"!=e.type||"0"!=i){if(s&&s instanceof Date){l=r+e.title+":"+r+" "+params.formatDate(s);a.push(l)}else if(s){l=r+e.title+":"+r+" ";if("Weight"==n.measure){var o="USD"==setting.currencyCode?"lbs":"kg";l=r+e.title+" ("+o+"):"+r+" "}e.format?l+=e.format(s):l+=Array.isArray(s)?s.join(", "):s,a.push(l)}}else{var l=r+e.title+":"+r+" "+i;a.push(l)}})),a.join("\r\n")},params.getSummaryRows=function(e,t=!0){e||(e="$");var r=filterItems(e,t),n=[];if(entr.emailAddress){var a="<tr><td>Email:</td><td>"+entr.emailAddress+"</td></tr>";n.push(a)}return r.forEach((function(e,t){var r=fcitms[e.id]||{},a=params["entry"+e.entry];if(a&&0==a.length&&(a=null),a&&0==a&&(a=null),"DATE"==e.type&&"1970-01-01"==a&&(a=null),"DATE"==e.type&&"1970-01-01T01:00:00"==a&&(a=null),r.encrypt&&a&&(a="******"),"GRID"==e.type&&a)(a?a.filter((function(e){return e&&e.length>0})):[]).length>0&&(e.title&&n.push('<tr><td colspan="2">'+e.title+"</td></tr>"),e.rows.forEach((function(e,t){var r=a[t];r&&0==r.length&&(r=null),r&&(r=Array.isArray(r)?r:[r],n.push("<tr><td>"+e.value+":</td><td>"+r.join(", ")+"</td></tr>"))})));else if("PARAGRAPH_TEXT"==e.type&&a)if("Configurable"==r.measure){n.push('<tr><td colspan="2">'+e.title+"</td></tr>"),(a.split("\n-----\n")||[]).forEach((e=>{e.split("\n").forEach((e=>{var t=e.trim().split(" | "),a=t.pop(),[i,s]=a.trim().split(" * "),o=t.join(" | ");r.modifierfor&&(o="â†³ "+o),i&&s&&n.push("<tr><td>"+o+":</td><td>"+s+"</td></tr>")}))}))}else{var i="<tr><td>"+e.title+":</td>";i+="<td>"+a.split("\n").join("<br>")+"</td></tr>",n.push(i)}else if(a&&a instanceof Date){i="<tr><td>"+e.title+":</td>";i+="<td>"+params.formatDate(a)+"</td></tr>",n.push(i)}else if(a&&"SIGNATURE"==r.subtype);else if(a){i="<tr><td>"+e.title+":</td> ";if("Weight"==r.measure){var s="USD"==setting.currencyCode?"lbs":"kg";i="<tr><td>"+e.title+" ("+s+"):</td> "}e.format?i+="<td>"+e.format(a)+"</td></tr>":i+="<td>"+(Array.isArray(a)?a.join(", "):a)+"</td></tr>",n.push(i)}})),n},params.summary=params.SUMMARY=function(e,t=!0){var r='<table class="ff-summary ff-email"><colgroup><col class="ff-col-name"/><col class="ff-col-value"/></colgroup>'+params.getSummaryRows(e,t).join("\n")+"</table>";return curr.isEditMode&&curr.isEditMode()&&(r+='<p class="pt-1 pb-1"><a class="card-link" href="javascript:void(0)" onclick="editFacade.showMapping()">Configure</a></p>'),r},params.healthsummary=params.HEALTHSUMMARY=function(){var e=params.getSummaryRows(!0,!0);["customer-id","score","diagnosis"].forEach((t=>{var r=(fac.mapping||{})[t],n=items[r]||{},a=fcitms[r]||{},i=params["entry"+n.entry]||"";i&&"hide"==a.mode&&e.push("<tr><td>"+n.title+":</td> <td>"+(Array.isArray(i)?i.join(", "):i)+"</td></tr>")}));var t='<table class="ff-summary ff-email">'+e.join("\n")+"</table>";return t+='<colgroup><col class="ff-col-name"/><col class="ff-col-value"/></colgroup>',curr.isEditMode&&curr.isEditMode()&&(t+='<p class="pt-1 pb-1"><a class="card-link" href="javascript:void(0)" onclick="editFacade.showMapping()">Configure</a></p>'),t},params.computeCondition=function(secid){var itmsubmits=fac.submit||{},itmsubmit=itmsubmits[secid]||{},cond=itmsubmit.ifmsg;if(cond&&cond.source){var srcitm=items[cond.source];if(!srcitm)return;var srcval=entr[srcitm.entry];srcval=srcval?isNaN(srcval)?0:Number(srcval):0;for(var ifs=cond.ifs?cond.ifs:[],i=0;i<ifs.length;i++){var ifitm=ifs[i],estr=srcval;ifitm.val||(ifitm.val=0),ifitm.altval||(ifitm.altval=0),"><"==ifitm.op?estr+=" >= "+ifitm.val+" && "+srcval+" <= "+ifitm.altval:estr+=" "+ifitm.op+" "+ifitm.val;var rslt=eval(estr);if(rslt){var ifrslt=curr.computeField(ifitm.re);return ifrslt}}if(cond.els){var elsrslt=curr.computeField(cond.els.re);return elsrslt}}},params.scoresummary=params.SCORESUMMARY=function(e){var t=fac.submit||{},r=Object.entries(t).filter((t=>{var[r,n]=t;return e&&r==e||"ifmsg"==n.submitto&&n.ifmsg})).map((e=>e[0]));return r.length>0&&params.computeCondition(r.at(-1))||"(No message)"},params.formatDate=function(e){var t=setting.locale||setting.language,r=e.getMetadata?e.getMetadata():null;return r&&1==r.time&&e.toLocaleString?t?e.toLocaleString(t):e.toLocaleString():e.toLocaleDateString?t?e.toLocaleDateString(t):e.toLocaleDateString():e},params.getBillFooter=function(){var e=fac.mapping||{};return["amount","service","taxes","delivery-fee","tip","donation","discount","net-amount"].map((t=>{var r=e[t],n=items[r];if(n){n.mapped=t,n.format=e=>params.format(e,defcurrency);var a=params["entry"+n.entry];return"discount"==t?asNumber(n,-1*a):a}})).filter((e=>0!=e&&e))},params.bill=params.BILL=function(){var e=defcurrency,t=[].slice.call(arguments);return t.length>0?e=t.shift():t=params.getBillFooter(),params.toBill(e,t)},params.orders=params.ORDERS=function(){var e=defcurrency,t=params.getBillFooter();return params.toBill(e,t)},params.toBill=function(e,t){var r=params.getBill(e),n=curr.lang("- Your cart is empty -");if(r.length>0){var a="<tr><td>"+[curr.lang("Item"),curr.lang("Unit price"),curr.lang("Qty"),curr.lang("Amount")].join("</td><td>")+"</td></tr>",i=0;n='<table class="ff-bill ff-email"><colgroup><col/><col/><col/><col/></colgroup><thead>'+a+"</thead><tbody>"+r.map((function(t,r){var[n,a,s,o,l,c,f]=t,d=[n=n.split("\n").join("<br/>"),a,s],m=a*s;return i+=m,c&&c<m?d.push(params.format(c,e)+"<s>"+params.format(m,e)+"</s>"):c&&c>m?d.push(params.format(c,e)):d.push(params.format(m,e)),d[1]=params.format(a,e),"<tr><td>"+d.join("</td><td>")+"</td></tr>"})).join("\n")+"</tbody><tfoot>"+t.map((function(e,t){var r="";if(e.getMetadata&&e.getMetadata()){var n=e.getMetadata();if(n.title&&(r=n.title),"amount"==n.mapped&&i>e){var a=i-e;a=n.format?n.format(a):a,r+='<br/><span class="ff-bill-saved">('+curr.lang("You saved $amount",{amount:a})+")</span>"}e=n.format?n.format(e):e}return'<tr><td colspan="3">'+r+"</td><td>"+e+"</td></tr>"})).join("\n")+"</tfoot></table>";n=params.inlineCSS(n)}return curr.isEditMode&&curr.isEditMode()&&(n+='<p class="pt-1 pb-1"><a class="card-link" href="javascript:void(0)" onclick="editFacade.showMapping()">Configure</a></p>'),n},params.textbill=params.TEXTBILL=function(){var e=defcurrency,t=[].slice.call(arguments);t.length>0?e=t.shift():t=params.getBillFooter();var r=params.getBill(e);if(0==r.length)return"";var n=r.map((function(t){var[r,n,a,i,s,o,l]=t,c=o||n*a;return c=params.format(c,e),r+": "+(n=params.format(n,e))+" * "+a+" = "+c})),a=t.map((function(e){var t="";if(e.getMetadata){var r=e.getMetadata();r&&r.title&&(t=r.title+": "),e=r&&r.format?r.format(e):e}return t+e}));return n.join("\n")+"\n"+a.join("\n")},params.getBill=function(e){if(curr.cachedBill)return curr.cachedBill;e||(e=defcurrency);var t=new Array;return curr.getSections().forEach((function(r,n){r.items.forEach((function(n,a){var i=fcitms[n.id]||{},s=params.price(n.help,e),o=i.fullprice||s;if(o=isNaN(o)?0:Number(o),n.id==mapping.service){var l=entr[n.entry],c=l&&0==isNaN(l)?Number(l):0;c&&t.push([n.title||"",c,1,n.id,n.entry,c,r.title])}else if("LIST"==n.type||"TEXT"==n.type&&"product"==i.widget||"MULTIPLE_CHOICE"==n.type||"SCALE"==n.type)if(i.choices&&i.discounted){var f=entr[n.entry];i.choices.forEach(((e,a)=>{if(e==f){var l=i.discounted[a];l||(l=s*e),t.push([n.title||"",o,e,n.id,n.entry,l,r.title])}}))}else if(s>0||"product"==i.widget){(p=(m=entr[n.entry])?0==isNaN(m)?Number(m):1:0)&&t.push([p>0||"1"==m.toString()?n.title||"":n.title+" | "+m,o,p,n.id,n.entry,s*p,r.title])}else{var d=entr[n.entry];s=params.price(d,e),o=o||s,s>0&&t.push([n.title+" | "+d,o,1,n.id,n.entry,s,r.title])}else if("TEXT"==n.type){var m,p=(m=entr[n.entry])&&0==isNaN(m)?Number(m):0;s&&p&&t.push([n.title||"",o,p,n.id,n.entry,s*p,r.title])}else if("PARAGRAPH_TEXT"==n.type){var u=entr[n.entry];if("Configurable"==i.measure&&u)(u?u.split("\n-----\n"):[]).forEach(((e,a)=>{e.split("\n").forEach((e=>{var a=n.title;i.modifierfor&&(a="â†³ "+a);var s=i.price,o=e.trim().split(" | ").pop(),[l,c]=o.trim().split(" * "),f=i.variants?i.variants[l]:null;f&&f.name&&(a=a+" | "+f.name),f&&f.price&&(s=f.price),t.push([a,s,c,n.id,n.entry,0,r.title,l])}))}))}else if("CHECKBOX"==n.type)if(s>0){var h=entr[n.entry];(h=Array.isArray(h)?h:[h]).forEach((function(e){var a=e?0==isNaN(e)?Number(e):1:0;s&&a&&t.push([a>1||"1"==e.toString()?n.title:n.title+" | "+e,o,a,n.id,n.entry,0,r.title])}))}else{var g=entr[n.entry];(g=Array.isArray(g)?g:[g]).forEach((function(a){var i=params.price(a,e);i>0&&t.push([n.title+" | "+a,i,1,n.id,n.entry,0,r.title])}))}else if("GRID"==n.type){(n.rows?n.rows:[]).forEach((function(a,i){var o={},l=entr[a.entry];(l=Array.isArray(l)?l:[l]).forEach((function(e){o[e]=e})),n.choices.forEach((function(i,l){if(i&&i.value&&o[i.value]){var c=[];n.title&&c.push(n.title),isNaN(a.value)&&c.push(a.value),isNaN(i.value)&&c.push(i.value);var f=c.join(" | ");if(s>0){var d=i.value?0==isNaN(i.value)?Number(i.value):1:0;s&&d&&t.push([f,s,d,n.id,n.entry,0,r.title])}else{var m=params.price(a.value,e);if(m>0){d=i.value?0==isNaN(i.value)?Number(i.value):1:0;m&&d&&t.push([f,m,d,n.id,n.entry,0,r.title])}}}}))}))}}))})),t.toString=function(){return JSON.stringify(t)},curr.cachedBill=t,t},params.billto=params.BILLTO=function(){var e=fac.mapping||{},t=["name","address","delivery-zone","email","phone"].map((t=>{var r=e[t];if(r){var n=items[r];if(n)return params["entry"+n.entry]}})).filter((e=>e&&e.toString())).map((e=>e.trim().split("\n").join("<br/>"))).join("<br/>");return curr.isEditMode&&curr.isEditMode()&&(t+='<p class="pt-1 pb-1">\n                        <a class="card-link" href="javascript:void(0)" \n                            onclick="editFacade.showMapping(\'pills-Customer-tab\')">\n                            Configure\n                        </a>\n                    </p>'),t},params.menu=params.MENU=function(e,t=!0){e||(e=defcurrency);var r="";return curr.getSections().forEach((function(n,a){var i=[];n.items.forEach((function(t,r){var a=fcitms[t.id]||{},s=params.price(t.help,e);if("product"==a.widget||s){var o='<div class="ff-menu-prd">'+t.title+"</div>",l='<div class="ff-menu-prc">'+params.format(s,e)+"</div>",c='<div class="ff-menu" onclick="formFacade.directtoSection(\''+n.id+"', '"+t.id+"')\">"+o+l+"</div>";i.push(c)}})),i.length>0&&(r+='<div class="ff-menu-sec">\n',t&&(r+='<div class="ff-menu-ttl" onclick="formFacade.directtoSection(\''+n.id+"')\">"+n.title+"</div>\n"),r+=i.join("\n")+"</div>")})),r},params.categories=params.CATEGORIES=function(){var e=[],t=fac&&fac.next?fac.next:{},r=curr.data.request.params.publishId;if(curr.getSections().forEach((function(n,a){var i=n.items.filter((e=>{if(!curr.getPrice)return!1;var t=curr.getPrice(e,defcurrency),r=!0,n=fcitms[e.id]||{};return"hide"==n.mode&&(r=!1),"yes"==n.inventory&&n.remain<=0&&(r=!1),(t.min>0||t.max>0)&&r})),s=t[n.id];if(s&&"added"==s.navigation&&i.length>0){var o="https://neartail.com/img/collections.svg",l=n.items.filter((e=>"IMAGE"==e.type&&(e.image||e.blob))),c=n.items.filter((e=>e.titleImage&&(e.titleImage.image||e.titleImage.blob))),f=n.items.map((e=>fcitms[e.id])).filter((e=>e&&e.prdimage));l.length>0?o=l[0].image?"https://formfacade.com/itemload/item/"+encode(l[0].image):"https://formfacade.com/itemembed/"+r+"/item/"+l[0].id+"/image/"+l[0].blob:f.length>0?o=f[0].prdimage:c.length>0&&(o=c[0].image?"https://formfacade.com/itemload/item/"+encode(c[0].image):"https://formfacade.com/itemimg/"+r+"/item/"+c[0].id+"/title/"+c[0].titleImage.blob);var d=curr.isEditMode&&curr.isEditMode()?"formFacade.scrollIntoView(document.getElementById('ff-sec-"+n.id+"'))":"formFacade.directtoSection('"+n.id+"')";window.isFormBuilder&&(d="");var m='<li class="ff-image-list__item" onclick="'+d+'">';o&&(m=m+'<img class="ff-image-list__image" src="'+o.replace("neartail.com/","formfacade.com/")+'">'),m=m+'<div class="ff-image-list__supporting"><span class="ff-image-list__label">'+n.title+"</span></div></li>",e.push(m)}})),curr.isEditMode&&curr.isEditMode()){var n='<li class="ff-image-list__item" onclick="editFacade.showNavigation(); formFacade.closeNavigation();">';n+='<img class="ff-image-list__image" src="/img/edit_pencil.svg" title="Show or hide product categories in navigation">',n+='<div class="ff-image-list__supporting"><span class="ff-image-list__label">&nbsp;</span></div></li>',e.push(n)}return'<ul class="ff-image-list nt-image-list ff-image-list__supporting">'+e.join("\n")+"</ul>"},params.inlineCSS=e=>curr.juice?curr.juice(`\n        <style>\n            .ff-email{ min-width:400px; max-width:100%; table-layout:fixed; border-collapse:collapse; border:1px solid #eee; }\n            .ff-email tr{ height:36px; }\n            .ff-email tr:nth-child(odd){ background-color:#f5f5f5; }\n            .ff-email td{ padding:6px; }\n            .ff-summary col{ width:50%; }\n            .ff-bill col{ width:25%; }\n            .ff-bill thead tr{ font-weight:600; background-color:#111; color:#fff; }\n        </style>\n        ${e}\n    `):e,params.response=params.RESPONSE=function(e){var t=fac.hipaache?params.healthsummary():params.SUMMARY(!0,e||!0);return t=params.inlineCSS(t)},params.getFields=function(e){var t=[];if((e=Array.prototype.slice.call(e)).length>1){var[r,n]=e;r==params.CATEGORY&&n?curr.getSections().forEach((function(e,r){e.items.forEach((function(e,r){(fcitms[e.id]||{}).tag==n&&(t=t.concat(e))}))})):t=e.filter((e=>e.getMetadata)).map((e=>e.getMetadata()))}else{var r;if((r=e[0])||(r=params.ALL),r.getMetadata)t=[r.getMetadata()];else{var a=curr.getSections(),i=citm&&citm.section?citm.section.id:null;a.forEach((function(e,n){(r==params.SECTION&&i==e.id||r==params.ALL)&&(t=t.concat(e.items))}))}}return t.filter((e=>"GRID"==e.type||e.entry))},params.getScorable=function(e){return params.getFields(e).filter((e=>{var t=fcitms[e.id];return t&&t.score}))},params.viewscore=params.VIEWSCORE=function(){return ejs.render(curr.template.viewscore,curr)},params.points=params.POINTS=function(){var e=0;return params.getScorable(arguments).forEach((function(t,r){var n=fcitms[t.id]||{};if("GRID"==t.type)(t.rows?t.rows:[]).forEach((function(r,a){var i={},s=entr[r.entry];(s=Array.isArray(s)?s:[s]).forEach((function(e){i[e]=e})),t.choices.forEach((function(t,r){if(t&&i[t.value]){var a=n.score[r];a&&(e+=a)}}))}));else if(t.choices){var a=0,i={},s=entr[t.entry];(s=Array.isArray(s)?s:[s]).forEach((function(e){i[e]=e})),t.choices.forEach((function(e,t){if(e&&i[e.value]){var r=n.score[t];r&&(a+=r)}})),n.maxscore>0?e+=a>n.maxscore?Number(n.maxscore):a:e+=a}})),e},params.answered=params.ANSWERED=function(){var e=0;return params.getScorable(arguments).forEach((function(t){var r=(fcitms[t.id]||{}).score||[],n=entr[t.entry];if("GRID"==t.type)e+=t.rows.filter((e=>{var n=entr[e.entry],a=Array.isArray(n)?n:[n];return t.choices.filter((function(e,t){if(a.indexOf(e.value)>=0)return r[t]>0||r[t]<0||0==r[t]})).length>0})).length;else if(t.choices&&n){var a=Array.isArray(n)?n:[n];t.choices.filter((function(e,t){if(a.indexOf(e.value)>=0)return r[t]>0||r[t]<0||0==r[t]})).length>0&&(e+=1)}})),e},params.averagepoints=params.AVERAGEPOINTS=function(){var e=params.POINTS.apply(params,arguments),t=params.ANSWERED.apply(params,arguments);return 0==e||0==t?0:Math.round(100*(e/t+Number.EPSILON))/100},params.score=params.SCORE=function(){var e,t=Array.prototype.slice.call(arguments),r=t.shift();r||(r=!0),e=r.getMetadata?[r.getMetadata()]:1==r||r==params.ALL||r==params.SECTION?filterItems(!0,r):filterItems(r,params.ALL);var n=0;return e.forEach((function(e,a){if("MULTIPLE_CHOICE"==e.type||"CHECKBOX"==e.type||r.getMetadata&&"LIST"==e.type){var i={},s=entr[e.entry];(s=Array.isArray(s)?s:[s]).forEach((function(e){i[e]=e})),e.choices.forEach((function(e,r){if(e&&i[e.value]){var a=t[r];a&&(n+=a)}}))}else if("GRID"==e.type){(e.rows?e.rows:[]).forEach((function(r,a){var i={},s=entr[r.entry];(s=Array.isArray(s)?s:[s]).forEach((function(e){i[e]=e})),e.choices.forEach((function(e,r){if(e&&i[e.value]){var a=t[r];a&&(n+=a)}}))}))}})),n},params.diff=params.DIFF=function(e=0){if(e.getMetadata){var t=isNaN(e)?0:Number(e),{entry:r}=e.getMetadata()||{},n=((draft.history||{}).entry||{})[r]||0;return t-(isNaN(n)?0:Number(n))}},params.mostly=params.MOSTLY=function(){var e,t=Array.prototype.slice.call(arguments),r=t[0];r||(r=!0),e=r.getMetadata?[r.getMetadata()]:1==r||r==params.ALL||r==params.SECTION?filterItems(!0,r):filterItems(r,params.ALL);var n={};e.forEach((function(e,t){if("MULTIPLE_CHOICE"==e.type||"CHECKBOX"==e.type){var r={},a=entr[e.entry];(a=Array.isArray(a)?a:[a]).forEach((function(e){r[e]=e})),e.choices.forEach((function(e,t){if(e&&r[e.value]){var a=n[t];n[t]=a?a+1:1}}))}else if("GRID"==e.type){(e.rows?e.rows:[]).forEach((function(t,r){var a={},i=entr[t.entry];(i=Array.isArray(i)?i:[i]).forEach((function(e){a[e]=e})),e.choices.forEach((function(e,t){if(e&&a[e.value]){var r=n[t];n[t]=r?r+1:1}}))}))}}));var a=[];for(var i in n)a.push({index:i,value:n[i]});a.sort(((e,t)=>t.value-e.value));var s=t[1]?t[1]:1;return a.length>=s?parseInt(a[s-1].index)+1:0},params.weight=params.WEIGHT=function(){var e=0;return params.getBill(defcurrency).forEach((function(t){var[r,n,a,i,s,o,l,c]=t,f=fcitms[i]||{};if(f.shipped)if(f.variants){var d=f.variants[c]||{},m=Number(d.ship||0)*a;e+=m}else if(f.ship){m=Number(f.ship)*a;e+=m}})),e},params.tax=params.TAX=function(){var e=0;return params.getBill(defcurrency).forEach((function(t){var[r,n,a,i,s,o,l]=t,c=fcitms[i]||{},f=Number(c.tax||0);e+=(o||n*a)*(f/100)})),e},params.fee=params.FEE=function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return citm&&(citm.format=function(e){return params.format(e,t)}),params.score.apply(params,e)},params.charge=params.CHARGE=function(){var e=Array.prototype.slice.call(arguments);return e.unshift(defcurrency),params.fee.apply(params,e)},params.nettotal=params.NETTOTAL=function(){var e=params.total(defcurrency),t=fac.mapping?fac.mapping:{};return["service","taxes","delivery-fee","tip","donation","discount"].forEach((r=>{var n=t[r];if(n){var a=items[n];if(a){var i=params["entry"+a.entry];if(i)e+="discount"==r?-1*i:i}}})),e},params.products=params.PRODUCTS=function(){var e=[];if(setting.currency){e=params.getBill().map((e=>{var[t,r,n,a,i,s,o]=e;return{title:t,price:r,quantity:n,id:a,entry:i,amount:s,section:o}}));var t=e=>e.amount||Number(e.price||0)*Number(e.quantity||0);e.sort(((e,r)=>t(r)-t(e)))}return e},params.topproduct=params.TOPPRODUCT=function(){var e=params.products();return 0==e.length?"":e[0].title},params.gridscore=params.GRIDSCORE=function(){var e=Array.prototype.slice.call(arguments),t=e.shift(),r=e.shift();r=Array.isArray(r)?r:[r];var n=0;if(t&&t.getMetadata){var a=t.getMetadata();if(a&&"GRID"==a.type)(a.rows?a.rows:[]).forEach((function(t,i){if(r.indexOf(i+1)>=0){var s={},o=entr[t.entry];(o=Array.isArray(o)?o:[o]).forEach((function(e){s[e]=e})),a.choices.forEach((function(t,r){if(t&&s[t.value]){var a=e[r];a&&(n+=a)}}))}}))}return n},params.date=params.DATE=function(e,t,r){return toDate(new Date(e,t-1,r))},params.datevalue=params.DATEVALUE=function(e){if(e instanceof Date)return toDate(e);var t=new String(e||""),r=Date.parse(t);return 0==isNaN(r)?toDate(new Date(r)):void 0},params.today=params.TODAY=function(){var e=new Date;return params.date(e.getFullYear(),e.getMonth()+1,e.getDate())},params.now=params.NOW=function(){var e=new Date;return toDate(e)},params.datedif=params.DATEDIF=function(e,t,r){var n=new Date(e.getTime());n.setHours(0),n.setMinutes(0,0,0);var a=new Date(t.getTime());if(a.setHours(0),a.setMinutes(0,0,0),"Y"==r){var i=a.getFullYear()-n.getFullYear();return(a.getMonth()<n.getMonth()||a.getMonth()==n.getMonth()&&a.getDate()<n.getDate())&&(i-=1),i}if("M"==r){var s=12*a.getFullYear()+a.getMonth()-(12*n.getFullYear()+n.getMonth());return a.getDate()<n.getDate()&&(s-=1),s}return"D"==r?Math.round((a.getTime()-n.getTime())/864e5):"h"==r?Math.round((t.getTime()-e.getTime())/36e5):"m"==r?Math.round((t.getTime()-e.getTime())/6e4):"s"==r?Math.round((t.getTime()-e.getTime())/1e3):void 0},params.WEEKDAY=params.weekday=function(e,t=1){return toDate(e).day()-(t-1)},params.duplicate=params.DUPLICATE=function(e=""){var t=[],r=entr||{};for(var n in r)if(0==isNaN(n)){var a=r[n];(a=Array.isArray(a)?a:[a]).forEach((function(e){"__other_option__"==e&&(e=entr[n+"-other_option_response"]),e&&t.push("entry."+n+"="+encodeURIComponent(e))}))}return e+"?"+t.join("&")},params.editurl=params.EDITURL=function(){var{userId:e,publishId:t}=request.params||{},{savedId:r,owner:n}=draft,{currency:a}=setting,{shortId:i}=config;if(r){var s=`https://${a?"neartail.com":"formfacade.com"}/public/${e||n}/home/form/${t}?restoreId=${r}`;return i&&(s=`https://${a?"neartail.com":"formfacade.com"}/rs/${i}/${r}`),s}},params.prefilllink=params.PREFILLLINK=function(){var{userId:e,publishId:t}=request.params||{},{savedId:r,owner:n,name:a}=draft,{currency:i}=setting,{shortId:s}=config;if(r&&a){var o=`https://${i?"neartail.com":"formfacade.com"}/public/${e||n}/home/form/${t}?prefillId=${a}`;if(s)o=`${fac&&fac.hipaache?"formesign.com":i?"neartail.com":"formfacade.com"}/sm/${s}/${a}`;return o}},params.edit=params.EDIT=function(e){var t=params.editurl();if(t){var r=setting.currency?"Edit Order":"Edit Response";return`\n                <a class="card-link" href='${t}'>\n                    ${e||r}\n                </a>\n            `}return""},params.row=params.ROW=function(){var e=Array.prototype.slice.call(arguments),t=Math.round(100/e.length),r='<table class="ff-html-row" cellspacing="0" style="width:100%; border-spacing:0; border-collapse:collapse;"><tr>';return e.forEach((function(n,a){var i=0==a?"left":a+1==e.length?"right":"center";1==e.length&&(i="center");var s=Array.isArray(n)?n:[n];r+='<td style="width:'+t+"%; text-align:"+i+';">'+s.join("<br/>")+"</td>"})),r+="</tr></table>"},params.chart=params.CHART=function(){var{userId:e,publishId:t}=request.params||{},{savedId:r,owner:n}=draft,a=Array.prototype.slice.call(arguments),i=`https://formfacade.com/chart/${t}/v1/${r}?type=${a.shift()}`;return a.forEach(((e,t)=>{if(e&&e.getMetadata){var{title:r}=e.getMetadata()||{},n=isNaN(e)?0:Number(e);i+="&"+encodeURIComponent(r)+"="+n}else{n=e?isNaN(e)?0:Number(e):0;i+="&"+encodeURIComponent(`Untitled ${t+1}`)+"="+n}})),`<img src="${i}">`},params.tag=params.TAG=function(e,t){var r=(t="string"==typeof t||t instanceof String?{content:t}:t).content;return delete t.content,"<"+e+" "+Object.keys(t).map((function(e){return e+'="'+t[e]+'"'})).join(" ")+">"+(r||"")+"</"+e+">"},Array("img","h1","h2","h3","h4","h5","h6","p","b","em","i","small","a","hr","s").forEach((function(e){params[e]=params[e.toUpperCase()]=function(t){return params.tag(e,t)}})),Array("ol","ul").forEach((function(e){params[e]=params[e.toUpperCase()]=function(){var t=Array.prototype.slice.call(arguments).map((function(e){return"<li>"+e+"</li>"})).join("\n");return params.tag(e,t)}})),params.hyperlink=params.HYPERLINK=function(e,t){return'<a href="'+e+'" target="_blank">'+t+"</a>"},params.cta=params.CTA=function(e,t,r){return`<p class="ctabutton">\n            <button type="button" class="btn btn-lg btn-primary ff-next" onclick='${r?`window.open(${JSON.stringify(e)})`:`location.href="${e}"`}'>\n                ${t||"Proceed"}\n            </button>\n        </p>`},params.jsa=params.JSA=function(e,t){return Object.entries(params).forEach((t=>{var[r,n]=t;r.startsWith("entry")&&e.indexOf(r)>=0?e=e.split(r).join(JSON.stringify(n)):e.indexOf(r+"()")>=0&&(e=e.split(r+"()").join(JSON.stringify(n())))})),`<p class="ctabutton">\n            <button type="button" class="btn btn-lg btn-primary ff-next" onclick='eval(${JSON.stringify(e)})'>\n                ${t||"Proceed"}\n            </button>\n        </p>`},params.field=params.FIELD=function(e){var t=(fac.mapping||{})[e],r=items[t]||{};return params["entry"+r.entry]},params.getAmount=function(e){if(e||(e=params.field("net-amount")),e||(e=params.field("amount")),e&&0==isNaN(e))return params.round(Number(e))},params.getTitle=e=>scraped.title,params.getBrand=e=>config.title||scraped.title,params.getTxNumber=e=>params.orderId()||"000000",params.getTxNote=e=>"Order"+params.getTxNumber(),params.renderWallet=function(e,t,r){return`<div id="walletpane-${e}" class="walletpane" data-wallet="${e}" data-to="${t}" data-amount="${params.getAmount(r)}">\n                  <h3>Loading...</h3>\n                </div>`},params.upi=params.UPI=(e,t)=>params.renderWallet("upi",e,t),params.venmo=params.VENMO=(e,t)=>params.renderWallet("venmo",e,t),params.cashapp=params.CASHAPP=(e,t)=>params.renderWallet("cashapp",e,t),params.paypal=params.PAYPAL=(e,t)=>params.renderWallet("paypal",e,t),params.paynow=params.PAYNOW=(e,t)=>params.renderWallet("paynow",e,t),params.code=params.CODE=function(e){return params[e].toString()},params.sequence=params.SEQUENCE=function(e){if(curr.draft){var t="submitted"==e?curr.draft.submitSeq:curr.draft.draftSeq;if(t&&0==isNaN(t))return parseInt(t)}return 0},params.orderId=params.ORDERID=e=>params.sequence("submitted"),params.center=params.CENTER=e=>`<div class="ff-cta-center">${e}</div>`,params.forum=e=>{var t=(entr[488229902]||"all").toLowerCase(),r=(entr[1380645483]||"untitled").trim().toLowerCase();return r.length>50&&(r=r.slice(0,50)),`//near.tl/support/forum/${t}/${(r=r.replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,""))||"untitled"}.${draft.savedId}.html?nocache=${(new Date).getTime()}`},params.showlocation=params.SHOWLOCATION=function(){var e=citm||{};return"PARAGRAPH_TEXT"==e.type||"TEXT"==e.type?`\n                <a class="card-link" href="javascript:void(0)"\n                    onclick="formFacade.getLocation(document.getElementById('Widget${e.id}'))">\n                    Show current location\n                </a>\n            `:"Works only with Text field"},params.addtocalendar=params.ADDTOCALENDAR=function(e,t,r,n,a){var i=toDate(e||new Date),s=t?toDate(t):i.add(1,"hours");r||(r=params.getTitle()),formatOffset=e=>{var t=e<0?"-":"",r=Math.abs(e),n=Math.floor(r/60),a=Math.floor(r-3600*n/60);return n<10&&(n="0"+n),a<10&&(a="0"+a),t+n+":"+a};var o={google:{action:"TEMPLATE",text:r,details:n,location:a,dates:i.toISOString().replace(/[^\w\s]/gi,"")+"/"+s.toISOString().replace(/[^\w\s]/gi,"")},outlook:{rru:"addevent",subject:r,body:n,location:a,startdt:i.toISOString().split(".")[0]+formatOffset(i.getTimezoneOffset()),enddt:s.toISOString().split(".")[0]+formatOffset(s.getTimezoneOffset())},ics:{BEGIN:"VCALENDAR",CALSCALE:"GREGORIAN",METHOD:"PUBLISH",PRODID:"-//Neartail-Formfacade//Forms",VERSION:"2.0","BEGIN ":"VEVENT",UID:"Formfacade-"+draft.savedId,"DTSTAMP;VALUE=DATE":(new Date).toISOString().split(".")[0].replace(/[^\w\s]/gi,""),"DTSTART;VALUE=DATE":i.toISOString().split(".")[0].replace(/[^\w\s]/gi,""),"DTEND;VALUE=DATE":s.toISOString().split(".")[0].replace(/[^\w\s]/gi,""),SUMMARY:r,DESCRIPTION:n,LOCATION:a,END:"VEVENT","END ":"VCALENDAR"}},l=Object.fromEntries(Object.entries(o).map((e=>{var[t,r]=e,n="&";return"ics"==t&&(n=-1!==navigator.appVersion.indexOf("Win")?"\r\n":"\n"),caljoin=Object.entries(r).map((e=>{var[r,n]=e;if(n)return"ics"==t?r.trim()+":"+n:r+"="+encodeURIComponent(n)})).filter((e=>e)).join(n),[t,caljoin]})));return`<p class="ff-cta-calendar">\n                    <button type="button" class="btn btn-lg btn-primary ff-next"\n                        onclick='window.open(window.URL.createObjectURL(new Blob([${JSON.stringify(l.ics)}], {type:"text/calendar"})));'>\n                        Add to your calendar\n                    </button>\n                </p>\n                <p>\n                    <a class="card-link" target="_blank"\n                        href="https://calendar.google.com/calendar/render?${l.google}">\n                        Google\n                    </a>\n                    <a class="card-link" target="_blank"\n                        href="https://outlook.office.com/calendar/0/deeplink/compose?${l.outlook}">\n                        Outlook\n                    </a>\n                    <a class="card-link" target="_blank"\n                        href="https://outlook.office.com/calendar/0/deeplink/compose?${l.outlook}">\n                        Office 365\n                    </a>\n                </p>`},params.signature=params.SIGNATURE=function(e,t){if(e&&/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)/.test(e)){(new Date).getTime();return'<img src="'+e+'" style="'+t+'"></img>'}return""},params.def=e=>params;const names=Object.keys(params),vals=Object.values(params);if(opts.returntype)try{tmpl.startsWith("${")&&tmpl.endsWith("}")&&(tmpl=tmpl.substring(2,tmpl.length-1));var calcrs=new Function(...names,"return "+tmpl)(...vals);return calcrs}catch(e){return console.trace(e,"Computation failed for "+tmpl),e}else try{var retmpl=tmpl.replace(new RegExp("`","g"),"\\`"),calcrs=new Function(...names,`return \`${retmpl}\`;`)(...vals);return calcrs}catch(e){return console.trace(e,"Computation failed for "+tmpl),"Computation failed for "+tmpl+" due to "+e}},window.formFacade=new FormFacade({request:{params:{publishId:"1FAIpQLSd1ADWEf0M5RYxQqZFYZcTiGBA4H0b7TmxGfA7k_MmIjIbFzw",target:"wordpress",userId:"100066911282161708792"},query:{}}}),formFacade.template={style:"<% \r\n  const pSBC=(p,c0,c1,l)=>{\r\n    let r,g,b,P,f,t,h,m=Math.round,a=typeof(c1)==\"string\";\r\n    if(typeof(p)!=\"number\"||p<-1||p>1||typeof(c0)!=\"string\"||(c0[0]!='r'&&c0[0]!='#')||(c1&&!a))return null;\r\n    h=c0.length>9,h=a?c1.length>9?true:c1==\"c\"?!h:false:h,f=pSBC.pSBCr(c0),P=p<0,t=c1&&c1!=\"c\"?pSBC.pSBCr(c1):P?{r:0,g:0,b:0,a:-1}:{r:255,g:255,b:255,a:-1},p=P?p*-1:p,P=1-p;\r\n    if(!f||!t)return null;\r\n    if(l)r=m(P*f.r+p*t.r),g=m(P*f.g+p*t.g),b=m(P*f.b+p*t.b);\r\n    else r=m((P*f.r**2+p*t.r**2)**0.5),g=m((P*f.g**2+p*t.g**2)**0.5),b=m((P*f.b**2+p*t.b**2)**0.5);\r\n    a=f.a,t=t.a,f=a>=0||t>=0,a=f?a<0?t:t<0?a:a*P+t*p:0;\r\n    if(h)return\"rgb\"+(f?\"a(\":\"(\")+r+\",\"+g+\",\"+b+(f?\",\"+m(a*1000)/1000:\"\")+\")\";\r\n    else return\"#\"+(4294967296+r*16777216+g*65536+b*256+(f?m(a*255):0)).toString(16).slice(1,f?undefined:-2)\r\n  }\r\n\r\n  pSBC.pSBCr=(d)=>{\r\n    const i=parseInt;\r\n    let n=d.length,x={};\r\n    if(n>9){\r\n      const [r, g, b, a] = (d = d.split(','));\r\n            n = d.length;\r\n      if(n<3||n>4)return null;\r\n      x.r=i(r[3]==\"a\"?r.slice(5):r.slice(4)),x.g=i(g),x.b=i(b),x.a=a?parseFloat(a):-1\r\n    }else{\r\n      if(n==8||n==6||n<4)return null;\r\n      if(n<6)d=\"#\"+d[1]+d[1]+d[2]+d[2]+d[3]+d[3]+(n>4?d[4]+d[4]:\"\");\r\n      d=i(d.slice(1),16);\r\n      if(n==9||n==5)x.r=d>>24&255,x.g=d>>16&255,x.b=d>>8&255,x.a=Math.round((d&255)/0.255)/1000;\r\n      else x.r=d>>16,x.g=d>>8&255,x.b=d&255,x.a=-1\r\n    }return x\r\n  };\r\n  const lighten = (p,c0,c1,l)=>pSBC(p,c0,c1,l);\r\n\r\n  function hexToRGBA(hex, alpha) {\r\n    // Remove the # symbol if it exists\r\n    hex = hex.replace(/^#/, '');\r\n\r\n    // Parse the hex values for red, green, and blue\r\n    const r = parseInt(hex.substring(0, 2), 16);\r\n    const g = parseInt(hex.substring(2, 4), 16);\r\n    const b = parseInt(hex.substring(4, 6), 16);\r\n\r\n    // Ensure that alpha is within the 0 to 1 range\r\n    alpha = Math.min(1, Math.max(0, alpha));\r\n\r\n    // Create and return the RGBA string\r\n    return `rgba(${r}, ${g}, ${b}, ${alpha})`;\r\n  }\r\n\r\n%>\r\n<%\r\n  var {userId, publishId, target} = data.request.params||{};\r\n  var {form, scraped, facade} = data||{};\r\n  var fac = facade||{};\r\n  var isTailwindStyleIsActive = !(target=='bootstrap' || target =='gsuite' || target =='clean');\r\n  var themecolor = config.themecolor;\r\n  if(!themecolor)\r\n  {\r\n    if(fac.neartail || fac.whatsapp)\r\n      themecolor = 'minimal-77cde3';\r\n    else\r\n      themecolor = 'colorful-5d33fb';\r\n  }\r\n  var [themed, thmcolor] = themecolor.split('-');\r\n  var primary = '#'+thmcolor;\r\n  var secondary = '#ffffff';\r\n  if(fac.setting && fac.setting.primary)\r\n    primary = fac.setting.primary;\r\n  else if(config && config.theme)\r\n    primary = config[config.theme+'pri'];\r\n  if(fac.setting && fac.setting.secondary)\r\n    secondary = fac.setting.secondary;\r\n  else if(config && config.theme)\r\n    secondary = config[config.theme+'sec'];\r\n  else if (config.themeSecondary) {\r\n    secondary = config.themeSecondary;\r\n  }\r\n  var headfont;\r\n  if(config.theme)\r\n    headfont = config[config.theme+'head'];\r\n  else if(themed=='colorful')\r\n    headfont = 'Poppins';\r\n  else if(themed=='minimal')\r\n    headfont = 'Work Sans';\r\n  var parafont;\r\n  if(config.theme)\r\n    parafont = config[config.theme+'para'];\r\n  else if(themed=='colorful')\r\n    parafont = 'Roboto';\r\n  else if(themed=='minimal')\r\n    parafont = 'Work Sans';\r\n  var fontSize = 14;\r\n  if(config.theme)\r\n  {\r\n    var strsize = config[config.theme+'size'];\r\n    if(isNaN(strsize)==false) fontSize = parseInt(strsize);\r\n  }\r\n  if(fac.enhance)\r\n  {\r\n    var strsize = fac.enhance.fontSize;\r\n    if(strsize && isNaN(strsize)==false) fontSize = parseInt(strsize);\r\n  }\r\n  var formBgColor = '#ffffff';\r\n  var enhanceBg = null;\r\n  var themeBg = null;\r\n  var pageBgColor = null;\r\n\r\n  var isMinimalTheme = config && config.theme !== 'colorful';\r\n\r\n  if(isMinimalTheme) {\r\n    pageBgColor = secondary || '#f5f5f5';\r\n  } else {\r\n    pageBgColor = '#ffffff';\r\n  }\r\n\r\n  var isTransparent = false;\r\n\r\n  if(fac.enhance && fac.enhance.transparent === 'on')\r\n  {\r\n    isTransparent = true;\r\n  }\r\n  else if (config && config.formtransparent === 'on')\r\n  {\r\n    isTransparent = true;\r\n  }\r\n\r\n  if(fac.enhance && fac.enhance.background)\r\n  {\r\n    formBgColor = fac.enhance.background;\r\n    enhanceBg = fac.enhance.background;\r\n    if (config && config.formbgcolor) {\r\n      themeBg = config.formbgcolor;\r\n    }\r\n  }\r\n  else if (config && config.formbgcolor)\r\n  {\r\n    formBgColor = config.formbgcolor;\r\n    themeBg = config.formbgcolor;\r\n  }\r\n\r\n  \x3c!-- NEW FORM --\x3e\r\n  if(!enhanceBg && isMinimalTheme && isTransparent) {\r\n    formBgColor = secondary;\r\n  }\r\n\r\n  var isDarkTheme = isColorDark(\r\n    formBgColor\r\n  );\r\n\r\n  var isPageDarkTheme = isMinimalTheme ?  isColorDark(\r\n    pageBgColor\r\n  ) : isDarkTheme;\r\n  \r\n  var ifFlipTextColor = isDarkTheme;\r\n  var fontColor = ifFlipTextColor ? '#fafafa' : '#202124';\r\n  var field = isTailwindStyleIsActive ? 'transparent' : '#fff';\r\n  var fieldBorder = ifFlipTextColor ? '#808080' : 'rgb(0 0 0 / 15%)';\r\n  if(isDarkTheme) {\r\n    // lighten based on secondary if minimal theme else based on formBgColor.\r\n    field = 'rgb(255 255 255 / 8%)';\r\n    fieldBorder = 'rgb(255 255 255 / 7%)';\r\n  }\r\n  var borderColor = ifFlipTextColor ? 'rgb(255 255 255 / 25%)' : 'rgb(0 0 0 / 15%)';\r\n  var enhanceFontColor = null;\r\n  if(fac.enhance)\r\n  {\r\n    if(fac.enhance.fontColor){\r\n      fontColor = fac.enhance.fontColor;\r\n      enhanceFontColor = fac.enhance.fontColor;\r\n    }\r\n    if(fac.enhance.field && field != fac.enhance.field){\r\n      field = fac.enhance.field;\r\n    }\r\n  }\r\n\r\n  function isColorDark(hexColor) {\r\n    if(!hexColor) {\r\n      hexColor = '#ffffff';\r\n    }\r\n    // Convert the hex color to RGB\r\n    const r = parseInt(hexColor.slice(1, 3), 16);\r\n    const g = parseInt(hexColor.slice(3, 5), 16);\r\n    const b = parseInt(hexColor.slice(5, 7), 16);\r\n\r\n    // Calculate the relative luminance to determine darkness\r\n    const luminance = (0.299 * r + 0.587 * g + 0.114 * b) / 255;\r\n\r\n    // You can adjust this threshold to fit your definition of dark/light\r\n    return luminance < 0.5;\r\n  }\r\n\r\n  function toHSL(hexa = '#ffffff') {\r\n    var r = parseInt(hexa.slice(1, 3), 16) / 255,\r\n      g = parseInt(hexa.slice(3, 5), 16) / 255,\r\n      b = parseInt(hexa.slice(5, 7), 16) / 255;\r\n\r\n    var max = Math.max(r, g, b),\r\n      min = Math.min(r, g, b);\r\n    var h,\r\n      s,\r\n      l = (max + min) / 2;\r\n\r\n    if (max === min) {\r\n      h = s = 0;\r\n    } else {\r\n      var d = max - min;\r\n      s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\r\n\r\n      switch (max) {\r\n        case r:\r\n          h = ((g - b) / d + (g < b ? 6 : 0)) / 6;\r\n          break;\r\n        case g:\r\n          h = ((b - r) / d + 2) / 6;\r\n          break;\r\n        case b:\r\n          h = ((r - g) / d + 4) / 6;\r\n          break;\r\n      }\r\n    }\r\n    h = Math.round(h * 360);\r\n    s = Math.round(s * 100);\r\n    l = Math.round(l * 100);\r\n    return [h, s, l];\r\n} \r\n\r\n%>\r\n<% if(headfont){ %>\r\n  <link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/css?family=<%=headfont%>:300,400,500,600,700,800\">\r\n<% } %>\r\n<% if(parafont !== headfont){ %>\r\n  <link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/css?family=<%=parafont%>:300,400,500,600,700,800\">\r\n<% } %>\r\n<link href=\"https://fonts.googleapis.com/icon?family=Material+Icons\" rel=\"stylesheet\" media=\"screen\">\r\n<% \r\n  if(!fac) {\r\n    fac = {};\r\n  }\r\n  const rtlLangs = {\r\n    'ar': 'Arabic',\r\n    'he': 'Hebrew',\r\n    'fa': 'Persian',\r\n    'ur': 'Urdu',\r\n  }\r\n  var rtlLangText = fac.langtext || {};\r\n  var rtlLang = rtlLangText.language || '';\r\n  var facadeSetting = fac.setting || {};\r\n  var cl = facadeSetting.language || rtlLang || 'en';\r\n  var dir = cl in rtlLangs ? 'rtl' : 'ltr';\r\n%>\r\n<style>\r\n  <% if (dir === 'rtl') { %>\r\n  .ff-success {\r\n    direction: rtl;\r\n  }\r\n  #ff-cart-sidebar.active, #ff-search-sidebar.active {\r\n    right: unset;\r\n    left: 0;\r\n    direction: rtl;\r\n  }\r\n  <% } %>\r\n  <%\r\n    var enhance = fac.enhance || {};\r\n    if(!config) {\r\n      config = {};\r\n    }\r\n  %>\r\n\r\n  <% if(isTransparent) { %>\r\n    /* In case Editor, add background color. */\r\n    <% if(isEditMode()) { %>\r\n    .ff-form {\r\n      background: <%-formBgColor%> !important;\r\n    }\r\n    <% } %>\r\n  <% } %>\r\n  /* IF COLORFUL THEME (since the pageBgColor = formBgColor) */\r\n  <% if (!isMinimalTheme) { %>\r\n    #ff-formpage-body {\r\n      background-color: <%-formBgColor%> !important;\r\n    }\r\n  <% } %>\r\n  <% if (isTransparent && isMinimalTheme) { %>\r\n    #pageform #ff-compose {\r\n      background: var(--ff-formbgcolor) !important\r\n    }\r\n    /* if transparency enabled then reduce the margin-top for the minimal theme. */\r\n    @media (min-width: 651px) {\r\n      .page-wrapper #pageform #ff-compose {\r\n        margin-top: -50px !important;\r\n      }\r\n    }\r\n  <% } %>\r\n  /* If DarkTheme and IsMinimal and enhanceBg should not be available (Only for new form which does not have enhance bg.) */\r\n  <% if (isMinimalTheme && isPageDarkTheme && !enhanceBg) { %>\r\n    .page-wrapper header.navbar.navbar-sticky {\r\n      background-color: <%-pageBgColor%>;\r\n      color: #FFFFFF;\r\n      border-bottom: 1px solid rgb(255 255 255 / 15%) ;\r\n    }\r\n    .page-wrapper .cart-btn i, .page-wrapper .ff-cart-icon, a.site-logo.visible-mobile.ff-logo, a.site-logo.visible-desktop.ff-logo {\r\n      color: #FFFFFF;\r\n    }\r\n    .ff-image-list__image {\r\n      border: 0px;\r\n      background-color: <%-field%>\r\n    }\r\n    #ff-addprd-popup .ff-prdimg-thumbnail {\r\n      border: 0px;\r\n    }\r\n  <% } %>\r\n  <% var hslOfPrimary = toHSL(primary); %>\r\n  <%  if(isMinimalTheme && isPageDarkTheme) { %>\r\n    .page-wrapper .footer .column {\r\n      color: #fafafa !important;\r\n      border-top: 1px solid rgb(255 255 255 / 15%) !important;\r\n    }\r\n    .page-wrapper .footer * {\r\n      color: <%=`hsl(${hslOfPrimary[0]}, ${hslOfPrimary[1]}%, 96%)`%>;\r\n    }\r\n  <% } %>\r\n  <%\r\n    var popupBgColor = enhanceBg ? '#ffffff' : formBgColor;\r\n    var popupFontColor = enhanceBg ? '#202124' : fontColor;\r\n    var popupBorderColor = enhanceBg ? '#d2d2d2' : borderColor;\r\n\r\n    if(isMinimalTheme && !enhanceBg) {\r\n      popupBgColor = isPageDarkTheme ? pageBgColor : '#ffffff';\r\n      popupFontColor = isPageDarkTheme ? '#fafafa' : '#202124';\r\n      popupBorderColor = isPageDarkTheme ? 'rgb(255 255 255 / 25%)' : 'rgb(0 0 0 / 15%)';\r\n    }\r\n  %>\r\n  /* Hide scrollbar for ff-mode = preview */\r\n  <%\r\n  var urlparams = window.location&&window.location.search&&new URLSearchParams(window.location.search);\r\n  if(urlparams && urlparams.get('ff-mode')=='preview'){ \r\n  %>\r\n    ::-webkit-scrollbar {\r\n      display: none;\r\n    }\r\n  <% } %>\r\n  :root {\r\n    --ff-fs: <%=fontSize%>px;\r\n    <% \r\n      var fontDiff = (fontSize - 16) * 0.05;\r\n      var fontScale = 1 + fontDiff;\r\n    %>\r\n    --ff-scale:<%-fontScale%>;\r\n    <% if(target=='wordpress' && false){ %>\r\n    --ff-primary-color: var(--wp--preset--color--primary, <%-primary%>);\r\n    <% } else{ %>\r\n    --ff-primary-color: <%-primary%>;\r\n    <% } %>\r\n    <%\r\n      var shades = {\r\n        10:.8, 50:.6, 100:.5, 200:.4, 300:.3, 400:.2, 500:.1, \r\n        600:0, 700:-.1, 800:-.2, 900:-.3, 1000:-.4\r\n      };\r\n\t\t  for(var shade in shades) { \r\n\t\t\tvar key = `--ff-primary-${shade==1000?950:shade}`;\r\n      var color = lighten(shades[shade], primary);\r\n    %>\r\n    <%-key%>: <%-color%>;\r\n    <% } %>\r\n    --ff-primary-light: <%-toRGB(primary, 0.4)%>;\r\n    --ff-bgcolor:<%-formBgColor%>;\r\n    --popup-bgcolor:<%-popupBgColor%>;\r\n    --popup-fontcolor:<%-popupFontColor%>;\r\n    --popup-bordercolor:<%-popupBorderColor%>;\r\n    --ff-formbgcolor: <%-isTransparent ? 'transparent' : formBgColor%>;\r\n    --ff-font-color:<%-enhanceFontColor ? enhanceFontColor : '#202124'%>;\r\n    --ff-gray-900:<%-fontColor%>;\r\n    --ff-gray-400:<%-ifFlipTextColor ? '#808080' : 'rgb(0 0 0 / 15%)'%>;\r\n    <% \r\n      var minFontSizes = {'00':.8, 0:.9, 1:1, 2:1.1, 3:1.25, 4:1.5, 5:2, 6:2.5, 7:3, 8:3.5};\r\n      for(var s in minFontSizes){\r\n        var fontSize = Math.round(14*minFontSizes[s]*10)/10;\r\n    %>\r\n      --ff-font-size-<%-s%>:max(calc(var(--font-size-<%-s%>)*var(--ff-scale)), <%-fontSize%>px);\r\n    <% } %>\r\n    <% \r\n      var minSizes = {'000':-.5, '00':-.25, 1:.25, 2:.5, 3:1, 4:1.25, 5:1.5, \r\n        6:1.75, 7:2, 8:3, 9:4, 10:5, 11:7.5, 12:10, 13:15, 14:20, 15:30};\r\n      for(var s in minSizes){\r\n        var size = Math.round(14*minSizes[s]*10)/10;\r\n    %>\r\n      --ff-size-<%-s%>:max(calc(var(--size-<%-s%>)*var(--ff-scale)), <%-size%>px);\r\n    <% } %>\r\n    <%\r\n    if(formBgColor === 'transparent')\r\n    {\r\n      field = 'transparent';\r\n    }\r\n    var hslOfFormBgColor = toHSL(formBgColor);\r\n    var accentColor = primary;\r\n    var activeItemColor = `hsl(${hslOfPrimary[0]}, ${hslOfPrimary[1]}%, 80%)`;\r\n    var primaryBtnColor = lighten(-0.145, primary);\r\n    var hslOfPrimaryBtnColor = toHSL(primaryBtnColor);\r\n    if(hslOfPrimaryBtnColor[2] <= 10 || hslOfPrimaryBtnColor[2] >= 65) {\r\n      primaryBtnColor = `hsl(${hslOfPrimary[0]}, ${hslOfPrimary[1]}%, 20%)`;\r\n    }\r\n    if(hslOfPrimary[2] <= 20 || hslOfPrimary[2] > 55) {\r\n      activeItemColor = `hsl(${hslOfPrimary[0]}, 75%, 80%)`;\r\n    }\r\n    /* if transparent and primary color is same background and is minimal theme and config.theme exist. */\r\n    if(config && config.theme && isMinimalTheme && formBgColor === primary && isTransparent) {\r\n      primaryBtnColor = `hsl(${hslOfPrimary[0]}, ${hslOfPrimary[1]}%, 40%)`;\r\n    }\r\n\r\n    if(config && config.theme && !isMinimalTheme && formBgColor === primary) {\r\n      primaryBtnColor = `hsl(${hslOfPrimary[0]}, ${hslOfPrimary[1]}%, 40%)`;\r\n    }\r\n\r\n    var isPrimaryColorDark = isColorDark(primary);\r\n    if(!isDarkTheme) {\r\n      fieldBorder = borderColor = popupBorderColor = 'rgb(0 0 0 / 12%)';\r\n    } else if (isDarkTheme) {\r\n      fieldBorder = 'rgba(255, 255, 255, 0.15)';\r\n    }\r\n    if(!isDarkTheme && isPageDarkTheme && !enhanceBg) {\r\n      popupBorderColor = 'rgba(255, 255, 255, 0.15)';\r\n    }\r\n    if(!isPrimaryColorDark) {\r\n      accentColor = `hsl(${hslOfPrimary[0]}, ${hslOfPrimary[1]}%, 35%)`;\r\n    } else {\r\n      accentColor = `hsl(${hslOfPrimary[0]}, ${hslOfPrimary[1]}%, 30%)`;\r\n    }\r\n    if(field === 'transparent' && formBgColor !== '#FFFFFF' && formBgColor !== '#ffffff') {\r\n      field = `rgb(0 0 0 / 4%)`;\r\n    }\r\n    %>\r\n    /* Box shadow color for dark theme. */\r\n    <% if(isPageDarkTheme && config && config.theme) { %>\r\n    --ff-primary-300: <%-`hsl(${hslOfPrimary[0]}, ${hslOfPrimary[1]}%, 17.5%)`;%>; \r\n    <% } %>\r\n    --ff-font-size:var(--ff-font-size-1);\r\n    --ff-head-size:var(--ff-font-size-5);\r\n    --ff-font-small:var(--ff-font-size-0);\r\n    --ff-field-bgcolor:<%-field%>;\r\n    --ff-field-border: <%-fieldBorder%>;\r\n    --ff-heading-font:<%-headfont?JSON.stringify(headfont):'inherit'%>;\r\n    --ff-paragraph-font:<%-parafont?JSON.stringify(parafont):'inherit'%>;\r\n    --ff-gray-200: <%= borderColor %>;\r\n    --ff-placeholder: <%= ifFlipTextColor ? '#e6e6e6' : '#333333' %>;\r\n    --ff-primary-950: <%= accentColor %> !important;\r\n    --ff-primary-50: <%= activeItemColor %> !important;\r\n    --popup-bordercolor: <%= popupBorderColor %> !important;\r\n    --ff-primary-700: <%= primaryBtnColor %> !important;\r\n  }\r\n  <% if(config && config.theme && !isMinimalTheme && formBgColor === primary) { %> \r\n    #ff-formpage-body .footer {\r\n      background-image: linear-gradient(180deg, <%-`hsl(${hslOfPrimary[0]}, ${hslOfPrimary[1]}%, 10%)`%>, <%-`hsl(${hslOfPrimary[0]}, ${hslOfPrimary[1]}%, 15%)`%>) !important;\r\n      border-top: 1px solid rgb(255 255 255 / 5%);\r\n    }\r\n  <% } %>\r\n  <%  if(config && config.theme && !isMinimalTheme && isDarkTheme) { %>\r\n\t\t#ff-formpage-body .ff-footer-svg {\r\n\t\t\topacity: 0.055 !important;\r\n\t\t}\r\n\t<% } %>\r\n  <% if(!isMinimalTheme && !isPrimaryColorDark) { %>\r\n    #ff-formpage-body span.ff-cart-count.count {\r\n      color: <%-`hsl(${hslOfPrimary[0]}, ${hslOfPrimary[1]}%, 35%)`%>;\r\n      font-weight: 600 !important;\r\n    }\r\n    #ff-formpage-body h3.text-white.display-4 {\r\n      color: <%-`hsl(${hslOfPrimary[0]}, ${hslOfPrimary[1]}%, 8%)`%> !important;\r\n    }\r\n    #ff-formpage-body .btn-white-border {\r\n      color: <%-`hsl(${hslOfPrimary[0]}, ${hslOfPrimary[1]}%, 25%)`%> !important;\r\n      border-color: <%-`hsl(${hslOfPrimary[0]}, ${hslOfPrimary[1]}%, 25%)`%> !important;\r\n    }\r\n    #ff-formpage-body #navbar-expand .nav-item a {\r\n      color: <%-`hsl(${hslOfPrimary[0]}, ${hslOfPrimary[1]}%, 25%)`%> !important;\r\n    }\r\n    @media (min-width: 992px) {\r\n      #ff-formpage-body .navbar-brand  {\r\n        color: <%-`hsl(${hslOfPrimary[0]}, ${hslOfPrimary[1]}%, 25%)`%> !important;\r\n      }\r\n    }\r\n    #ff-formpage-body #navbar-scroll .nav-item a {\r\n      color: <%-`hsl(${hslOfPrimary[0]}, ${hslOfPrimary[1]}%, 25%)`%> !important;\r\n    }\r\n    #ff-formpage-body .sticky-active .navbar-brand  {\r\n      color: #ffffff !important;\r\n    }\r\n    #ff-formpage-body .sticky-active #navbar-scroll .nav-item a {\r\n      color: #ffffff !important;\r\n    }\r\n    #ff-formpage-body .footer span {\r\n      color: <%-`hsl(${hslOfPrimary[0]}, ${hslOfPrimary[1]}%, 10%)`%> !important;\r\n    }\r\n    #ff-formpage-body .mouse-down a {\r\n      color: <%-`hsl(${hslOfPrimary[0]}, ${hslOfPrimary[1]}%, 25%)`%> !important;\r\n    }\r\n  <% } %>\r\n  <% if (isTailwindStyleIsActive) { %>\r\n  .ff-form, .ff-form div, .ff-form p, #ff-addprd-popup {\r\n    font-size: var(--ff-fs);\r\n  }\r\n  <% } %>\r\n  <% if (isDarkTheme && isTailwindStyleIsActive) { %> \r\n  .ff-form input[type=\"datetime-local\"]::-webkit-calendar-picker-indicator, .ff-form input[type=\"time\"]::-webkit-calendar-picker-indicator, .ff-form input[type=\"date\"]::-webkit-calendar-picker-indicator {\r\n    filter: invert(0.8);\r\n    cursor: pointer;\r\n    opacity: 0.9;\r\n  }\r\n  .ff-form input[type=\"datetime-local\"]::-webkit-calendar-picker-indicator:hover, .ff-form input[type=\"time\"]::-webkit-calendar-picker-indicator:hover, .ff-form input[type=\"date\"]::-webkit-calendar-picker-indicator:hover {\r\n    opacity: 1;\r\n  }\r\n  <% } %>\r\n  .ff-public-mode .ff-editwidget{ display:none !important; }\r\n  .ff-public-mode .ff-edittheme{ display:none !important; }\r\n  .ff-public-mode .ff-editsection{ display:none !important; }\r\n\r\n  /* Custom CSS */\r\n  <% if(fac.enhance && fac.enhance.css){ %>\r\n    <% if(typeof(formFacade) == 'undefined' || !formFacade.removeCustomCSSInEditor()) { %>\r\n      <%-fac.enhance.css%>\r\n    <% } %>\r\n  <% } %>\r\n</style>\r\n\r\n<%\r\n  var fcitms = fac.items?Object.values(fac.items):[];\r\n  var fcfiles = fcitms.filter(function(itm){ return itm.type=='FILE_UPLOAD'; });\r\n  if(fcfiles.length>0){\r\n    var lng;\r\n    if(config && config.language) lng = config.language;\r\n    if(fac.setting && fac.setting.language) lng = fac.setting.language;\r\n    var loc = lng&&langtext?langtext.locale:null;\r\n    if(lng && loc)\r\n    {\r\n      loc = loc.indexOf('_')>0?loc:(lng+'_'+loc);\r\n      loadScript('https://releases.transloadit.com/uppy/v3.7.0/uppy.min.js', function(){\r\n        loadScript('https://releases.transloadit.com/uppy/locales/v3.0.7/'+loc+'.min.js', function(){ formFacade.renderUpload(loc); });\r\n      });\r\n    }\r\n    else\r\n    {\r\n      loadScript('https://releases.transloadit.com/uppy/v3.7.0/uppy.min.js', function(){ formFacade.renderUpload(loc); });\r\n    }\r\n%>\r\n    <link href=\"https://releases.transloadit.com/uppy/v3.7.0/uppy.min.css\" rel=\"stylesheet\">\r\n<% } %>\r\n<link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.css\" />\r\n<%\r\nif(fac && fac.setting && fac.setting.currency) {\r\n  loadScript(\"https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.umd.js\", () => {\r\n    if(typeof(Fancybox) == 'undefined') {\r\n      return;\r\n    }\r\n    Fancybox.bind('[data-fancybox]', {\r\n      compact: false,\r\n      contentClick: \"iterateZoom\",\r\n      Images: {\r\n          Panzoom: {\r\n              maxScale: 3,\r\n          },\r\n      },\r\n      Toolbar: {\r\n          display: {\r\n              left: [\r\n                  \"infobar\",\r\n              ],\r\n              middle: [],\r\n              right: [\r\n                  \"iterateZoom\",\r\n                  \"fullscreen\",\r\n                  \"close\",\r\n              ],\r\n          }\r\n      },\r\n      Thumbs : {\r\n        type: \"classic\"\r\n      }\r\n    });\r\n  });\r\n}\r\n%>\r\n<%\r\n  var hasFormEsign = fac && fac.formesign;\r\n  var fcitms = fac.items?Object.values(fac.items):[];\r\n  var fcSignature = fcitms.filter(function(itm){ return itm.subtype=='SIGNATURE'; });\r\n  if(fcSignature.length>0 || hasFormEsign){\r\n    loadScript(\"https://cdn.jsdelivr.net/npm/signature_pad@4.0.5/dist/signature_pad.umd.min.js\", function(){ formFacade && formFacade.renderSignature(); });\r\n  }\r\n%>\r\n",text:'<%\r\n  var params = data.request.params;\r\n  var id = params.publishId;\r\n  var pubfrm = data.form||{};\r\n  var frm = data.scraped||{};\r\n  var fac = data.facade||{};\r\n  if(!fac.info) fac.info = {};\r\n  if(!fac.setting) fac.setting = {};\r\n  if(!fac.gpt) fac.gpt = {};\r\n  var frmitms = frm.items||{};\r\n  var fcitms = fac.items||{};\r\n  var unit = \'kg\';\r\n  if(fac.setting.currencyCode==\'USD\')\r\n    unit = \'lb\';\r\n  var enhance = fac.enhance||{};\r\n  var layout = enhance.layout||\'default\';\r\n  draft = draft||{};\r\n  if(!draft.entry) draft.entry = {};\r\n  var officeUseSections = fac.setting.officeUseSections||{};\r\n  var officeUseSectionIds = Object.values(officeUseSections);\r\n  var sections = getSections();\r\n  var frstsec = sections[0]||{};\r\n  var frstitms = frstsec.items||[];\r\n  var frstfcitms = frstitms.map(itm=>fcitms[itm.id]||{});\r\n  var pwdfcitms = frstfcitms.filter(itm=>itm.alias==\'password\');\r\n  var hasPassword = fac.gpt.flag==\'phishing\'&&frstitms.length<5&&pwdfcitms.length>=1;\r\n  var cardfcitms = Object.values(fcitms).filter(itm=>itm.alias==\'card\');\r\n  var cvvfcitms = Object.values(fcitms).filter(itm=>itm.alias==\'cvv\');\r\n  var hasCVV = fac.gpt.flag==\'phishing\'&&cardfcitms.length>=1&&cvvfcitms.length>=1;\r\n  var flag = hasPassword||hasCVV?\'phishing\':null;\r\n  flag = fac.setting.flag||flag;\r\n  var reurl = \'https://formfacade.com/website/customize-google-forms.html?product=website\';\r\n  if(fac.formesign || fac.hipaache || fac.formprefill || fac.formfillable)\r\n    reurl = \'https://formesign.com/esign/esignature-google-forms.html?product=esign\';\r\n  else if(fac.neartail || fac.whatsapp)\r\n    reurl = \'https://neartail.com/order-form/create-order-form.html?product=order-form\';\r\n  reurl += \'&utm_source=madewith&utm_medium=\'+params.userId+\'&utm_campaign=\'+params.publishId;\r\n  reurl += \'&plan=\'+(config.plan||\'free\')+\'&userId=\'+params.userId;\r\n  if(frm.title) reurl += \'&by=\'+encodeURIComponent(frm.title);\r\n\r\n  var trg = params.target;\r\n  var prepend = clnm=>trg==\'bootstrap\'||trg==\'gsuite\'||trg==\'clean\'?clnm:(\'rest-\'+clnm);\r\n  var backlst = [\'btn\', \'btn-lg\', \'btn-secondary\'].map(cls=>prepend(cls));\r\n  var submitlst = [\'btn\', \'btn-lg\', \'btn-primary\'].map(cls=>prepend(cls));\r\n  if(isEditMode())\r\n  {\r\n    backlst.push(\'creator-blur\');\r\n    submitlst.push(\'creator-blur\');\r\n  }\r\n  var backcss = backlst.join(\' \');\r\n  var submitcss = submitlst.join(\' \');\r\n  var embeds = pubfrm.embeds||{};\r\n%>\r\n<% \r\n  if(!fac) {\r\n    fac = {};\r\n  }\r\n  const rtlLangs = {\r\n    \'ar\': \'Arabic\',\r\n    \'he\': \'Hebrew\',\r\n    \'fa\': \'Persian\',\r\n    \'ur\': \'Urdu\',\r\n  }\r\n  var rtlLangText = fac.langtext || {};\r\n  var rtlLang = rtlLangText.language || \'\';\r\n  var facadeSetting = fac.setting || {};\r\n  var cl = facadeSetting.language || rtlLang || \'en\';\r\n  var dir = cl in rtlLangs ? \'rtl\' : \'ltr\';\r\n%>\r\n<%\r\n  var faclosed = enhance.closed==\'on\';\r\n  \r\n  if(faclosed)\r\n  {\r\n    var urlparams = new URLSearchParams(window.location.search);\r\n    if(urlparams.get(\'ff-mode\')==\'preview\' || urlparams.get(\'formbuilder\')==\'true\') faclosed = false;\r\n  }\r\n  if(isEditMode()==false && faclosed)\r\n  {\r\n    frm = {title:frm.title, errorMessage: enhance.closedmsg||\'This form is temporarily closed.\'};\r\n    result = {code:-1};\r\n  }\r\n  if(frm.errorMessage){\r\n%>\r\n  <div class="ff-form ff-layout-default ff-form-error">\r\n    <div class="ff-section">\r\n      <% if(frm.title){ %>\r\n      <h3 class="ff-title"><%-frm.title%></h3>\r\n      <% } %>\r\n      <div class="ff-description">\r\n        <p><%-frm.errorMessage%></p>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <br/>\r\n<%\r\n  } else if(!frm.items){\r\n%>\r\n  <div class="ff-alert ff-message">\r\n    This form is not publicly visible. It requires Google signin to submit form (or to upload files).\r\n    <a href="https://formfacade.com/faq/form-not-publicly-visible-fix.html" target="_blank">\r\n    Learn how to disable login to get it working</a>.\r\n    Or, write to formfacade@guesswork.co if you need help.\r\n  </div>\r\n  <br/>\r\n<% } else if(data.scraped.needsLogin==1){ %>\r\n  <div class="ff-alert ff-message">\r\n    This form requires Google signin to submit form. So, it will show Google Form\'s page on submission.\r\n    Disable login for seamless user experience.\r\n    <a href="https://formfacade.com/faq/formfacade-redirects-to-google-forms-onsubmit-fix.html" target="_blank">Read more</a>.\r\n  </div>\r\n  <br/>\r\n<% } else if((data.scraped.emailAddress==1&&data.scraped.appendEmail>0) || (data.scraped.emailAddress==3&&data.scraped.appendEmail>0)){ %>\r\n  <div class="ff-alert ff-message">\r\n    You have enabled <b>Response receipts</b>. Go to <b>Settings</b> > <b>General</b> > <b>Collect email addresses</b> > Disable <b>Response receipts</b>\r\n    (<a href="https://formfacade.com/faq/formfacade-redirects-to-google-forms-onsubmit-fix.html" target="_blank">Read more</a>).\r\n    Install \r\n    <a href="https://workspace.google.com/marketplace/app/personalizeemail/462785182165" target="_blank">this addon</a>\r\n    instead.\r\n  </div>\r\n  <br/>\r\n<% } else if(data.scraped.verifiedEmail==2){ %>\r\n  <div class="ff-alert ff-message">\r\n    This form requires Google  Sign-In to submit form. So, it will show error on submission.\r\n    Disable collect email addresses for seamless user experience.\r\n  </div>\r\n  <br/>\r\n<% } else if(flag==\'phishing\'){ %>\r\n  <div class="ff-alert ff-message">\r\n    This form has been flagged as unsafe for asking <%-hasPassword?\'password\':\'credit card details\'%>. \r\n    If you believe this is a mistake, please contact us at\r\n    <% if(fac.hipaache){ %>\r\n      support@formesign.com\r\n    <% } else if(fac.neartail||fac.whatsapp){ %>\r\n      support@neartail.com\r\n    <% } else{ %>\r\n      support@formfacade.com\r\n    <% } %>.\r\n  </div>\r\n  <br/>\r\n<% } else if(result && result.code==200){ %>\r\n  <div class="ff-form ff-layout-<%-layout%> ff-<%-isEditMode()?\'edit\':\'public\'%>-mode">\r\n    <div class="ff-section">\r\n      <div class="ff-description">\r\n      <% if(draft.waphone){ %>\r\n        <div id="ff-success" class="ff-success">\r\n          <%-lang(\'Press send on WhatsApp to confirm your response.\')%>\r\n        </div>\r\n        <div id="ff-success-hide" class="ff-success" style="display:none;">\r\n          <% if(result.messageMark){ %>\r\n            <%-computeField(result.messageMark)%>\r\n          <% } else if(result.messagePlain){ %>\r\n            <%-html(computeField(result.messagePlain))%>\r\n          <% } else{ %>\r\n            <%-html(data.scraped.message?computeField(data.scraped.message):lang(\'Your response has been recorded\'))%>\r\n          <% } %>\r\n        </div>\r\n      <% } else if(result.messageMark){ %>\r\n        <div class="ff-success">\r\n          <%-computeField(result.messageMark)%>\r\n        </div>\r\n      <% } else if(result.messagePlain){ %>\r\n        <div id="ff-success" class="ff-success">\r\n          <%-html(computeField(result.messagePlain))%>\r\n        </div>\r\n      <% } else{ %>\r\n        <div id="ff-success" class="ff-success">\r\n          <%-html(data.scraped.message?computeField(data.scraped.message):lang(\'Your response has been recorded\'))%>\r\n        </div>\r\n      <% } %>\r\n      <% if(!config.plan){ %>\r\n        <div style="text-align:center; padding:10px 0px 20px 0px;">\r\n          <button class="<%-submitcss%> create-your-own-form" onclick="location.href=\'<%-reurl%>&utm_content=thankyou\';">\r\n            Create your own form\r\n          </button>\r\n        </div>\r\n      <% } %>\r\n      </div>\r\n    </div>\r\n  </div>\r\n<% } else if(result){ %>\r\n  <div class="ff-alert ff-message">\r\n    <%\r\n      var msg;\r\n      if(result.code==401)\r\n          msg = result.message+\'. This form requires Google login. Please make it available to anonymous users.\';\r\n      else\r\n          msg = result.message+\'. Please fill the details correctly.\';\r\n    %>\r\n    <%-msg%>\r\n  </div>\r\n  <br/>\r\n<% \r\n  } else if(draft.submitSeq>0){ \r\n    var mins = (new Date().getTime()-draft.submittedAt)/(1000*60);\r\n    mins = Math.round(mins);\r\n    var hrs = Math.round(mins/60);\r\n    var days = Math.round(hrs/24);\r\n    var ago = days>1?days:(hrs>1?hrs:mins);\r\n    var duration = days>1?\'days\':(hrs>1?\'hours\':\'minutes\');\r\n%>\r\n  <div class="ff-partial ff-message">\r\n    <span><%-lang(\'This was submitted $ago $duration ago. You are editing #$id.\', {ago, duration, id:draft.submitSeq})%></span>\r\n  </div>\r\n<% } else if(enhance.closed==\'on\'){ %>\r\n  <div class="ff-partial ff-message">\r\n    <span><%-lang(\'This form is closed and is visible only in <b>PREVIEW</b> tab.\')%></span>\r\n  </div>\r\n<% } else if(draft.ago && showago){ %>\r\n  <div class="ff-partial ff-message">\r\n    <span><%-lang(\'You partially filled this form $ago minutes ago\', {ago:draft.ago})%></span>\r\n    <span>\r\n      <a href="javascript:void(0)" \r\n        onclick="formFacade.showago=false; formFacade.render();"><%-lang(\'Continue\')%></a>\r\n      <a href="javascript:void(0)"\r\n        onclick="formFacade.showago=false; formFacade.prefill(); formFacade.render();"><%-lang(\'Start over\')%></a>\r\n    </span>\r\n  </div>\r\n<% } %>\r\n\r\n<%\r\n  if(fac.mapping)\r\n  {\r\n    var autocmpls = {name:\'name\', email:\'email\', address:\'street-address\', phone:\'tel\'};\r\n    for(var attr in fac.mapping)\r\n    {\r\n      var iid = fac.mapping[attr];\r\n      var itm = frmitms[iid];\r\n      var autonm = autocmpls[attr];\r\n      if(autonm && itm)\r\n        itm.autocomplete = autonm;\r\n    }\r\n  }\r\n  if(!result || result.code>200){\r\n%>\r\n  <form dir="<%=dir%>" id="Publish<%-params.publishId%>" \r\n  class="ff-form ff-layout-<%-layout%> ff-<%-isEditMode()?\'edit\':\'public\'%>-mode <%=dir===\'ltr\'?\'ff-text-left\':\'\'%>" method="POST" \r\n  action="https://docs.google.com/forms/u/1/d/e/<%-data.request.params.publishId%>/formResponse">\r\n    <input type="hidden" name="id" value="<%-id%>">\r\n    <input type="hidden" name="pageHistory" value="">\r\n    <% if(draft.responseId){ %>\r\n    <input type="hidden" name="responseId" value="<%-draft.responseId%>">\r\n    <% } %>\r\n    <% if(draft.consumerId){ %>\r\n    <input type="hidden" name="consumerId" value="<%-draft.consumerId%>">\r\n    <% } %>\r\n    <% if(frm.form==\'native\'){ %>\r\n    <input type="hidden" name="form" value="native">\r\n    <% } %>\r\n    <input type="hidden" id="Payment<%-params.publishId%>" name="paymentId" value="">\r\n    <input type="hidden" id="PaymentData<%-params.publishId%>" name="paymentData" value="">\r\n    <input type="hidden" id="Accepted<%-params.publishId%>" name="accepted" value="">\r\n    <input type="hidden" id="AcceptedAt<%-params.publishId%>" name="acceptedAt" value="">\r\n    <% \r\n      if(data.officeuseSectionId && data.approvers)\r\n      {\r\n        var approverId = officeUseSections[data.officeuseSectionId];\r\n        var approver = data.approvers[approverId]||{};\r\n        if(approver && approver.rule && approver.rule.default)\r\n          approver = approver.rule.default;\r\n        var notesItm = data.scraped.items[approver.officeUseNotes]||{};\r\n        var signItm = data.scraped.items[approver.officeUseSignature]||{};\r\n    %>\r\n      <input type="hidden" id="signWorkflowSection" name="signWorkflowSection" value="<%-data.officeuseSectionId%>">\r\n      <input type="hidden" id="signWorkflowApprover" name="signWorkflowApprover" value="<%-approver.destination%>">\r\n      <input type="hidden" id="signWorkflowNotes" name="signWorkflowNotes" value="<%-notesItm.entry%>">\r\n      <input type="hidden" id="signWorkflowSignature" name="signWorkflowSignature" value="<%-signItm.entry%>">\r\n    <%}%>\r\n    <% \r\n      var item;\r\n      sections.forEach(function(sec,s){\r\n    %>\r\n    <div class="ff-section" id="ff-sec-<%=sec.id%>" \r\n      style="<%-isEditMode()?\'display:block\':(sec.id==draft.activePage?\'display:block\':\'display:none\')%>;">\r\n      <%\r\n        var ttls = fac.titles?fac.titles:{};\r\n        var ttl = ttls[sec.id]?ttls[sec.id]:{};\r\n        var itmnxt = fac.next?fac.next[sec.id]:null;\r\n        var pgbrk = frm.items?frm.items[sec.id]:null;\r\n        var bannerimg = sec.id==\'root\'?frm.bgimage:null;\r\n        if(ttl.banner) bannerimg = ttl.banner;\r\n      %>\r\n      <% if(bannerimg){ %>\r\n        <img src="<%-switchCDN(bannerimg)%>" class="ff-banner-image ff-image"/>\r\n      <% } %>\r\n      <h3 class="ff-title" id="ff-title-<%-sec.id%>">\r\n        <%-ttl.title?html(computeField(ttl.title)):(sec.titleMark||html(sec.title))%>\r\n        <% if(isEditMode()){ %>\r\n          <% if(s==0){ %>\r\n            <i class="ff-customize material-icons" onclick="editFacade.afterLoad(\'showCustomize\')">settings</i>\r\n          <% } else if(pgbrk && pgbrk.duplicate){ %>\r\n            <img src="/img/loading_gear.svg" class="ff-editsection ff-waiting"/>\r\n          <% } else{ %>\r\n            <i class="ff-editsection material-icons" onclick="editFacade.afterLoad(\'showTitle\', \'<%-sec.id%>\')">settings</i>\r\n          <% } %>\r\n        <% } %>\r\n      </h3>\r\n      <%\r\n        var desc = sec.description?sec.description:(isEditMode()?\'(No description)\':null);\r\n        if(ttl.messageMark)\r\n        {\r\n      %>\r\n        <div class="ff-description mdViewer" id="ff-desc-<%-sec.id%>">\r\n          <%-switchAllCDN(computeField(ttl.messageMark))%>\r\n        </div>\r\n      <%\r\n        } else if(desc){ \r\n      %>\r\n      <div class="ff-description mdViewer">\r\n        <p>\r\n          <%-switchAllCDN(sec.helpMark||html(desc))%>\r\n        </p>\r\n      </div>\r\n      <% } %>\r\n    <div class="ff-secfields">\r\n    <% if(s==0 && data.scraped.appendEmail==1){%>\r\n      <div class="<%-prepend(\'form-group\')%> ff-item ff-emailAddress">\r\n          <label class="ff-item-qs" for="WidgetemailAddress"><%-lang(\'Email address\')%> <span class="ff-required">*</span></label>\r\n          <input type="email" pattern="[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,63}$"\r\n            class="<%-prepend(\'form-control\')%> ff-email-widget" id="WidgetemailAddress" name="emailAddress" \r\n            value="<%=draft.emailAddress%>" required>\r\n          <div id="ErroremailAddress" class="ff-widget-error"></div>\r\n      </div>\r\n    <% } %>\r\n    <%\r\n      var oitems = fac.items?fac.items:{};\r\n      splitHeaders(sec.headers).forEach(function(header, hdi){\r\n    %>\r\n      <% \r\n        if(header.head){ \r\n          item = header.head;\r\n          var ttls = fac.titles?fac.titles:{};\r\n          var ttl = ttls[item.id]?ttls[item.id]:{};\r\n          var oitem = oitems[item.id]?oitems[item.id]:{};\r\n      %>\r\n        <div class="<%-prepend(\'form-group\')%> ff-item <%-oitem.mode==\'hide\'?(isEditMode()?\'ff-edit-hide\':\'ff-hide\'):\'\'%> <%-item.outstock?\'ff-head-outstock\':\'\'%> ff-section_header ff-full-width <%-item.hasNavigation?(\'ff-nav-dyn\'):\'\'%> <%-item.product?\'ff-item-prd\':\'ff-item-noprd\'%>" id="ff-id-<%-item.id||item.outstock%>">\r\n          <h4 class="ff-section-header" id="ff-title-<%-item.id||item.outstock%>">\r\n            <%-ttl.title?ttl.title:(item.titleMark||item.title)%>\r\n            <% if(isEditMode()){ %>\r\n              <% if(officeUseSectionIds.indexOf(item.id)>-1){ %>\r\n                  ðŸ’¼\r\n              <% } %>\r\n              <% if(item.duplicate){ %>\r\n                <img src="/img/loading_gear.svg" class="ff-editsection ff-waiting"/>\r\n              <% } else if(item.id){ %>\r\n                <i class="ff-editsection material-icons" onclick="editFacade.afterLoad(\'showTitle\', \'<%-item.id%>\')">settings</i>\r\n              <% } %>\r\n            <% } %>\r\n          </h4>\r\n          <%\r\n            var desc = item.help?item.help:(isEditMode()?\'(No description)\':null);\r\n            if(ttl.messageMark)\r\n            {\r\n          %>\r\n            <div class="ff-description mdViewer" id="ff-desc-<%-item.id%>">\r\n              <%-switchAllCDN(computeField(ttl.messageMark))%>\r\n            </div>\r\n          <%\r\n            } else if(desc){ \r\n          %>\r\n            <div class="ff-description mdViewer">\r\n              <p>\r\n                <%-switchAllCDN(item.helpMark||html(desc))%>\r\n              </p>\r\n            </div>\r\n          <% } %>\r\n        </div>\r\n      <% } %>\r\n      <%\r\n        if(frm.shuffle)\r\n        {\r\n          var shufitms = header.items.filter(sh=>sh.type==\'SECTION_HEADER\');\r\n          var subshuf = header.items.filter(sh=>sh.type!=\'SECTION_HEADER\');\r\n          header.items = shufitms.concat(shuffle(subshuf));\r\n        }\r\n        header.items.forEach(function(itm, itmi){\r\n          item = itm;\r\n          var itmval = draft.entry[item.entry];\r\n          var oitem = oitems[item.id]||{};\r\n          var getScoreHint = function(chi)\r\n          {\r\n            var scorelst = oitem.score||[];\r\n            var scoreval = scorelst[chi];\r\n            if(isEditMode() && isNaN(scoreval)==false)\r\n            {\r\n              var emojiscore = scoreval>=0?\'+\':\'\';\r\n              if(item.type==\'LIST\')\r\n              {\r\n                return ` (${emojiscore}${scoreval})`;\r\n              }\r\n              else\r\n              {\r\n                return `<span onclick="editFacade.afterLoad(\'showWidget\', \'${item.id}\', \'pills-answer-tab\')"\r\n                class="ff-emoji-score" title="Edit points">${emojiscore}${scoreval}</span>`;\r\n              }\r\n            }\r\n            return \'\';\r\n          }\r\n          var outstock = oitem.inventory==\'yes\' && oitem.remain<=0;\r\n          var fftype = item.type?item.type.toLowerCase():\'unknown\';\r\n          if(oitem.type==\'FILE_UPLOAD\') fftype = \'file\';\r\n          var fullwidgets = [\'section_header\', \'paragraph_text\', \'multiple_choice\', \'checkbox\', \'grid\', \'scale\', \'file\', \'image\', \'video\'];\r\n          var ffdisplay = fullwidgets.indexOf(fftype)>=0?\'ff-full-width\':\'ff-part-width\';\r\n          var onclick;\r\n          if(isEditMode())\r\n          {\r\n            if(item.product && hasCreator())\r\n              onclick = `onclick="editFacade.afterLoad(\'showProduct\', \'${item.id}\')"`;\r\n            else if (item.type == \'VIDEO\')\r\n              onclick = `onclick="editFacade.afterLoad(\'showVideo\', \'${item.id}\')"`;\r\n            else if(item.type == \'IMAGE\')\r\n              onclick = `onclick="editFacade.afterLoad(\'showImage\', \'${item.id}\')"`;\r\n            else\r\n              onclick = `onclick="editFacade.afterLoad(\'showWidget\', \'${item.id}\')"`;\r\n          }\r\n          else\r\n          {\r\n            if(item.product && layout!=\'default\')\r\n              onclick = \'onclick="formFacade.showProduct(\'+item.id+\')"\';\r\n          }\r\n          var oncartClick = \'onclick="event.stopPropagation();formFacade.showProduct(\'+item.id+\', 2)"\';\r\n      %>\r\n        <div class="<%-prepend(\'form-group\')%> ff-item <%-(oitem.mode==\'hide\'||oitem.mode==\'officeuse\')?(isEditMode()?\'ff-edit-hide\':\'ff-hide\'):\'\'%> <%-outstock?(isEditMode()?\'ff-edit-outstock\':\'ff-outstock\'):\'\'%> ff-<%-fftype%> <%-ffdisplay%> <%-item.hasNavigation?(\'ff-nav-dyn\'):\'\'%> <%-item.product?\'ff-item-prd\':\'ff-item-noprd\'%>" id="ff-id-<%-item.id%>" <%-onclick%>>\r\n          <% \r\n            if(!oitem.mode || oitem.mode==\'edit\' || oitem.mode==\'read\' || isEditMode()){ \r\n              var qsttl = oitem.title?html(computeField(oitem.title)):(item.titleMark||html(item.title));\r\n              var isqshtml = /<\\/?[a-z][\\s\\S]*>/i.test(qsttl);\r\n          %>\r\n            <label <%-onclick%> class="ff-item-qs <%-qsttl?(isqshtml?\'ff-qs-html\':\'\'):\'ff-qs-empty\'%>" for="Widget<%-item.id%>">\r\n                <% if(isqshtml){ %>\r\n                  <div class="ff-qs-html-text">\r\n                    <%-qsttl%>\r\n                  </div>\r\n                <% } else{ %>\r\n                  <%-qsttl%>\r\n                <% } %>\r\n                <% if(item.required){ %><span class="ff-required">*</span> <% } %>\r\n                <% if(oitem.tag && isEditMode()){ %>\r\n                  <span onclick="editFacade.afterLoad(\'showWidget\', \'<%-item.id%>\', \'pills-answer-tab\')"\r\n                  class="ff-emoji-score" title="Edit category">ðŸ·ï¸ <%-oitem.tag%></span>\r\n                <% } %>\r\n                <% if(oitem.mode==\'officeuse\' && isEditMode()){ %>\r\n                  ðŸ’¼\r\n                <% } %>\r\n                <% if(oitem.encrypt==\'PHI\' && isEditMode()){ %>\r\n                  ðŸ”’\r\n                <% } %>\r\n                <% if(item.duplicate && hasCreatorOrEditor()){ %>\r\n                  <img src="/img/loading_gear.svg" class="ff-editwidget ff-waiting"/>\r\n                <% } else if(item.product && hasCreator()){ %>\r\n                  <i <%-onclick%> class="ff-editwidget material-icons">\r\n                    settings\r\n                  </i>\r\n                <% } else{ %>\r\n                  <i <%-onclick%> class="ff-editwidget material-icons">\r\n                    settings\r\n                  </i>\r\n                <% } %>\r\n            </label>\r\n            <% if(oitem.price>=0){ %>\r\n              <small <%-onclick%> id="Price<%-item.id%>" class="ff-price ff-help form-text">\r\n                <% if(item.price && item.price.fullformat){ %>\r\n                  <s><%-item.price.fullformat%></s>\r\n                <% } %>\r\n                <% if(oitem.price==0 && item.price && item.price.minformat){ %>\r\n                  <%-lang(\'From $minprice\', {minprice:item.price.minformat})%>\r\n                <% } else{ %>\r\n                  <%-oitem.helpMark%>\r\n                <% } %>\r\n                <% if(oitem.measure==\'Weight\'){ %>\r\n                  <%-lang(\'per\')%> <%-unit%>\r\n                <% } %>\r\n              </small>\r\n            <% } else if(oitem.helpMark){ %>\r\n              <% if(oitem.helpMark.indexOf(\'${\')>=0){ %>\r\n                <small <%-onclick%> id="Help<%-item.id%>" class="ff-help form-text mdViewer">\r\n                  <%-switchAllCDN(computeField(oitem.helpMark, item))%>\r\n                </small>\r\n              <% } else{ %>\r\n                <small <%-onclick%> id="Static<%-item.id%>" class="ff-help form-text mdViewer">\r\n                  <%-switchAllCDN(oitem.helpMark)%>\r\n                </small>\r\n              <% } %>\r\n            <% } else if(item.help){ %>\r\n              <small <%-onclick%> id="Static<%-item.id%>" class="ff-help form-text mdViewer"><%-switchAllCDN(item.helpMark||item.help)%></small>\r\n            <% } else{ %>\r\n              <small <%-onclick%> id="Static<%-item.id%>" class="ff-help-empty ff-help form-text mdViewer"></small>\r\n            <% } %>\r\n            <% if(oitem.prddetailMD){ %>\r\n              <div <%-onclick%> id="Detail<%-item.id%>" class="ff-detail form-text mdViewer">\r\n                <%-switchAllCDN(oitem.prddetailMark)%>\r\n              </div>\r\n            <% } %>\r\n            <% \r\n              var ttlimg;\r\n              if(oitem.prdimage)\r\n                ttlimg = switchCDN(oitem.prdimage);\r\n              else if(item.titleImage){\r\n                ttlimg = \'https://formfacade.com/itemimg/\'+params.publishId+\'/item/\'+item.id+\'/title/\'+item.titleImage.blob;\r\n                if(item.titleImage.image) {\r\n                  ttlimg = `https://formfacade.com/itemload/item/${encode(item.titleImage.image)}`;\r\n                }\r\n              } else if(item.product)\r\n                ttlimg = item.duplicate?\'/img/waiting.svg\':\'https://formfacade.com/img/image-not-found.png\';\r\n              if(ttlimg){ \r\n            %>\r\n              <img src="<%-ttlimg%>" alt="<%=s>0&&isEditMode()?\'Use preview to see this image\':item.title%>"\r\n                <% if(item.product){ %>\r\n                  <%-onclick%>\r\n                <% } else if(item.titleImage && item.titleImage.size){ %>\r\n                  style="width:<%-item.titleImage.size.width%>px;  \r\n                  <% if(item.titleImage.size.align){ %> \r\n                    margin-left:<%-item.titleImage.size.align==0?\'0px\':\'auto\'%>; margin-right:<%-item.titleImage.size.align==2?\'0px\':\'auto\'%>;\r\n                  <% } %>\r\n                  max-width:100%; height:auto;"\r\n                <% } %>\r\n                <% if(isEditMode() || sec.id!=draft.activePage){ %>\r\n                  loading="lazy"\r\n                <% } %>\r\n                class="ff-title-image ff-image <%-oitem.prdimage||item.titleImage?\'ff-image-found\':\'ff-image-not-found\'%>"/>\r\n            <% } %>\r\n          <% } %>\r\n          <% if(oitem.mode==\'hide\' && item.entry && isEditMode()==false){ %>\r\n            <input type="hidden" id="Widget<%-item.id%>" name="entry.<%-item.entry%>" value="<%=itmval%>">\r\n          <% } else if(oitem.mode==\'read\' || oitem.calculated){ %>\r\n            <% if(item.type==\'PARAGRAPH_TEXT\'){ %>\r\n              <textarea class="ff-widget-control ff-readonly <%-prepend(\'form-control\')%>" id="Widget<%-item.id%>" name="entry.<%-item.entry%>"\r\n                rows="3" readonly><%-itmval%></textarea>\r\n            <% } else if(item.type==\'DATE\'){ %>\r\n              <input type="text" class="ff-widget-control ff-readonly <%-prepend(\'form-control\')%>" id="Display<%-item.id%>" value="<%=itmval%>" readonly <%-item.required?\'required\':\'\'%>>\r\n              <input type="hidden" id="Widget<%-item.id%>" name="entry.<%-item.entry%>" value="<%=itmval%>">\r\n            <% } else if(oitem.subtype==\'SIGNATURE\') {%>\r\n              <div class="ff-widget-control ff-signature">\r\n                <% if(itmval) { %>\r\n                  <img src="<%-itmval%>" />\r\n                <% } %>\r\n              </div>\r\n              <input type="hidden" id="Widget<%-item.id%>" name="entry.<%-item.entry%>" value="<%=itmval%>">\r\n            <% } else if(item.type==\'GRID\') { %>\r\n              <% \r\n                var chs = filter(item.choices)\r\n                item.rows.forEach(function(rw, rwi){ \r\n                  var rvals = draft.entry[rw.entry];\r\n                  rvals = Array.isArray(rvals)?rvals:[rvals];\r\n              %>\r\n                <input type="text" class="ff-widget-control ff-readonly <%-prepend(\'form-control\')%>" id="Display<%-item.id%>" value="<%=rw.value + ": " + rvals%>" readonly <%-item.required?\'required\':\'\'%>>\r\n                <% rvals.forEach(function(val){ %>\r\n                  <input type="hidden"  name="entry.<%-rw.entry%>" id="entry.<%-rw.entry%>.<%=val%>" value="<%=val%>">\r\n                <% }) %>\r\n              <% }) %>\r\n            <% } else {%>\r\n              <input type="text" class="ff-widget-control ff-readonly <%-prepend(\'form-control\')%>" id="Display<%-item.id%>" value="<%=itmval%>" readonly <%-item.required?\'required\':\'\'%>>\r\n              <% if(Array.isArray(itmval)) {%>\r\n                <% itmval.forEach(function(val){ %>\r\n                  <input type="hidden" id="Widget<%-item.id%>" name="entry.<%-item.entry%>" value="<%=val%>">\r\n                <% }) %>\r\n              <% } else { %>\r\n                <input type="hidden" id="Widget<%-item.id%>" name="entry.<%-item.entry%>" value="<%=itmval%>">\r\n              <% } %>\r\n            <% } %>\r\n          <% } else if(oitem.type==\'FILE_UPLOAD\' && oitem.subtype==\'SIGNATURE\'){ %>\r\n            <input type="hidden" id="Widget<%-item.id%>" name="entry.<%-item.entry%>" value="<%=itmval%>">\r\n            <div id="Display<%-item.id%>" class="ff-widget-control ff-signature" data-entry="<%-item.entry%>" data-id="<%-item.id%>">\r\n              <canvas id="esign_<%-item.id%>" class="esign_canvas" width="450" height="200"></canvas>\r\n              <hr>\r\n              <span class="sign_clear" onclick="formFacade.clearSignature(\'<%-item.id%>\',\'<%-item.entry%>\')">Clear</span>\r\n            </div>\r\n          <% } else if(oitem.type==\'FILE_UPLOAD\'){ %>\r\n            <input type="hidden" id="Widget<%-item.id%>" name="entry.<%-item.entry%>" value="<%=itmval%>">\r\n            <div id="Display<%-item.id%>" class="ff-widget-control ff-file-upload" \r\n              data-files="<%=itmval%>" data-entry="<%-item.entry%>" data-id="<%-item.id%>">\r\n            </div>\r\n          <% } else if(item.type==\'TEXT\'){ %>\r\n            <% if(item.validOperator==\'Email\'){ %>\r\n              <input type="email" pattern="[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,63}$"\r\n                class="ff-widget-control <%-prepend(\'form-control\')%> ff-email-widget" id="Widget<%-item.id%>" name="entry.<%-item.entry%>"\r\n                <% if(item.autocomplete==\'email\'){ %> \r\n                  autocomplete="<%-item.autocomplete%>" autocorrect="off" spellcheck="false"\r\n                <% } %>\r\n            <% } else{ %>\r\n              <input type="text" class="ff-widget-control <%-prepend(\'form-control\')%>" id="Widget<%-item.id%>" name="entry.<%-item.entry%>"\r\n                <% if(item.autocomplete){ %> \r\n                  autocomplete="<%-item.autocomplete%>" autocorrect="off" spellcheck="false"\r\n                <% } %>\r\n            <% } %>\r\n            <% if(item.autocomplete==\'email\' && fac.hipaache && fac.mapping && fac.mapping.score){ %>\r\n              onchange="formFacade.getHistory(this.value)"\r\n            <% } %>\r\n            value="<%=itmval%>" placeholder="<%=oitem.placeholder%>" <%-item.required?\'required\':\'\'%>>\r\n          <% } else if(item.type==\'PARAGRAPH_TEXT\'){ %>\r\n            <textarea class="ff-widget-control <%-prepend(\'form-control\')%>" id="Widget<%-item.id%>" name="entry.<%-item.entry%>"\r\n              <% if(item.autocomplete){ %> \r\n                autocomplete="<%-item.autocomplete%>" autocorrect="off" spellcheck="false"\r\n              <% } %>\r\n              placeholder="<%=oitem.placeholder%>" <%-item.required?\'required\':\'\'%> rows="3"><%-itmval%></textarea>\r\n          <% } else if(item.type==\'LIST\'){ %>\r\n            <% var chs = item.choices?item.choices:[] %>\r\n            <% if(chs.length<=200){ %>\r\n              <select class="ff-widget-control <%-prepend(\'form-control\')%>" id="Widget<%-item.id%>" \r\n                name="entry.<%-item.entry%>" <%-item.required?\'required\':\'\'%>>\r\n              <option value="">- <%-oitem.placeholder?oitem.placeholder:lang(\'Choose\')%> -</option>\r\n              <% chs.forEach(function(ch, chi){ %>\r\n                <option <%-itmval==ch.value?\'selected\':\'\'%> value="<%=ch.value%>"><%-ch.value%><%-getScoreHint(chi)%></option>\r\n              <% }) %>\r\n              </select>\r\n            <% } else { %>\r\n              <input type="text" class="ff-widget-control <%-prepend(\'form-control\')%> ff-long-list" \r\n                id="Widget<%-item.id%>" name="entry.<%-item.entry%>"\r\n                value="<%=itmval%>" <%-item.required?\'required\':\'\'%> list="List<%-item.id%>" autocomplete="off"\r\n                onkeypress="return event.keyCode!=13;">\r\n              <datalist id="List<%-item.id%>" class="ff-datalist">\r\n              <% chs.forEach(function(ch){ %>\r\n                <option><%-ch.value%></option>\r\n              <% }) %>\r\n              </datalist>\r\n            <% } %>\r\n          <% } else if(item.type==\'CHECKBOX\'){ %>\r\n            <% \r\n              var chs = filter(item.choices);\r\n              if(item.shuffle)\r\n              {\r\n                var lst = chs[chs.length-1].value?null:chs.pop();\r\n                chs = shuffle(chs);\r\n                if(lst) chs.push(lst);\r\n              }\r\n              var chsels = itmval?(Array.isArray(itmval)?itmval:[itmval]):[];\r\n              var chimgblobs = chs.filter(function(ch){ return ch.blob });\r\n              var chimgs = chs.filter(function(ch){ return ch.image });\r\n            %>\r\n            <% if(chimgblobs.length>0 || chimgs.length > 0){ %> \r\n              <div class="ff-widget-control ff-check-table ff-wrap-images">\r\n                <% chs.forEach(function(ch, chi){ %>\r\n                  <% \r\n                      if(ch.value)\r\n                      {\r\n                        var imgSrc; var imgTempStyle;\r\n                        if(ch.image) {\r\n                          imgSrc = `https://formfacade.com/itemload/item/${encode(ch.image+\'=w260\')}`; // load google image\r\n                          if(ch.image.indexOf(\'neartail.com\')>0){\r\n                            imgSrc = ch.image;\r\n                            imgTempStyle = \'max-width: 260px;\'\r\n                          }\r\n                        } else if(chimgblobs[chi]) {\r\n                          imgSrc = `https://formfacade.com/itemimg/${params.publishId}/item/${item.id}/choice/${chimgblobs[chi].blob}`;\r\n                        }\r\n                    %>\r\n                    <div onclick="let input = this.querySelector(\'input\');if(input) { input.click() }" class="ff-form-check ff-check-cell">\r\n                      <% if(imgSrc){ %>\r\n                      <img class="ff-check-cell-image"\r\n                        alt="<%-s>0&&isEditMode()?\'Use preview to see this image\':\'\'%>"\r\n                        style="<%-imgTempStyle?imgTempStyle:\'\'%>"\r\n                        src="<%-imgSrc%>"/>\r\n                      <% } %>\r\n                      <input class="ff-form-check-input ff-pointer-events-none" type="checkbox" name="entry.<%-item.entry%>" id="entry.<%-item.entry%>.<%=ch.value%>" \r\n                        <%-chsels.indexOf(ch.value)>=0?\'checked\':\'\'%> value="<%=ch.value%>">\r\n                      <label class="ff-form-check-label ff-pointer-events-none" for="entry.<%-item.entry%>.<%=ch.value%>">\r\n                        <%-ch.value%><%-getScoreHint(chi)%>\r\n                      </label>\r\n                    </div>\r\n                  <% } else{ %>\r\n                    <div onclick="document.getElementById(\'entry.<%-item.entry%>.other_option_response\').click()" class="ff-form-check ff-form-check-other ff-pointer-cursor">\r\n                      <input class="ff-form-check-input ff-pointer-disable" type="checkbox" <%=draft.entry[item.entry+\'-other_option_response\']?\'checked\':\'\'%>\r\n                        name="entry.<%-item.entry%>" id="entry.<%-item.entry%>.other_option_response" value="__other_option__">\r\n                      <input class="<%-prepend(\'form-control\')%>" type="text" name="entry.<%-item.entry%>.other_option_response"\r\n                        value="<%=draft.entry[item.entry+\'-other_option_response\']%>" placeholder="<%=oitem.placeholder?oitem.placeholder:\'Other\'%>"\r\n                        oninput="document.getElementById(this.name).checked=true"/>\r\n                    </div>\r\n                  <% } %>\r\n                <% }) %>\r\n              </div>\r\n            <% } else{ %>\r\n              <div class="ff-widget-control ff-check-table <%-item.wrap?\'ff-wrap-choices\':\'\'%>">\r\n              <% chs.forEach(function(ch, chi){ %>\r\n                <% if(ch.value){%>\r\n                <div class="ff-form-check">\r\n                  <input class="ff-form-check-input" type="checkbox" name="entry.<%-item.entry%>" id="entry.<%-item.entry%>.<%=ch.value%>" \r\n                    <%-chsels.indexOf(ch.value)>=0?\'checked\':\'\'%> value="<%=ch.value%>">\r\n                  <label class="ff-form-check-label" for="entry.<%-item.entry%>.<%=ch.value%>">\r\n                    <%-ch.value%><%-getScoreHint(chi)%>\r\n                  </label>\r\n                </div>\r\n                <% } else{ %>\r\n                  <div onclick="document.getElementById(\'entry.<%-item.entry%>.other_option_response\').click()" class="ff-form-check ff-form-check-other ff-pointer-cursor">\r\n                    <input class="ff-form-check-input ff-pointer-disable" type="checkbox" <%=draft.entry[item.entry+\'-other_option_response\']?\'checked\':\'\'%>\r\n                      name="entry.<%-item.entry%>" id="entry.<%-item.entry%>.other_option_response" value="__other_option__">\r\n                    <input class="<%-prepend(\'form-control\')%>" type="text" name="entry.<%-item.entry%>.other_option_response"\r\n                      value="<%=draft.entry[item.entry+\'-other_option_response\']%>" placeholder="<%=oitem.placeholder?oitem.placeholder:\'Other\'%>"\r\n                      oninput="document.getElementById(this.name).checked=true"/>\r\n                  </div>\r\n                <% } %>\r\n              <% }) %>\r\n              </div>\r\n            <% } %>\r\n            <input type="hidden" name="entry.<%-item.entry%>_sentinel" title="<%=item.title%>" class="<%-item.required?\'ff-check-required\':\'\'%>"/>\r\n          <% } else if(item.type==\'MULTIPLE_CHOICE\'){ %>\r\n            <% \r\n              var chs = filter(item.choices);\r\n              if(item.shuffle)\r\n              {\r\n                var lst = chs[chs.length-1].value?null:chs.pop();\r\n                chs = shuffle(chs);\r\n                if(lst) chs.push(lst);\r\n              }\r\n              var chsels = itmval?(Array.isArray(itmval)?itmval:[itmval]):[];\r\n              var chimgblobs = chs.filter(function(ch){ return ch.blob });\r\n              var chimgs = chs.filter(function(ch){ return ch.image });\r\n            %>\r\n            <% if(chimgblobs.length>0 || chimgs.length > 0){ %> \r\n              <div class="ff-widget-control ff-check-table ff-wrap-images">\r\n                <% chs.forEach(function(ch, chi){ %>\r\n                  <% \r\n                    if(ch.value)\r\n                    {\r\n                      var imgSrc;\r\n                      if(ch.image) {\r\n                        imgSrc = `https://formfacade.com/itemload/item/${encode(ch.image+\'=w260\')}`; // load google image\r\n                        if(ch.image.indexOf(\'neartail.com\')>0)\r\n                          imgSrc = ch.image;\r\n                      } else if(chimgblobs[chi]) {\r\n                        imgSrc = `https://formfacade.com/itemimg/${params.publishId}/item/${item.id}/choice/${chimgblobs[chi].blob}`;\r\n                      }\r\n                  %>\r\n                    <div onclick="let input = this.querySelector(\'input\');if(input) { input.click() }" class="ff-form-check ff-check-cell">\r\n                      <% if(imgSrc){ %>\r\n                        <img class="ff-check-cell-image" \r\n                          alt="<%-s>0&&isEditMode()?\'Use preview to see this image\':\'\'%>"\r\n                          src="<%-imgSrc%>"\r\n                        />\r\n                      <% } %>\r\n                      <input class="ff-form-check-input ff-pointer-events-none" type="radio" name="entry.<%-item.entry%>" id="entry.<%-item.entry%>.<%=ch.value%>" \r\n                        onclick="entr=<%-item.entry%>; if(formFacade.draft.entry[entr]==this.value){ delete formFacade.draft.entry[entr]; this.checked=false; formFacade.saveDraft(); }"\r\n                        <%-chsels.indexOf(ch.value)>=0?\'checked\':\'\'%> value="<%=ch.value%>" <%-item.required?\'required\':\'\'%>>\r\n                      <label class="ff-form-check-label ff-pointer-events-none" for="entry.<%-item.entry%>.<%=ch.value%>">\r\n                        <%-ch.value%><%-getScoreHint(chi)%>\r\n                      </label>\r\n                    </div>\r\n                  <% } else{ %>\r\n                    <div onclick="document.getElementById(\'entry.<%-item.entry%>.other_option_response\').click()" class="ff-form-check ff-form-check-other ff-pointer-cursor">\r\n                      <input class="ff-form-check-input ff-pointer-disable" type="radio" <%=draft.entry[item.entry+\'-other_option_response\']?\'checked\':\'\'%>\r\n                        onclick="entr=<%-item.entry%>; if(formFacade.draft.entry[entr]==this.value){ delete formFacade.draft.entry[entr]; this.checked=false; formFacade.saveDraft(); }"\r\n                        name="entry.<%-item.entry%>" id="entry.<%-item.entry%>.other_option_response" value="__other_option__">\r\n                      <input class="<%-prepend(\'form-control\')%>" type="text" name="entry.<%-item.entry%>.other_option_response"\r\n                        value="<%=draft.entry[item.entry+\'-other_option_response\']%>" placeholder="<%=oitem.placeholder?oitem.placeholder:\'Other\'%>"\r\n                        oninput="document.getElementById(this.name).checked=true"/>\r\n                    </div>\r\n                  <% } %>\r\n                <% }) %>\r\n              </div>\r\n            <% } else{ %>\r\n              <div class="ff-widget-control ff-check-table <%-item.wrap?\'ff-wrap-choices\':\'\'%>">\r\n              <% chs.forEach(function(ch, chi){ %>\r\n                <% if(ch.value){ %>\r\n                  <div class="ff-form-check">\r\n                    <input class="ff-form-check-input" type="radio" name="entry.<%-item.entry%>" id="entry.<%-item.entry%>.<%=ch.value%>" \r\n                      onclick="entr=<%-item.entry%>; if(formFacade.draft.entry[entr]==this.value){ delete formFacade.draft.entry[entr]; this.checked=false; formFacade.saveDraft(); }"\r\n                      <%-chsels.indexOf(ch.value)>=0?\'checked\':\'\'%> value="<%=ch.value%>" <%-item.required?\'required\':\'\'%>>\r\n                    <label class="ff-form-check-label" for="entry.<%-item.entry%>.<%=ch.value%>">\r\n                      <%-ch.value%><%-getScoreHint(chi)%>\r\n                    </label>\r\n                  </div>\r\n                <% } else{ %>\r\n                  <div onclick="document.getElementById(\'entry.<%-item.entry%>.other_option_response\').click()" class="ff-form-check ff-form-check-other ff-pointer-cursor">\r\n                    <input class="ff-form-check-input ff-pointer-disable" type="radio" <%=draft.entry[item.entry+\'-other_option_response\']?\'checked\':\'\'%>\r\n                        onclick="entr=<%-item.entry%>; if(formFacade.draft.entry[entr]==this.value){ delete formFacade.draft.entry[entr]; this.checked=false; formFacade.saveDraft(); }"\r\n                        name="entry.<%-item.entry%>" id="entry.<%-item.entry%>.other_option_response" value="__other_option__">\r\n                    <input class="<%-prepend(\'form-control\')%>" type="text" name="entry.<%-item.entry%>.other_option_response"\r\n                      value="<%=draft.entry[item.entry+\'-other_option_response\']%>" placeholder="<%=oitem.placeholder?oitem.placeholder:\'Other\'%>"\r\n                      oninput="document.getElementById(this.name).checked=true"/>\r\n                  </div>\r\n                <% } %>\r\n              <% }) %>\r\n              </div>\r\n            <% } %>\r\n          <% } else if(item.type==\'SCALE\'){ %>\r\n            \x3c!-- LINEAR SCALE --\x3e\r\n          <% var chs = filter(item.choices) %>\r\n          <% if (layout !== \'default\') { %>\r\n          \x3c!-- FOR 1COLUMN and 2COLUMN --\x3e\r\n          <div class="ff-linear-scale-container">\r\n            <div class="ff-linear-scale-inner-container">\r\n              <% if(isEditMode()) { %>\r\n                <div class="ff-widget-control ff-linear-scale-wrapper" style="margin: 0px;margin-bottom:-.75em; padding: 0px;padding-top: 10px;">\r\n                  <% chs.forEach(function(ch, chi){ %>\r\n                    <% if (getScoreHint(chi)){ %>\r\n                    <div class="ff-linear-scale-input-wrapper">\r\n                      <div class="ff-linear-scale-button ff-linear-scale-disabled <%=chi===0 ? \'ff-linear-scale-button-first\' : chi===chs.length - 1 ? \'ff-linear-scale-button-last\' : \'\'%>" style="border:transparent;"><%-getScoreHint(chi)%></div>\r\n                    </div>\r\n                    <% } %>\r\n                  <% }) %>\r\n                </div>\r\n              <% } %>\r\n              <div class="ff-widget-control ff-linear-scale-wrapper">\r\n              <% chs.forEach(function(ch, chi){ %>\r\n                <div class="ff-linear-scale-input-wrapper">\r\n                  <input class="ff-linear-scale-input" type="radio" name="entry.<%-item.entry%>" \r\n                  <%-item.required?\'required\':\'\'%> <%-itmval==ch.value?\'checked\':\'\'%> \r\n                  id="entry.<%-item.entry%>.<%=ch.value%>" value="<%=ch.value%>"/>\r\n                  <button \r\n                    type="button"\r\n                    id="entry.<%-item.entry%>.<%-ch.value%>.button"\r\n                    linear-<%-item.entry%>\r\n                    value="<%-ch.value%>"\r\n                    onclick="\r\n                      var entr=<%-item.entry%>;\r\n                      if(formFacade.draft.entry[entr]==this.value && <%-item.required ? false : true%>) {\r\n                        delete formFacade.draft.entry[entr];\r\n                        document.getElementById(\'entry.<%-item.entry%>.<%=ch.value%>\').checked = false;\r\n                        formFacade.saveDraft();\r\n                        document.querySelectorAll(\'[linear-<%-item.entry%>]\').forEach(function(el) { \r\n                          el.classList.remove(\'ff-linear-scale-button-active\');\r\n                          el.classList.remove(\'ff-linear-scale-button-partial-active\');\r\n                        });\r\n                        return;\r\n                      };\r\n                      document.querySelectorAll(\'[linear-<%-item.entry%>]\')\r\n                        .forEach(function(el) { \r\n                          if(el.id==\'entry.<%-item.entry%>.<%-ch.value%>.button\') {\r\n                            el.classList.add(\'ff-linear-scale-button-active\');\r\n                            el.classList.remove(\'ff-linear-scale-button-partial-active\');\r\n                            document.getElementById(\'entry.<%-item.entry%>.<%=ch.value%>\').click();\r\n                          }\r\n                          else if (Number(<%-ch.value%>)>Number(el.value)) {\r\n                            el.classList.remove(\'ff-linear-scale-button-active\');\r\n                            el.classList.add(\'ff-linear-scale-button-partial-active\');\r\n                          }\r\n                          else {\r\n                            el.classList.remove(\'ff-linear-scale-button-active\');\r\n                            el.classList.remove(\'ff-linear-scale-button-partial-active\');\r\n                          }\r\n                        });\r\n                    "\r\n                    data-active-scale="<%-ch.value === itmval ? \'active\' : \'\'%>"\r\n                    class="ff-linear-scale-button <%=chi===0 ? \'ff-linear-scale-button-first\' : chi===chs.length - 1 ? \'ff-linear-scale-button-last\' : \'\'%> <%-Number(itmval)==Number(ch.value)? \'ff-linear-scale-button-active\' : Number(itmval)>Number(ch.value) ? \'ff-linear-scale-button-partial-active\' : \'\'%>"\r\n                  >\r\n                    <%-ch.value%>\r\n                  </button>\r\n                </div>\r\n              <% }) %>\r\n              </div>\r\n              <% \r\n                let widthFor11Boxes = 150;\r\n                let widthForLabel = "min-content";\r\n                let widthForOneBox = widthFor11Boxes/11;\r\n                widthForLabel = widthForOneBox * chs.length + "px";\r\n              %>\r\n              <div class="ff-linear-scale-label-wrapper">\r\n                <div class="ff-linear-scale-label-text" style="text-align:<%-dir===\'rtl\'?\'right\':\'left\'%>; font-size:13px !important;width:<%-widthForLabel%>">\r\n                  <%-item.scaleMin?item.scaleMin:\'\'%>\r\n                </div>\r\n                <div class="ff-linear-scale-label-text" style="text-align:<%-dir!==\'rtl\'?\'right\':\'left\'%>; font-size:13px !important;width:<%-widthForLabel%>">\r\n                  <%-item.scaleMax?item.scaleMax:\'\'%>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <% } else { %>\r\n          \x3c!-- FOR DEFAULT --\x3e\r\n          <div style="overflow-x: auto;">\r\n            <table class="ff-widget-control <%-layout !== \'default\' ? \'ff-linear-scale-hidden\' : \'ff-linear-scale-default-container\'%>">\r\n              <col width="<%-Math.round(100/(chs.length+2))%>%">\r\n              <% chs.forEach(function(ch){ %>\r\n                <col width="<%-Math.round(100/(chs.length+2))%>%">\r\n              <% }) %>\r\n              <col width="*">\r\n              <tr>\r\n                <td></td>\r\n                <% chs.forEach(function(ch, chi){ %>\r\n                  <td class="text-center"><%-ch.value%><%-getScoreHint(chi)%></td>\r\n                <% }) %>\r\n                <td></td>\r\n              </tr>\r\n              <tr>\r\n                <td class="text-center ff-small-text">\r\n                  <%-item.scaleMin?item.scaleMin:\'\'%>\r\n                </td>\r\n                <% chs.forEach(function(ch){ %>\r\n                  <td class="text-center ff-pointer-cursor" onclick="let input = this.querySelector(\'input\');if(input) { input.click() }" >\r\n                    <input onclick="var entr=<%-item.entry%>;if(formFacade.draft.entry[entr] == <%=ch.value%> && <%-item.required ? false : true%>){delete formFacade.draft.entry[entr]; document.getElementById(\'entry.<%-item.entry%>.<%=ch.value%>\').checked = false;formFacade.saveDraft();}" class="ff-scale ff-pointer-disable" type="radio" name="entry.<%-item.entry%>" \r\n                      <%-item.required?\'required\':\'\'%> <%-itmval==ch.value?\'checked\':\'\'%> id="entry.<%-item.entry%>.<%=ch.value%>" value="<%=ch.value%>">\r\n                  </td>\r\n              <% }) %>\r\n              <td class="text-center ff-small-text">\r\n                <%-item.scaleMax?item.scaleMax:\'\'%>\r\n              </td>\r\n              </tr>\r\n            </table>\r\n          </div>\r\n          <% } %>\r\n          <% } else if(item.type==\'GRID\'){ %>\r\n            <% var chs = filter(item.choices) %>\r\n            <table class="ff-widget-control">\r\n              <col width="*">\r\n            <% chs.forEach(function(ch, chi){ %>\r\n              <col width="<%-Math.round(70/chs.length)%>%">\r\n            <% }) %>\r\n            <tr>\r\n            <td></td>\r\n            <% chs.forEach(function(ch, chi){ %>\r\n              <td class="text-center"><%-ch.value%><%-getScoreHint(chi)%></td>\r\n            <% }) %>\r\n            </tr>\r\n            <% item.rows.forEach(function(rw){ if(rw.multiple==1){ %>\r\n              <input type="hidden" name="entry.<%-rw.entry%>_sentinel"/>\r\n            <% } }) %>\r\n            <% \r\n              item.rows.forEach(function(rw, rwi){ \r\n                var rvals = draft.entry[rw.entry];\r\n                rvals = Array.isArray(rvals)?rvals:[rvals];\r\n            %>\r\n              <tr>\r\n              <td class="ff-grid-label"><%-rw.value%></td>\r\n              <% chs.forEach(function(ch, chi){ %>\r\n              <td class="text-center ff-pointer-cursor" onclick="let input = this.querySelector(\'input\');if(input) { input.click() }"><input class="ff-pointer-disable ff-grid-<%-rw.multiple==1?\'checkbox\':\'radio\'%> ff-grid-<%-item.entry%> ff-grid-<%-item.entry%>-row-<%-rwi%> ff-grid-<%-item.entry%>-col-<%-chi%> <%-item.onepercol?\'ff-grid-onepercol\':\'\'%>" type="<%-rw.multiple==1?\'checkbox\':\'radio\'%>" name="entry.<%-rw.entry%>" \r\n                    <%=rvals.indexOf(ch.value)>=0?\'checked\':\'\'%> id="entry.<%-rw.entry%>.<%=ch.value%>" value="<%=ch.value%>" \r\n                    <% if(!rw.multiple){ %>\r\n                    onclick="entr=<%-rw.entry%>; if(formFacade.draft.entry[entr]==this.value){ delete formFacade.draft.entry[entr]; this.checked=false; formFacade.saveDraft(); }"\r\n                    <% } %>\r\n                    <%-rw.multiple==0&&item.required?\'required\':\'\'%>\r\n                    ></td>\r\n              <% }) %>\r\n              </tr>\r\n            <% }) %>\r\n            </table>\r\n          <% } else if(item.type==\'IMAGE\'){ %>\r\n            <% \r\n              var imageSrc;\r\n              if(!item.blob && item.image)\r\n                imageSrc = `https://formfacade.com/itemload/item/${encode(item.image)}`;\r\n              else\r\n                imageSrc =  `https://formfacade.com/itemembed/${params.publishId}/item/${item.id}/image/${item.blob}`;\r\n            %>\r\n            <img\r\n            <% if(data.util && data.util.getPlaceholder){ %>\r\n              src="<%-data.util.getPlaceholder(item.size)%>" data-src="<%-imageSrc%>"\r\n            <% } else{ %>\r\n              src="<%-imageSrc%>" \r\n            <% } %>\r\n            alt="<%=itm.title?itm.title:(header.title?header.title:sec.title)%>"\r\n            <% if(item.size){ %>\r\n              style="width:<%-item.size.width%>px;\r\n              <% if(item.size.align){ %> \r\n                margin-left:<%-item.size.align==0?\'0px\':\'auto\'%>; margin-right:<%-item.size.align==2?\'0px\':\'auto\'%>;\r\n              <% } %>\r\n              max-width:100%; height:auto;"\r\n            <% } %>\r\n            class="lazyload ff-widget-control ff-full-image ff-image" id="Widget<%-item.id%>"/>\r\n          <% } else if(item.type==\'VIDEO\'){ %>\r\n            <div class="ff-widget-control ff-embed-responsive">\r\n              <iframe class="ff-embed-responsive-item ff-video" allowfullscreen\r\n                src="https://formfacade.com/itemembed/<%-params.publishId%>/item/<%-item.id%>/video/<%-item.blob?item.blob:\'unknown\'%>"></iframe>\r\n            </div>\r\n          <% } else if(item.type==\'DATE\'){ %>\r\n            <% \r\n              var dates = getMinMaxDate(item, oitem);\r\n              var minDate = dates[0];\r\n              var maxDate = dates[1];\r\n            %>\r\n            <% if(item.time==1){ %>\r\n              <input type="datetime-local" class="ff-widget-control <%-prepend(\'form-control\')%>" id="Widget<%-item.id%>" \r\n                name="entry.<%-item.entry%>" <%-item.required?\'required\':\'\'%> value="<%=itmval%>"\r\n                onBlur="if(event.target.value) event.target.value=event.target.value.substr(0, 16)"\r\n                placeholder="yyyy-mm-ddTHH:mm" pattern="[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}" min="<%-minDate%>" max="<%-maxDate%>">\r\n            <% } else{ %>\r\n              <input type="date" class="ff-widget-control <%-prepend(\'form-control\')%>" id="Widget<%-item.id%>" \r\n                name="entry.<%-item.entry%>" <%-item.required?\'required\':\'\'%> value="<%=itmval%>"\r\n                placeholder="yyyy-mm-dd" pattern="[0-9]{4}-[0-9]{2}-[0-9]{2}" min="<%-minDate%>" max="<%-maxDate%>">\r\n            <% }  %>\r\n          <% } else if(item.type==\'TIME\'){ %>\r\n            <input type="time" class="ff-widget-control <%-prepend(\'form-control\')%>" id="Widget<%-item.id%>" \r\n              name="entry.<%-item.entry%>" <%-item.required?\'required\':\'\'%> value="<%=itmval%>">\r\n          <% } else if(item.type==\'SECTION_HEADER\'){ %>\r\n          <% } else { %>\r\n            <input type="text" class="ff-widget-control <%-prepend(\'form-control\')%>" id="Widget<%-item.id%>" \r\n              name="entry.<%-item.entry%>" <%-item.required?\'required\':\'\'%> value="<%=itmval%>">\r\n          <% } %>\r\n          <% \r\n            if(item.product){ \r\n              var cartsm;\r\n              if(item.type==\'GRID\')\r\n              {\r\n                var rws = item.rows?item.rows:[];\r\n                var rwvals = rws.map(function(rw, rwi){\r\n                    var rwval = draft.entry[rw.entry];\r\n                    if(!rwval) return;\r\n                    if(Array.isArray(rwval))\r\n                      return rw.value+\' : \'+rwval.join(\', \');\r\n                    else if(isNaN(rwval))\r\n                      return rw.value+\' : \'+rwval;\r\n                    else\r\n                      return rw.value+\' x <b>\'+rwval+\'</b>\';\r\n                }).filter(rwval=>rwval);\r\n                if(rwvals.length>0)\r\n                  cartsm = rwvals.map(ln=>\'<div class="ff-sm-line">\'+ln+\'</div>\').join(\'\\n\');\r\n              }\r\n              else if(itmval && item.type==\'PARAGRAPH_TEXT\')\r\n              {\r\n                var rws = [];\r\n                var cfg = toConfigurable(itmval);\r\n                cfg.configItem.forEach(ci=>{\r\n                  for(var vid in ci.lineItem)\r\n                  {\r\n                    var qty = ci.lineItem[vid]||1;\r\n                    var vrns = oitem.variants||{};\r\n                    var vrn = vrns[vid]||{};\r\n                    var vrnm = vrn.name||vid;\r\n                    rws.push(vrnm+\' x <b>\'+qty+\'</b>\');\r\n                  }\r\n                });\r\n                if(rws.length>0)\r\n                  cartsm = rws.map(ln=>\'<div class="ff-sm-line">\'+ln+\'</div>\').join(\'\\n\');\r\n              }\r\n              else if(itmval)\r\n              {\r\n                if(Array.isArray(itmval))\r\n                {\r\n                  cartsm = itmval.filter(vl=>vl).join(\' | \');\r\n                }\r\n                else if(isNaN(itmval))\r\n                {\r\n                  cartsm = itmval;\r\n                }\r\n                else\r\n                {\r\n                  var frmtval = oitem&&oitem.measure==\'Weight\'?formatWeight(itmval):itmval;\r\n                  cartsm = \'x <b>\'+frmtval+\'</b>\';\r\n                }\r\n              }\r\n          %>\r\n            <% if(cartsm){ %>\r\n              <div <%-oncartClick%> class="ff-add-cart">\r\n                \x3c!-- Shopping cart SVG --\x3e\r\n                <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="M440-600v-120H320v-80h120v-120h80v120h120v80H520v120h-80ZM280-80q-33 0-56.5-23.5T200-160q0-33 23.5-56.5T280-240q33 0 56.5 23.5T360-160q0 33-23.5 56.5T280-80Zm400 0q-33 0-56.5-23.5T600-160q0-33 23.5-56.5T680-240q33 0 56.5 23.5T760-160q0 33-23.5 56.5T680-80ZM280-280q-45 0-69-39.5t-1-78.5l54-98-144-304H40v-80h131l170 360h281l155-280 70 38-155 280q-11 20-29 31t-41 11H324l-44 80h480v80H280Z"/></svg>\r\n              </div>\r\n              <div <%-oncartClick%>  class="ff-sel-cart">\r\n                <div class="ff-sel-cart-sm"><%-cartsm%></div>\r\n              </div>\r\n            <% } else if(oitem.inventory==\'yes\' && oitem.remain<=0){ %>\r\n              <div <%-oncartClick%> class="ff-add-cart">\r\n                \x3c!-- Shopping cart SVG --\x3e\r\n                <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="M440-600v-120H320v-80h120v-120h80v120h120v80H520v120h-80ZM280-80q-33 0-56.5-23.5T200-160q0-33 23.5-56.5T280-240q33 0 56.5 23.5T360-160q0 33-23.5 56.5T280-80Zm400 0q-33 0-56.5-23.5T600-160q0-33 23.5-56.5T680-240q33 0 56.5 23.5T760-160q0 33-23.5 56.5T680-80ZM280-280q-45 0-69-39.5t-1-78.5l54-98-144-304H40v-80h131l170 360h281l155-280 70 38-155 280q-11 20-29 31t-41 11H324l-44 80h480v80H280Z"/></svg>\r\n              </div>\r\n              <div <%-oncartClick%> class="ff-sel-cart">\r\n                <div class="ff-sel-cart-sm"><%-lang(\'Out of stock\')%></div>\r\n              </div>\r\n            <% } else{ %>\r\n              <div <%-oncartClick%> class="ff-add-cart">\r\n                \x3c!-- Shopping cart SVG --\x3e\r\n                <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="M440-600v-120H320v-80h120v-120h80v120h120v80H520v120h-80ZM280-80q-33 0-56.5-23.5T200-160q0-33 23.5-56.5T280-240q33 0 56.5 23.5T360-160q0 33-23.5 56.5T280-80Zm400 0q-33 0-56.5-23.5T600-160q0-33 23.5-56.5T680-240q33 0 56.5 23.5T760-160q0 33-23.5 56.5T680-80ZM280-280q-45 0-69-39.5t-1-78.5l54-98-144-304H40v-80h131l170 360h281l155-280 70 38-155 280q-11 20-29 31t-41 11H324l-44 80h480v80H280Z"/></svg>\r\n              </div>\r\n            <% } %>\r\n            <%\r\n              if(layout==\'default\' && item.type==\'PARAGRAPH_TEXT\'){\r\n                var cfg = toConfigurable(itmval).configItem[0];\r\n                var multisel = oitem.multiselect==\'yes\';\r\n                var vrns = oitem.variants||{};\r\n                var ochs = oitem.choices||[];\r\n                if(ochs.length==1){\r\n                  var isradio = !multisel&&Object.keys(vrns).length>1;\r\n            %>\r\n                <div class="ff-widget-control ff-check-table">\r\n                <%\r\n                  var och = ochs[0];\r\n                  for(var vid in vrns){ \r\n                    var ovrn = vrns[vid]||{};\r\n                    var vsel = cfg.lineItem[vid];\r\n                %>\r\n                  <div class="ff-form-check">\r\n                    <input class="ff-form-check-input" type="<%-isradio?\'radio\':\'checkbox\'%>" name="variant.<%-item.entry%>" id="variant.<%-item.entry%>.<%-vid%>" \r\n                      <% if(isradio){ %>\r\n                      onclick="var cfg = formFacade.toConfigurable(document.getElementById(\'Widget<%-item.id%>\').value); if(cfg.configItem[0].lineItem[<%-vid%>]){ this.checked=false; formFacade.saveDraft(event); }"\r\n                      <% }%>\r\n                      <%-vsel?\'checked\':\'\'%> value="<%=ovrn.name%> | <%-vid%> * <%-och%>">\r\n                    <label class="ff-form-check-label" for="variant.<%-item.entry%>.<%-vid%>">\r\n                      <%-ovrn.display||ovrn.name%>\r\n                    </label>\r\n                  </div>\r\n                <% } %>\r\n                </div>\r\n            <% \r\n                }\r\n                else\r\n                {\r\n            %>\r\n                <table class="ff-widget-control">\r\n                  <col width="*">\r\n                <% ochs.forEach(function(ch){ %>\r\n                  <col width="<%-Math.round(70/ochs.length)%>%">\r\n                <% }) %>\r\n                <tr>\r\n                <td></td>\r\n                <% ochs.forEach(function(ch){ %>\r\n                  <td class="text-center"><%-ch%></td>\r\n                <% }) %>\r\n                </tr>\r\n                <% \r\n                  for(var vid in vrns){ \r\n                    var ovrn = vrns[vid]||{};\r\n                    var vsel = cfg.lineItem[vid];\r\n                %>\r\n                  <tr>\r\n                  <td class="ff-grid-label"><%-ovrn.display||ovrn.name%></td>\r\n                  <% ochs.forEach(function(ch, chi){ %>\r\n                  <td class="text-center ff-pointer-cursor" onclick="let input = this.querySelector(\'input\');if(input) { input.click() }"><input class="ff-pointer-disable ff-grid-<%-multisel?\'checkbox\':\'radio\'%> ff-grid-<%-item.entry%> ff-grid-<%-item.entry%>-row-<%-vid%> ff-grid-<%-item.entry%>-col-<%-chi%>" type="radio" name="variant.<%-item.entry%><%-multisel?(\'.\'+vid):\'\'%>"\r\n                      onclick="var cfg = formFacade.toConfigurable(document.getElementById(\'Widget<%-item.id%>\').value); if(cfg.configItem[0].lineItem[<%-vid%>]==\'<%-ch%>\'){ this.checked=false; formFacade.saveDraft(event); }" \r\n                        <%=vsel==ch?\'checked\':\'\'%> id="entry.<%-vid%>.<%=ch%>" value="<%=ovrn.name%> | <%=vid%> * <%=ch%>" \r\n                        ></td>\r\n                  <% }) %>\r\n                  </tr>\r\n                <% } %>\r\n                </table>\r\n            <% \r\n                }\r\n              } \r\n            %>\r\n          <% } %>\r\n          <div id="Error<%-item.id%>" class="ff-widget-error"></div>\r\n        </div>\r\n      <% }) %>\r\n      <% \r\n        if(isEditMode() && hasCreatorOrEditor() && !header.outstock){ \r\n          var aftr;\r\n          if(header.items.length==0)\r\n            aftr = header.head?header.head.id:sec.id;\r\n          else\r\n            aftr = item?item.id:\'root\';\r\n          var hdprds = header.items.filter(itm=>itm.product);\r\n          var isprd = hdprds.length>=(header.items.length-hdprds.length);\r\n          var productNoun = fac.product ? fac.product.type : \'product\';\r\n          if(hdprds.length==0 && (s==0||s+1==sections.length)) isprd = false;\r\n          var hdamt = header.items.filter(itm=>itm.id==(fac.mapping||{}).amount);\r\n      %>\r\n          <div class="ff-create" id="ff-append-<%-aftr%>">\r\n            <div class="btn-group">\r\n              <% if(isprd && hasCreator()) { %>\r\n                <button type="button" class="btn ff-next" onclick="editFacade.afterLoad(\'createProduct\', {insertAfter:\'<%-aftr%>\', type:\'product\'})">Add product</button>\r\n              <% } else if(hdamt.length>0 && hasCreator()) { %>\r\n                <button type="button" class="btn ff-next" onclick="editFacade.afterLoad(\'createPrice\', null, {insertAfter:\'<%-aftr%>\', type:\'service\'})">Add price field</button>\r\n              <% } else { %>\r\n                <button type="button" class="btn ff-next" onclick="editFacade.afterLoad(\'create\', null, {insertAfter:\'<%-aftr%>\', type:\'field\'})">Add field</button>\r\n              <% } %>\r\n              <button type="button" class="btn ff-next dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\r\n                <span class="sr-only">Toggle Dropdown</span>\r\n              </button>\r\n              <div class="dropdown-menu">\r\n                <% if(hasCreator()){ %>\r\n                  <a class="dropdown-item" href="javascript:void(0)" onclick="editFacade.afterLoad(\'createProduct\', {insertAfter:\'<%-aftr%>\', type:\'product\'})">Add product</a>\r\n                  <a class="dropdown-item" href="javascript:void(0)" onclick="editFacade.afterLoad(\'createPrice\', null, {insertAfter:\'<%-aftr%>\', type:\'service\'})">Add price field</a>\r\n                <% } %>\r\n                <a class="dropdown-item" href="javascript:void(0)" onclick="editFacade.afterLoad(\'create\', null, {insertAfter:\'<%-aftr%>\', type:\'field\'})">Add field</a>\r\n                <a class="dropdown-item" href="javascript:void(0)" onclick="editFacade.afterLoad(\'confirmCreate\', null, {insertAfter:\'<%-aftr%>\', type:\'field\', widget:\'SectionHeaderItem\'})">Add header</a>\r\n              </div>\r\n            </div>\r\n          </div>\r\n      <% } %>\r\n    <% }) %>\r\n    </div>\r\n\r\n    <div class="ff-button-bar">\r\n    <% if(s>=1){ %>\r\n      <button type="button" class="<%-backcss%> ff-back" id="ff-back-<%-sec.id%>"\r\n        onclick="formFacade.gotoSection(this.form, \'<%-sec.id%>\', \'back\')">\r\n        \x3c!-- arrow back SVG --\x3e\r\n        <% if(dir === \'ltr\') { %>\r\n        <span class="material-icons">arrow_back</span>\r\n        <% } else { %>\r\n        <span class="material-icons">arrow_forward</span>\r\n        <% } %>\r\n        <span><%-lang(\'Back\')%></span>\r\n      </button>\r\n    <% } %>\r\n    <% \r\n      if(frm.errorMessage){\r\n      } else if(s+1==sections.length || sec.next==-3){ \r\n        data.ending = sec.id;\r\n        var waphone = getPhone(sec.id);\r\n        var itmsubmit = fac.submit?fac.submit[sec.id]:null;\r\n        var onclick = \'formFacade.submit(this.form, \\\'\'+sec.id+\'\\\')\';\r\n        if(isEditMode() && s>=1)\r\n          onclick = \'formFacade.launchPreview()\';\r\n        else if(itmsubmit && itmsubmit.payConfig==\'peergateway\' && !draft.responseId && !draft.submitSeq)\r\n          onclick = \'formFacade.showPayment(this.form, \\\'\'+sec.id+\'\\\')\';\r\n        else if(itmsubmit && itmsubmit.amountFrom && !draft.responseId && !draft.submitSeq)\r\n          onclick = \'formFacade.showPayment(this.form, \\\'\'+sec.id+\'\\\')\';\r\n      %>\r\n        <button type="button" class="<%-submitcss%> ff-submit" id="ff-submit-<%-sec.id%>" onclick="<%-onclick%>">\r\n          <% var rtlsubmitStyle = ""; %>\r\n          <% if(dir === \'rtl\') { %>\r\n          <% \r\n            rtlsubmitStyle = "-webkit-transform: scaleX(-1);transform: scaleX(-1);";\r\n          %>\r\n          <% } %>\r\n          <% if(waphone){ %>\r\n            <img alt="Submit" src="https://formfacade.com/img/wa.svg" class="ff-submit-icon"/>\r\n          <% } else { %>\r\n            <img alt="Submit" style="<%=rtlsubmitStyle%>" src="https://formfacade.com/img/send.svg" class="ff-submit-icon"/>\r\n          <% } %>\r\n          <span>\r\n            <%-itmsubmit&&itmsubmit.displayName?itmsubmit.displayName:lang(waphone?\'Send message\':\'Submit\')%>\r\n          </span>\r\n        </button>\r\n      <% if(isEditMode()){ %>\r\n        <i class="ff-customize material-icons" onclick="editFacade.afterLoad(\'confirmSubmit\', \'<%-sec.id%>\')">settings</i>\r\n      <% } %>\r\n    <% } else { %>\r\n        <button type="button" class="<%-submitcss%> ff-next" id="ff-next-<%-sec.id%>"\r\n          onclick="formFacade.gotoSection(this.form, \'<%-sec.id%>\', \'<%-sec.next%>\')">\r\n          <% \r\n            var nxtsec = sec.next==-2?sections[s+1]:null;\r\n            if(nxtsec && nxtsec.id==fac.setting.loginpage){ \r\n          %>\r\n            <span class="material-icons">lock</span>\r\n            <span><%-lang(\'Next\')%></span>\r\n          <% } else{ %>\r\n            <span><%-lang(\'Next\')%></span>\r\n            \x3c!-- arrow forward SVG --\x3e\r\n            <% if(dir === \'ltr\') { %>\r\n              <span class="material-icons">arrow_forward</span>\r\n            <% } else { %>\r\n              <span class="material-icons">arrow_back</span>\r\n            <% } %>\r\n          <% } %>\r\n        </button>\r\n        <% if(isEditMode() && hasCreatorOrEditor()){ %>\r\n          <i class="ff-customize material-icons" onclick="editFacade.afterLoad(\'showNext\', \'<%-sec.id%>\')">settings</i>\r\n        <% } %>\r\n    <% } %>\r\n\r\n    <% \r\n      var inlinecss = {display:\'inline-block\', position:\'relative\', opacity:1, visibility:\'visible\',\r\n        \'font-size\':\'13px\', \'font-weight\':600, \'line-height\':\'22px\', \'letter-spacing\':\'.8px\', \'text-indent\':\'0em\', \'z-index\':1};\r\n      var inlinestyle = Object.keys(inlinecss).map(function(ky){ return ky+\':\'+inlinecss[ky]+\' !important\'; }).join(\'; \');\r\n    %>\r\n    <% if(!params.userId){ %>\r\n      <a href="https://formfacade.com/verify-google-forms-ownership.html" target="_blank"\r\n      class="ff-powered" style="color:#0074D9 !important; <%-inlinestyle%>">\r\n        Ownership not verified\r\n      </a>\r\n    <% } else if(isEditMode()){ %>\r\n      <% if(hasCreator() && (fac.neartail || fac.whatsapp)){ %>\r\n          <span class="material-icons ff-jump-nav" onclick="formFacade.showNavigation()">apps</span>\r\n      <% } %>\r\n    <% } else{ %>\r\n      <% \r\n        if(!config.plan || config.branded){ \r\n          var prd = (fac.formesign||fac.hipaache)?\'Formesign\':(fac.neartail||fac.whatsapp)?\'Neartail\':\'Formfacade\';\r\n      %>\r\n        <% if(!config.plan && prd==\'Formfacade\' && config.installAt<1702767600000 && config.usage>=100 && config.trial>7){ %>\r\n          <a href="<%-reurl%>&utm_content=oldlimit" \r\n            <% if(config.usage>=120){ %>\r\n              class="ff-blocked" style="color:#fff !important; <%-inlinestyle%>"\r\n            <% } else{ %>\r\n              class="ff-warned" style="color:#000 !important; border:1px solid #f5c6cb !important; <%-inlinestyle%>"\r\n            <% } %>\r\n            target="_blank">\r\n            <b>âš </b> Form responses limit reached. Upgrade now.\r\n          </a>\r\n        <% } else if(!config.plan && config.usage>=20 && config.trial>7){ %>\r\n          <a href="<%-reurl%>&utm_content=limit"\r\n            <% if(config.usage>=30){ %>\r\n              class="ff-blocked" style="color:#fff !important; <%-inlinestyle%>"\r\n            <% } else{ %>\r\n              class="ff-warned" style="color:#000 !important; border:1px solid #f5c6cb !important; <%-inlinestyle%>"\r\n            <% } %>\r\n            target="_blank">\r\n            <b>âš </b> Form responses limit reached. Upgrade now.\r\n          </a>\r\n        <% } else{ %>\r\n          <a href="<%-reurl%>&utm_content=logo" target="_blank" \r\n            class="ff-powered-img" style="display:inline-block !important; position: relative !important;height: auto; "\r\n            title="<%-config.plan?(\'Powered by \'+prd):\'Try it for Free\'%>">\r\n            <% if(fac.hipaache){ %>\r\n              <img style="display:block !important; height: 3.2em !important; position: relative !important;" src="https://formfacade.com/logo/madewith/formesign.svg" alt="Made with formesign" loading="lazy"/>\r\n            <% } else if(fac.neartail||fac.whatsapp){ %>\r\n              <img style="display:block !important; height: 3.2em !important; position: relative !important;" src="https://formfacade.com/logo/madewith/neartail.svg" alt="Made with neartail" loading="lazy"/>\r\n            <% } else{ %>\r\n              <img style="display:block !important; height: 3.2em !important; position: relative !important;" src="https://formfacade.com/logo/madewith/formfacade.svg" alt="Made with formfacade" loading="lazy"/>\r\n            <% } %>\r\n          </a>\r\n        <% } %>\r\n      <% } else if(config.plan==\'paid\'){ %>\r\n        <%\r\n          var nxtsec;\r\n          var ctgs = sections.map(function(ctgsec,c){\r\n            if(ctgsec.id==sec.id) nxtsec = sections[c+1];\r\n            var itmnext = fac.next?fac.next[ctgsec.id]:null;\r\n            if(!itmnext) itmnext = fac.submit?fac.submit[ctgsec.id]:null;\r\n            if(itmnext && itmnext.navigation==\'added\')\r\n              return ctgsec;\r\n          }).filter(ctgsec=>ctgsec);\r\n        %>\r\n        <% if(hasCreator() && ctgs.length>1 && itmnxt && itmnxt.navigation==\'added\'){ %>\r\n          <span class="material-icons ff-jump-nav" onclick="formFacade.showNavigation()">apps</span>\r\n        <% } %>\r\n      <% } else if(config.plan==\'warned\'){ %>\r\n        <a href="<%-reurl%>&utm_content=warned" target="_blank" \r\n          class="ff-warned" style="color:#000 !important; border:1px solid #f5c6cb !important; <%-inlinestyle%>">\r\n          <b>âš¡</b> Form responses limit reaching soon\r\n        </a>\r\n      <% } else if(config.plan==\'blocked\'){ %>\r\n        <a href="<%-reurl%>&utm_content=blocked" target="_blank" \r\n          class="ff-blocked" style="color:#fff !important; <%-inlinestyle%>">\r\n          <b>âš </b> Form responses limit reached. Upgrade now.\r\n        </a>\r\n      <% } %>\r\n    <% } %>\r\n    </div>\r\n    </div>\r\n\r\n    <% if(isEditMode() && hasCreatorOrEditor()){ %>\r\n      <div class="ff-add-page">\r\n        <button class="btn btn-lg ff-back" onclick="editFacade.afterLoad(\'confirmCreate\', null, {insertAfter:\'<%-item?item.id:\'root\'%>\', type:\'field\', widget:\'PageBreakItem\'})" title="Insert new page">\r\n          <span class="material-icons">\r\n            add_circle_outline\r\n          </span>\r\n          Add page\r\n        </button>\r\n      </div>\r\n    <% } %>\r\n\r\n    <% }) %>\r\n\r\n    <% \r\n      var waphone = getPhone();\r\n      var firstsec = sections[0]||{};\r\n    %>\r\n    <div class="ff-section" id="ff-sec-ending" style="<%-draft.activePage==\'ending\'?\'display:block\':\'display:none\'%>">\r\n    <div class="ff-secfields">\r\n      <h3 class="ff-title"><%-html(firstsec.title||frm.title)%></h3>\r\n      <p style="padding-bottom:80px;">Click <%-lang(waphone?\'Send message\':\'Submit\')%> to finish.</p>\r\n    </div>\r\n    <div class="ff-button-bar">\r\n      <button type="button" class="<%-backcss%> ff-back" \r\n        onclick="formFacade.gotoSection(this.form, \'<%-data.ending%>\', \'back\')">\r\n        \x3c!-- arrow back SVG --\x3e\r\n        <% if(dir === \'ltr\') { %>\r\n          <span class="material-icons">arrow_back</span>\r\n        <% } else { %>\r\n          <span class="material-icons">arrow_forward</span>\r\n        <% } %>\r\n        <span><%-lang(\'Back\')%></span>\r\n      </button>\r\n      <button type="button" class="<%-submitcss%> ff-submit"\r\n        onclick="formFacade.submit(this.form, \'-3\')">\r\n        \x3c!-- send SVG --\x3e\r\n        <svg xmlns="http://www.w3.org/2000/svg" height="19" viewBox="0 -960 960 960" width="19" role="img" aria-label="Submit"><path d="M120-160v-640l760 320-760 320Zm80-120 474-200-474-200v140l240 60-240 60v140Zm0 0v-400 400Z"/></svg>\r\n        <span><%-lang(waphone?\'Send message\':\'Submit\')%></span>\r\n      </button>\r\n    </div>\r\n    </div>\r\n\r\n  </form>\r\n<% } %>\r\n\r\n<%\r\n  var paybtns = getPaymentButtons();\r\n  paybtns.forEach(paybtn=>{\r\n    var itm = frmitms[paybtn.amountFrom]||{};\r\n    var amt = draft.entry[itm.entry]||0;\r\n    var txtamt = itm.format?itm.format(amt):amt;\r\n%>\r\n  <div id="ff-payment-list-<%-paybtn.id%>" class="ff-payment-form ff-form ff-layout-<%-layout%>"\r\n    style="<%-draft.activePage==(paybtn.id+\'-paylist\')?\'display:block\':\'display:none\'%>">\r\n    <div class="ff-section">\r\n      <div class="ff-title">\r\n        <%-lang(\'Pay using\')%>\r\n      </div>\r\n      <div><%-txtamt%></div>\r\n      <div class="ff-paylist">\r\n      <% if(paymentIntent){ %>\r\n        <% paymentIntent.payment_method_types.forEach((typ,t)=>{ %>\r\n          <div class="ff-payoption" onclick="formFacade.showPaymentMethod(<%-t%>, \'<%-paybtn.id%>\')">\r\n            <div class="ff-paylogo"><img src="/img/payment/<%-typ.logo?typ.logo:\'money.png\'%>"/></div>\r\n            <div class="ff-payname"><%-typ.name%></div>\r\n            <div class="material-icons">delete</div>\r\n          </div>\r\n        <% }) %>\r\n      <% } %>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <form id="ff-payment-form-<%-paybtn.id%>" class="ff-payment-form ff-form ff-layout-<%-layout%>"\r\n    style="<%-draft.activePage==(paybtn.id+\'-pay\')?\'display:block\':\'display:none\'%>">\r\n    <div class="ff-section">\r\n      <div class="ff-title">\r\n        <%-lang(\'Secure checkout\')%>\r\n        <span style="float:right;"><%-txtamt%></span>\r\n      </div>\r\n      <div id="ff-card-element-<%-paybtn.id%>" class="<%-prepend(\'form-control\')%>" style="padding:12px; height:48px;">\r\n        Loading...\r\n      </div>\r\n      <label for="ff-card-element-<%-paybtn.id%>" style="padding-top:12px; padding-bottom:4px;">\r\n        All transactions are safe and secure. \r\n        Credit card details are not stored.\r\n      </label>\r\n      <div id="ff-card-errors-<%-paybtn.id%>" role="alert" style="color:red; padding-bottom:4px;"></div>\r\n      <button type="submit" class="<%-submitcss%> ff-submit" id="ff-pay-<%-paybtn.id%>" onclick="">\r\n        \x3c!-- send SVG --\x3e\r\n        <svg xmlns="http://www.w3.org/2000/svg" height="19" viewBox="0 -960 960 960" width="19" role="img" aria-label="Paynow"><path d="M120-160v-640l760 320-760 320Zm80-120 474-200-474-200v140l240 60-240 60v140Zm0 0v-400 400Z"/></svg>\r\n        <span><%-lang(\'Pay Now\')%></span>\r\n      </button>\r\n    </div>\r\n  </form>\r\n  <div id="ff-payment-confirm-<%-paybtn.id%>" class="ff-payment-form ff-form ff-layout-<%-layout%>"\r\n    style="<%-draft.activePage==(paybtn.id+\'-payconfirm\')?\'display:block\':\'display:none\'%>">\r\n    <div class="ff-section">\r\n      <div class="ff-title">\r\n        <%-lang(\'Payment successful\')%>\r\n      </div>\r\n      <div><%-lang(\'Placing your order...\')%></div>\r\n    </div>\r\n  </div>\r\n<% }) %>\r\n\r\n<div id="ff-addprd-overlay" onclick="formFacade.closePopup()"></div>\r\n<div id="ff-addprd-popup" dir="<%=dir%>"></div>\r\n',summary:"<%\r\n\tvar form = data.scraped;\r\n%>*<%-form.title?form.title:form.form%> #<%-formFacade.draft.submitSeq%>*\r\n<%\r\n\tvar vals = {};\r\n\tif(formFacade.draft && formFacade.draft.entry)\r\n\t\tvals = formFacade.draft.entry;\r\n\tvar items = Object.values(form.items).sort((a,b)=>a.index-b.index);\r\n    var oitems = data.facade&&data.facade.items?data.facade.items:{};\r\n\titems.forEach(item=>{\r\n\t\tvar oitem = oitems[item.id];\r\n\t\tif(!oitem) oitem = {};\r\n\t\tvar val = vals[item.entry];\r\n        if(val && val.length==0) val = null;\r\n        if(item.type=='GRID')\r\n        {\r\n                item.rows.forEach(function(rw, r){\r\n                \tvar rvals = vals[rw.entry];\r\n                    if(rvals)\r\n                    {\r\n\t\t\t\t\t\trvals = Array.isArray(rvals)?rvals:[rvals];\r\n%>\r\n*<%-rw.value%> :* <%-rvals.join(', ')%><%\r\n                    }\r\n                });\r\n        }\r\n\t\telse if(item.title && val)\r\n\t\t{\r\n\t\t\tif(oitem.mode=='hide'){}\r\n\t\t\telse if(oitem.calculated && oitem.calculated.indexOf('${textsummary')==0){}\r\n\t\t\telse{\r\n\t\t\t\tif(Array.isArray(val) || val=='__other_option__')\r\n\t\t\t\t{\r\n\t\t\t\t\tval = Array.isArray(val)?val:[val];\r\n\t\t\t\t\tval = val.map(function(vl){\r\n\t\t\t\t\t\tif(vl=='__other_option__')\r\n\t\t\t\t\t\t\tvl = vals[item.entry+'-other_option_response'];\r\n\t\t\t\t\t\treturn vl;\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\telse if(item.format)\r\n\t\t\t\t{\r\n\t\t\t\t\tval = item.format(val);\r\n\t\t\t\t}\r\n%>\r\n*<%-item.title%> :* <%-Array.isArray(val)?val.join(', '):val%><% \r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n%>\r\n<% if(!config.plan){ %>-\r\nMade with WhatsTarget.com\r\n-<% } %>\r\n(Press send to confirm)",preview:'<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Rubik:300,400,500,600,700,800"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,600,700,800"><style>\n\t\t\t#ff-formpage-body {\n\t\t\t\tbackground-color: #ffffff !important;\n\t\t\t}\n\t\t\n \t:root {\n\t\t--ff-fs: 16px;\n\t\t--ff-scale:1;\n\t\t--ff-primary-color: #7373ba;\n\t\t--ff-primary-light: rgb(115, 115, 186, 0.4);\n\t\t--ff-bgcolor: #ffffff;\n\t\t--popup-bgcolor: #ffffff;\n\t\t--popup-fontcolor: #202124;\n\t\t--popup-bordercolor: rgb(0 0 0 / 12%);\n\t\t--ff-formbgcolor: #ffffff;\n\t\t--ff-font-color: #202124;\n\t\t--ff-gray-900: #202124;\n\t\t--ff-gray-400: rgb(0 0 0 / 15%);\n\t\t--ff-font-size: var(--ff-font-size-1);\n\t\t--ff-head-size: var(--ff-font-size-5);\n\t\t--ff-font-small: var(--ff-font-size-0);\n\t\t--ff-field-bgcolor: transparent !important;\n\t\t--ff-field-border: rgb(0 0 0 / 12%) !important;\n\t\t--ff-heading-font: Rubik !important;\n\t\t--ff-paragraph-font: Roboto !important;\n\t\t--ff-gray-200: rgb(0 0 0 / 12%) !important;\n\t\t--ff-placeholder: #333333  !important;\n\t\t--ff-primary-950: hsl(240, 34%, 30%) !important;\n\t\t--ff-primary-50: hsl(240, 75%, 80%) !important;\n\t\t--popup-bordercolor: rgb(0 0 0 / 12%) !important;\n\t\t--ff-primary-700: #6a6aac !important;\n\t}\n\t\t.ff-form, .ff-form div, .ff-form p, #ff-addprd-popup {\n\t\t\tfont-size: var(--ff-fs);\n\t\t}\n\t\t.ff-public-mode .ff-editsection, .ff-public-mode .ff-edittheme, .ff-public-mode .ff-editwidget { \n\t\t\tdisplay:none !important; \n\t\t}\n\t</style>\r\n\r\n\r\n\r\n\r\n  <form dir="ltr" id="Publish1FAIpQLSd1ADWEf0M5RYxQqZFYZcTiGBA4H0b7TmxGfA7k_MmIjIbFzw" \r\n  class="ff-form ff-layout-default ff-public-mode ff-text-left" method="POST" \r\n  action="https://docs.google.com/forms/u/1/d/e/1FAIpQLSd1ADWEf0M5RYxQqZFYZcTiGBA4H0b7TmxGfA7k_MmIjIbFzw/formResponse">\r\n    <input type="hidden" name="id" value="1FAIpQLSd1ADWEf0M5RYxQqZFYZcTiGBA4H0b7TmxGfA7k_MmIjIbFzw">\r\n    <input type="hidden" name="pageHistory" value="">\r\n    \r\n    \r\n    \r\n    <input type="hidden" id="Payment1FAIpQLSd1ADWEf0M5RYxQqZFYZcTiGBA4H0b7TmxGfA7k_MmIjIbFzw" name="paymentId" value="">\r\n    <input type="hidden" id="PaymentData1FAIpQLSd1ADWEf0M5RYxQqZFYZcTiGBA4H0b7TmxGfA7k_MmIjIbFzw" name="paymentData" value="">\r\n    <input type="hidden" id="Accepted1FAIpQLSd1ADWEf0M5RYxQqZFYZcTiGBA4H0b7TmxGfA7k_MmIjIbFzw" name="accepted" value="">\r\n    <input type="hidden" id="AcceptedAt1FAIpQLSd1ADWEf0M5RYxQqZFYZcTiGBA4H0b7TmxGfA7k_MmIjIbFzw" name="acceptedAt" value="">\r\n    \r\n    \r\n    <div class="ff-section" id="ff-sec-root" \r\n      style="display:block;">\r\n      \r\n      \r\n      <h3 class="ff-title" id="ff-title-root">\r\n        Book A Free Counselling Session\r\n        \r\n      </h3>\r\n      \r\n    <div class="ff-secfields">\r\n    \r\n    \r\n      \r\n      \r\n        <div class="rest-form-group ff-item   ff-text ff-part-width  ff-item-noprd" id="ff-id-1425767448" >\r\n          \r\n            <label  class="ff-item-qs " for="Widget1425767448">\r\n                \r\n                  Full Name\r\n                \r\n                <span class="ff-required">*</span> \r\n                \r\n                \r\n                \r\n                \r\n                  <i  class="ff-editwidget material-icons">\r\n                    settings\r\n                  </i>\r\n                \r\n            </label>\r\n            \r\n              <small  id="Static1425767448" class="ff-help-empty ff-help form-text mdViewer"></small>\r\n            \r\n            \r\n            \r\n          \r\n          \r\n            \r\n              <input type="text" class="ff-widget-control rest-form-control" id="Widget1425767448" name="entry.1461425922"\r\n                 \r\n                  autocomplete="name" autocorrect="off" spellcheck="false"\r\n                \r\n            \r\n            \r\n            value="" placeholder="" required>\r\n          \r\n          \r\n          <div id="Error1425767448" class="ff-widget-error"></div>\r\n        </div>\r\n      \r\n        <div class="rest-form-group ff-item   ff-text ff-part-width  ff-item-noprd" id="ff-id-1032018790" >\r\n          \r\n            <label  class="ff-item-qs " for="Widget1032018790">\r\n                \r\n                  Mobile Number\r\n                \r\n                <span class="ff-required">*</span> \r\n                \r\n                \r\n                \r\n                \r\n                  <i  class="ff-editwidget material-icons">\r\n                    settings\r\n                  </i>\r\n                \r\n            </label>\r\n            \r\n              <small  id="Static1032018790" class="ff-help-empty ff-help form-text mdViewer"></small>\r\n            \r\n            \r\n            \r\n          \r\n          \r\n            \r\n              <input type="text" class="ff-widget-control rest-form-control" id="Widget1032018790" name="entry.963822338"\r\n                \r\n            \r\n            \r\n            value="" placeholder="" required>\r\n          \r\n          \r\n          <div id="Error1032018790" class="ff-widget-error"></div>\r\n        </div>\r\n      \r\n        <div class="rest-form-group ff-item   ff-list ff-part-width  ff-item-noprd" id="ff-id-952895123" >\r\n          \r\n            <label  class="ff-item-qs " for="Widget952895123">\r\n                \r\n                  State\r\n                \r\n                <span class="ff-required">*</span> \r\n                \r\n                \r\n                \r\n                \r\n                  <i  class="ff-editwidget material-icons">\r\n                    settings\r\n                  </i>\r\n                \r\n            </label>\r\n            \r\n              <small  id="Static952895123" class="ff-help-empty ff-help form-text mdViewer"></small>\r\n            \r\n            \r\n            \r\n          \r\n          \r\n            \r\n            \r\n              <select class="ff-widget-control rest-form-control" id="Widget952895123" \r\n                name="entry.950081062" required>\r\n              <option value="">- Choose -</option>\r\n              \r\n                <option  value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>\r\n              \r\n                <option  value="Andhra Pradesh">Andhra Pradesh</option>\r\n              \r\n                <option  value="Arunachal Pradesh">Arunachal Pradesh</option>\r\n              \r\n                <option  value="Assam">Assam</option>\r\n              \r\n                <option  value="Bihar">Bihar</option>\r\n              \r\n                <option  value="Chandigarh">Chandigarh</option>\r\n              \r\n                <option  value="Chhattisgarh">Chhattisgarh</option>\r\n              \r\n                <option  value="Dadra and Nagar Haveli and Daman and Diu">Dadra and Nagar Haveli and Daman and Diu</option>\r\n              \r\n                <option  value="Delhi">Delhi</option>\r\n              \r\n                <option  value="Goa">Goa</option>\r\n              \r\n                <option  value="Gujarat">Gujarat</option>\r\n              \r\n                <option  value="Haryana">Haryana</option>\r\n              \r\n                <option  value="Himachal Pradesh">Himachal Pradesh</option>\r\n              \r\n                <option  value="Jammu and Kashmir">Jammu and Kashmir</option>\r\n              \r\n                <option  value="Jharkhand">Jharkhand</option>\r\n              \r\n                <option  value="Karnataka">Karnataka</option>\r\n              \r\n                <option  value="Kerala">Kerala</option>\r\n              \r\n                <option  value="Ladakh">Ladakh</option>\r\n              \r\n                <option  value="Lakshadweep">Lakshadweep</option>\r\n              \r\n                <option  value="Madhya Pradesh">Madhya Pradesh</option>\r\n              \r\n                <option  value="Maharashtra">Maharashtra</option>\r\n              \r\n                <option  value="Manipur">Manipur</option>\r\n              \r\n                <option  value="Meghalaya">Meghalaya</option>\r\n              \r\n                <option  value="Mizoram">Mizoram</option>\r\n              \r\n                <option  value="Nagaland">Nagaland</option>\r\n              \r\n                <option  value="Odisha">Odisha</option>\r\n              \r\n                <option  value="Puducherry">Puducherry</option>\r\n              \r\n                <option  value="Punjab">Punjab</option>\r\n              \r\n                <option  value="Rajasthan">Rajasthan</option>\r\n              \r\n                <option  value="Sikkim">Sikkim</option>\r\n              \r\n                <option  value="Tamil Nadu">Tamil Nadu</option>\r\n              \r\n                <option  value="Telangana">Telangana</option>\r\n              \r\n                <option  value="Tripura">Tripura</option>\r\n              \r\n                <option  value="Uttar Pradesh">Uttar Pradesh</option>\r\n              \r\n                <option  value="Uttarakhand">Uttarakhand</option>\r\n              \r\n                <option  value="West Bengal">West Bengal</option>\r\n              \r\n              </select>\r\n            \r\n          \r\n          \r\n          <div id="Error952895123" class="ff-widget-error"></div>\r\n        </div>\r\n      \r\n        <div class="rest-form-group ff-item   ff-list ff-part-width  ff-item-noprd" id="ff-id-1162028856" >\r\n          \r\n            <label  class="ff-item-qs " for="Widget1162028856">\r\n                \r\n                  When are you planning to join an engineering college?\r\n                \r\n                <span class="ff-required">*</span> \r\n                \r\n                \r\n                \r\n                \r\n                  <i  class="ff-editwidget material-icons">\r\n                    settings\r\n                  </i>\r\n                \r\n            </label>\r\n            \r\n              <small  id="Static1162028856" class="ff-help-empty ff-help form-text mdViewer"></small>\r\n            \r\n            \r\n            \r\n          \r\n          \r\n            \r\n            \r\n              <select class="ff-widget-control rest-form-control" id="Widget1162028856" \r\n                name="entry.1164954907" required>\r\n              <option value="">- Choose -</option>\r\n              \r\n                <option  value="Soon (2024)">Soon (2024)</option>\r\n              \r\n                <option  value="Later (2025 &amp; beyond)">Later (2025 & beyond)</option>\r\n              \r\n                <option  value="Already attending college">Already attending college</option>\r\n              \r\n              </select>\r\n            \r\n          \r\n          \r\n          <div id="Error1162028856" class="ff-widget-error"></div>\r\n        </div>\r\n      \r\n        <div class="rest-form-group ff-item ff-hide  ff-text ff-part-width  ff-item-noprd" id="ff-id-2085593970" >\r\n          \r\n          \r\n            <input type="hidden" id="Widget2085593970" name="entry.1403495363" value="">\r\n          \r\n          \r\n          <div id="Error2085593970" class="ff-widget-error"></div>\r\n        </div>\r\n      \r\n        <div class="rest-form-group ff-item ff-hide  ff-text ff-part-width  ff-item-noprd" id="ff-id-1035335488" >\r\n          \r\n          \r\n            <input type="hidden" id="Widget1035335488" name="entry.641395660" value="">\r\n          \r\n          \r\n          <div id="Error1035335488" class="ff-widget-error"></div>\r\n        </div>\r\n      \r\n        <div class="rest-form-group ff-item ff-hide  ff-text ff-part-width  ff-item-noprd" id="ff-id-464744178" >\r\n          \r\n          \r\n            <input type="hidden" id="Widget464744178" name="entry.1242099843" value="">\r\n          \r\n          \r\n          <div id="Error464744178" class="ff-widget-error"></div>\r\n        </div>\r\n      \r\n        <div class="rest-form-group ff-item ff-hide  ff-text ff-part-width  ff-item-noprd" id="ff-id-1031721808" >\r\n          \r\n          \r\n            <input type="hidden" id="Widget1031721808" name="entry.551154355" value="">\r\n          \r\n          \r\n          <div id="Error1031721808" class="ff-widget-error"></div>\r\n        </div>\r\n      \r\n        <div class="rest-form-group ff-item ff-hide  ff-text ff-part-width  ff-item-noprd" id="ff-id-1548278978" >\r\n          \r\n          \r\n            <input type="hidden" id="Widget1548278978" name="entry.243186832" value="">\r\n          \r\n          \r\n          <div id="Error1548278978" class="ff-widget-error"></div>\r\n        </div>\r\n      \r\n        <div class="rest-form-group ff-item ff-hide  ff-text ff-part-width  ff-item-noprd" id="ff-id-1700966988" >\r\n          \r\n          \r\n            <input type="hidden" id="Widget1700966988" name="entry.27393836" value="">\r\n          \r\n          \r\n          <div id="Error1700966988" class="ff-widget-error"></div>\r\n        </div>\r\n      \r\n        <div class="rest-form-group ff-item ff-hide  ff-text ff-part-width  ff-item-noprd" id="ff-id-1773223727" >\r\n          \r\n          \r\n            <input type="hidden" id="Widget1773223727" name="entry.2129927491" value="">\r\n          \r\n          \r\n          <div id="Error1773223727" class="ff-widget-error"></div>\r\n        </div>\r\n      \r\n        <div class="rest-form-group ff-item ff-hide  ff-text ff-part-width  ff-item-noprd" id="ff-id-1377976250" >\r\n          \r\n          \r\n            <input type="hidden" id="Widget1377976250" name="entry.4054503" value="">\r\n          \r\n          \r\n          <div id="Error1377976250" class="ff-widget-error"></div>\r\n        </div>\r\n      \r\n        <div class="rest-form-group ff-item ff-hide  ff-text ff-part-width  ff-item-noprd" id="ff-id-169341982" >\r\n          \r\n          \r\n            <input type="hidden" id="Widget169341982" name="entry.1559872836" value="">\r\n          \r\n          \r\n          <div id="Error169341982" class="ff-widget-error"></div>\r\n        </div>\r\n      \r\n        <div class="rest-form-group ff-item ff-hide  ff-text ff-part-width  ff-item-noprd" id="ff-id-866912435" >\r\n          \r\n          \r\n            <input type="hidden" id="Widget866912435" name="entry.612135358" value="">\r\n          \r\n          \r\n          <div id="Error866912435" class="ff-widget-error"></div>\r\n        </div>\r\n      \r\n      \r\n    \r\n    </div>\r\n\r\n    <div class="ff-button-bar">\r\n    \r\n    \r\n        <button type="button" class="rest-btn rest-btn-lg rest-btn-primary ff-submit" id="ff-submit-root" onclick="formFacade.submit(this.form, \'root\')">\r\n          \r\n          \r\n          \r\n            <img alt="Submit" style="" src="https://formfacade.com/img/send.svg" class="ff-submit-icon"/>\r\n          \r\n          <span>\r\n            Submit\r\n          </span>\r\n        </button>\r\n      \r\n    \r\n\r\n    \r\n    \r\n      \r\n        \r\n        \r\n      \r\n    \r\n    </div>\r\n    </div>\r\n\r\n    \r\n\r\n    \r\n\r\n    \r\n    <div class="ff-section" id="ff-sec-ending" style="display:none">\r\n    <div class="ff-secfields">\r\n      <h3 class="ff-title">Book A Free Counselling Session</h3>\r\n      <p style="padding-bottom:80px;">Click Submit to finish.</p>\r\n    </div>\r\n    <div class="ff-button-bar">\r\n      <button type="button" class="rest-btn rest-btn-lg rest-btn-secondary ff-back" \r\n        onclick="formFacade.gotoSection(this.form, \'root\', \'back\')">\r\n        \x3c!-- arrow back SVG --\x3e\r\n        \r\n          <span class="material-icons">arrow_back</span>\r\n        \r\n        <span>Back</span>\r\n      </button>\r\n      <button type="button" class="rest-btn rest-btn-lg rest-btn-primary ff-submit"\r\n        onclick="formFacade.submit(this.form, \'-3\')">\r\n        \x3c!-- send SVG --\x3e\r\n        <svg xmlns="http://www.w3.org/2000/svg" height="19" viewBox="0 -960 960 960" width="19" role="img" aria-label="Submit"><path d="M120-160v-640l760 320-760 320Zm80-120 474-200-474-200v140l240 60-240 60v140Zm0 0v-400 400Z"/></svg>\r\n        <span>Submit</span>\r\n      </button>\r\n    </div>\r\n    </div>\r\n\r\n  </form>\r\n\r\n\r\n\r\n\r\n<div id="ff-addprd-overlay" onclick="formFacade.closePopup()"></div>\r\n<div id="ff-addprd-popup" dir="ltr"></div>\r\n'},formFacade.config={shortId:"9VvguPlht",usage:3440,bgimageorg:"https://cdn.neartail.com/100066911282161708792/theme/bgimageorg/1.png",colorfulhead:"Rubik",colorfulpara:"Roboto",colorfulpri:"#7373ba",colorfulsec:"#716f6f",colorfulsize:"16",language:"en",logoorg:"https://cdn.neartail.com/100066911282161708792/theme/logoorg/kalviumlogo.png",minimalhead:"Work Sans",minimalpara:"Work Sans",minimalpri:"#77cde3",minimalsec:"#f5f5f5",minimalsize:"14",theme:"colorful",themePrimary:"#000000",themeSecondary:"#000000",title:"Powered by Kalvium",trial:-1,setting:{},installAt:1677857546286,themecolor:"colorful-5d33fb",themecss:"font=%22Roboto%22%2C%20sans-serif&heading=%22Poppins%22%2C%20sans-serif&primary=%23000000&primaryActive=%23492bbb&secondary=%23000000",shades:{"--ff-primary-10":"#eaeaf3","--ff-primary-50":"#d2d2e6","--ff-primary-100":"#c6c6df","--ff-primary-200":"#b8b8d8","--ff-primary-300":"#aaaad1","--ff-primary-400":"#9a9aca","--ff-primary-500":"#8888c2","--ff-primary-600":"#7373ba","--ff-primary-700":"#6d6db0","--ff-primary-800":"#6767a6","--ff-primary-900":"#60609c","--ff-primary-950":"#595990"},originTime:1716205436538,originId:"76d8fbc1945ba12946c925ed5678aa42b893c872ec4b9b911b723dff55a1e9ba"},formFacade.langtext={locale:"US",language:"en"};